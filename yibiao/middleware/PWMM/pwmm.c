/***************************************************************************** pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h Copyright (C) 2016 ShenZhen Yeedon Media co.,LTD. All rights reserved. * pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h File Name : pwmm.C pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h Description :pwmm module middleware. pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h Author: Xueping.Chen pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h Date: 2016-11-29 ******************************************************************************/ /bin /cmd /dev /etc /git-bash.exe /git-cmd.exe /LICENSE.txt /mingw64 /proc /ReleaseNotes.html /tmp /unins000.dat /unins000.exe /unins000.msg /usr Files for including */ #include "pwmm_info.inc"  static BOOL pwmm_InitSts = FALSE; /bin /cmd /dev /etc /git-bash.exe /git-cmd.exe /LICENSE.txt /mingw64 /proc /ReleaseNotes.html /tmp /unins000.dat /unins000.exe /unins000.msg /usr PWMM module Init Status*/ static BOOL pwmm_IsUpdate[CH_PWMM_ALL]; /bin /cmd /dev /etc /git-bash.exe /git-cmd.exe /LICENSE.txt /mingw64 /proc /ReleaseNotes.html /tmp /unins000.dat /unins000.exe /unins000.msg /usr PWM is Update Parameter or not*/ static U8 pwmm_duty[CH_PWMM_ALL]; /bin /cmd /dev /etc /git-bash.exe /git-cmd.exe /LICENSE.txt /mingw64 /proc /ReleaseNotes.html /tmp /unins000.dat /unins000.exe /unins000.msg /usr PWMM duty*/ static BOOL pwmm_Status[CH_PWMM_ALL]; /bin /cmd /dev /etc /git-bash.exe /git-cmd.exe /LICENSE.txt /mingw64 /proc /ReleaseNotes.html /tmp /unins000.dat /unins000.exe /unins000.msg /usr PWMM status*/  /*************************************************** pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h Function: PWMM_Init pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h Description: the PWMM module initialized pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h Parameters: none pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h Returns: none pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h $Create & Verlog:$ pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h Author:Xueping.Chen Date:2016-11-29 Version:V1.0 ****************************************************/ void PWMM_Init(void) { U8 i = 0;  for (i = 0; i < CH_PWMM_INDICATOR; i++) { pwmm_IsUpdate[i] = FALSE; pwmm_Status[i] = FALSE; pwmm_duty[i] = FALSE; } pwmm_IsUpdate[CH_PWMM_INDICATOR] = FALSE; pwmm_Status[CH_PWMM_INDICATOR] = FALSE; pwmm_duty[CH_PWMM_INDICATOR] = FALSE; pwmm_InitSts = PWM_GetInitStatus(); }  /*************************************************** pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h Function: PWMM_Process_100ms pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h Description: the process of the pwmm module pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h Parameters: none pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h Returns: none pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h $Create & Verlog:$ pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h Author:Xueping.Chen Date:2016-11-29 Version:V1.0 ****************************************************/ void PWMM_Process_100ms(void) { PwmmCh_ENUM chn;  if (TRUE == pwmm_InitSts) { for (chn = CH_PWMM_TFT; chn < CH_PWMM_ALL; chn++) { if (TRUE == pwmm_IsUpdate[chn]) { pwmm_IsUpdate[chn] = FALSE; PWM_SetParas(chn, PWMM_CYCLE, pwmm_duty[chn]); PWM_Control(pwmm_Status[chn], chn); } else { } } } else { } }  /*************************************************** pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h Function: PWMM_SetOutPutEnable pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h Description: enable the channel of pwm pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h Parameters: channel : input the channel of ILLU PWM switch : input enable or disable pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h Returns: TRUE or FALSE pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h $Create & Verlog:$ pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h Author:Xueping.Chen Date:2016-11-29 Version:V1.0 ****************************************************/ U8 PWMM_SetOutPutEnable(PwmmCh_ENUM Channel, BOOL onoff) { U8 res = RET_OK;  if (FALSE == pwmm_InitSts ) { res = RET_FAIL; } else if (CH_PWMM_ALL <= Channel) { res = RET_INVALID; } else { if (pwmm_Status[Channel] != onoff) { pwmm_Status[Channel] = onoff; pwmm_IsUpdate[Channel] = TRUE; } else { } }  return res; }  /*************************************************** pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h Function: PWMM_SetValue pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h Description: set the cycle and duty of the PWMM pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h Parameters: Channel: input the channel of the ILLU pwmm Level: input the level of the ILLU pwmm pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h Returns: reference PwmmRes_ENUM pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h $Create & Verlog:$ pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h Author:Xueping.Chen Date:2016-11-29 Version:V1.0 ****************************************************/ U8 PWMM_SetValue(PwmmCh_ENUM Channel, U8 Duty) { U8 res = RET_OK;  if (FALSE == pwmm_InitSts) { res = RET_FAIL; } else if (CH_PWMM_ALL <= Channel) { res = RET_INVALID; } else { if (pwmm_duty[Channel] != Duty) { pwmm_duty[Channel] = Duty;  if (TRUE ==pwmm_Status[Channel]) { pwmm_IsUpdate[Channel] = TRUE; } else { } } else { } } return res; }  /*************************************************** pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h Function: PWMM_GetInitStatus pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h Description: Get the status of the PWMM module initialized pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h Parameters: none pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h Returns: TRUE or FALSE pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h $Create & Verlog:$ pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h Author:Xueping.Chen Date:2016-11-29 Version:V1.0 ****************************************************/ BOOL PWMM_GetInitStatus(void) { return pwmm_InitSts; }   /*=========================================================================== pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h File Revision History(bottom to top:first revision to last revision) *============================================================================ pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h $Log:$ * pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h Rev: Userid: Date: Description *-------- ---------- --------- ------------------------------ * pwmm.c pwmm_cfg.h pwmm_info.inc pwmm_private.h pwmm_public.h V1.0 Xueping.Chen 2016-11-29 Initial * *===========================================================================*/
