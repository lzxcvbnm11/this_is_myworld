/*****************************************************************************  File Name : hmi_engine.c Organization : Zhuli Electronics Co.Ltd in Shanghai (www.shzldz.com) ******************************************************************************/  #define HMI_ENGINE_C #include "hmi_all_struct_include.h" #include "hmi_res_sprite.rom" #include "hmi_application_data.rom" #include <math.h> /bin /cmd /dev /etc /git-bash.exe /git-cmd.exe /LICENSE.txt /mingw64 /proc /ReleaseNotes.html /tmp /unins000.dat /unins000.exe /unins000.msg /usr sin and cos */   #define HMI_PAGE_CHANGE_FLAG (0x01)  #define HMI_BEGIN_UPDATE_FLAG (0x02)  #define HMI_UPDATE_BUSY (0x00) #define HMI_NEED_REDRAW (0x01) #define HMI_NONE (0x02)  #ifdef HMI_GRAPHIC_RGL /*set layer draw first,if first draw the layer,clear the layer*/ #if 0 static UINT8 first_draw_layer = 0xff; #define set_first_draw_all() first_draw_layer = 0xff #define set_first_draw(layer) first_draw_layer = first_draw_layer|(UINT8(1<<layer)) #define clr_first_draw(layer) first_draw_layer = first_draw_layer&(UINT8(~(1<<layer))) #endif #endif  #if HMI_IMGLIST_MAX_STATUS<=2 #define HMI_IMGLIST_MAX_STATUS_BIT_LEN 1 #elif HMI_IMGLIST_MAX_STATUS<=4 #define HMI_IMGLIST_MAX_STATUS_BIT_LEN 2 #elif HMI_IMGLIST_MAX_STATUS<=16 #define HMI_IMGLIST_MAX_STATUS_BIT_LEN 4 #else #define HMI_IMGLIST_MAX_STATUS_BIT_LEN 8 #endif  #if HMI_BTN_MAX_STATUS<=2 #define HMI_BTN_MAX_STATUS_BIT_LEN 1 #elif HMI_BTN_MAX_STATUS<=4 #define HMI_BTN_MAX_STATUS_BIT_LEN 2 #elif HMI_BTN_MAX_STATUS<=16 #define HMI_BTN_MAX_STATUS_BIT_LEN 4 #else #define HMI_BTN_MAX_STATUS_BIT_LEN 8 #endif  #if HMI_SCROLLBAR_MAX_STATUS+1<=2 #define HMI_SCROLLBAR_MAX_STATUS_BIT_LEN 1 #elif HMI_SCROLLBAR_MAX_STATUS+1<=4 #define HMI_SCROLLBAR_MAX_STATUS_BIT_LEN 2 #elif HMI_SCROLLBAR_MAX_STATUS+1<=16 #define HMI_SCROLLBAR_MAX_STATUS_BIT_LEN 4 #elif HMI_SCROLLBAR_MAX_STATUS+1<=256 #define HMI_SCROLLBAR_MAX_STATUS_BIT_LEN 8 #else #error ScrollBar 'MaxRange' must <=255 #endif  #define HMI_TW_CONTAINER_COMPRESS_MAX_STATUS_BIT_LEN 1    /*For MACROS too nested error*/ CONST HMI_OBJECT_ID_STR hmi_event_act_begin_index=(HMI_CONTAINERS_SXY_MAX_ID+HMI_LANGUAGE_NUMBER);   #if HMI_DYN_LANGUAGE_NUMBER>0 static HMI_OBJECT_ID_STR hmi_cur_language=0U; #endif #if HMI_ALL_DYN_OBJECTS_NUMBER > 0  #define HMI_NB_ALL_DYN_OBJECT_BYTE ((HMI_ALL_DYN_OBJECTS_NUMBER+7)/8) static UINT8 hmi_dynamic_object_changed_flag[HMI_NB_ALL_DYN_OBJECT_BYTE];   #define HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(id) (hmi_dynamic_object_changed_flag[(id)>>3]=hmi_dynamic_object_changed_flag[(id)>>3]|( (UINT8)(0x01<<((id)&0x07)))) #define HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(id) (hmi_dynamic_object_changed_flag[(id)>>3]&((UINT8)(0x01<<((id)&0x07)))) #define HMI_DYNAMIC_OBJECT_CANCEL_CHANGED_FLAG(id) (hmi_dynamic_object_changed_flag[(id)>>3]=hmi_dynamic_object_changed_flag[(id)>>3]&((UINT8)(~(0x01<<((id)&0x07))))) #endif UINT8 hmi_driver_woking_status_flag = 0U;  #if HMI_ALL_LAYERS_NUMBER > 0 #if HMI_LAYER_0_HIGHEST_PRIORITY > 1 static UINT8 hmi_highest_active_page_priority = 0; #endif #endif #if HMI_LAYER_0_HIGHEST_PRIORITY>0 static HMI_PRIOR_PAGE_STR DISPLAY_SEGMENT_RAM hmi_layer_0_active_page_id[HMI_LAYER_0_HIGHEST_PRIORITY]; #endif  /***element draw rect backups****/ #if (defined(HMI_GRAPHIC_RGL)) #if HMI_DXY_IMAGELIST_NUMBER > 0 static HMI_RECT_STR hmi_dxy_imagelist_rect_bck[HMI_DXY_IMAGELIST_NUMBER]= { {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0} }; #endif  #if HMI_DXY_SCROLLBAR_NUMBER>0 /*Static scrollbar dyamic coordinate */ static HMI_RECT_STR hmi_dxy_scrollbar_rect_bck[HMI_DXY_SCROLLBAR_NUMBER]= { {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0} }; #endif  #if HMI_DXY_PAGES_NUMBER>0 /*Dynamic xy page coordinate */ static HMI_RECT_STR hmi_dxy_page_rect_bck[HMI_DXY_PAGES_NUMBER]= { {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0} }; #endif  #if HMI_DXY_BUTTON_NUMBER>0 /*Static Button dyamic coordinate */ static HMI_RECT_STR hmi_dxy_button_rect_bck[HMI_DXY_BUTTON_NUMBER]= { {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0} }; #endif #if HMI_DYN_XY_EDIT_TEXTS_NUMBER>0 /*Editable text dynamic property */ static HMI_RECT_STR hmi_dyn_xy_edit_text_prop_table_bck[HMI_DYN_XY_EDIT_TEXTS_NUMBER]= { {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0} }; #endif #if HMI_UNEDIT_TEXTS_DYN_XY_NUMBER>0 static HMI_RECT_STR hmi_dyn_xy_unedit_text_prop_table_bck[HMI_UNEDIT_TEXTS_DYN_XY_NUMBER]= { {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0} }; #endif #if HMI_DYN_CONTAINERS_NUMBER>0 /*Dynamic widget initial */ static HMI_DYN_CONTAINER_DATA_STR hmi_dyn_container_table_bck[HMI_DYN_CONTAINERS_NUMBER]= { {HMI_NB_ELEMENTS} }; #endif #if HMI_DYN_FILL_PAGES_NUMBER>0 /*Dynamic Fill coordinate */ static HMI_RECT_STR hmi_fills_dyn_xy_rect_bck[HMI_DYN_FILL_PAGES_NUMBER]= { {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0} }; #endif #if HMI_DYN_GFILL_NUMBER>0 /*Dynamic Fill coordinate */ static HMI_RECT_STR hmi_gradient_dxy_fill_rect_bck[HMI_DYN_GFILL_NUMBER]= { {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0} }; #endif #if HMI_DXY_CUBE_NUMBER>0 /*Dynamic Cube coordinate,width,angel,bump,face */ static HMI_RECT_STR hmi_cubes_dyn_xy_rect_bck[HMI_DXY_CUBE_NUMBER]= { {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0} }; #endif #if HMI_DXY_CONTAINERS_NUMBER>0 static HMI_RECT_STR hmi_dyn_xy_container_rect_bck[HMI_DXY_CONTAINERS_NUMBER]= { {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0} }; #endif #if HMI_DXY_BITMAPS_NUMBER>0 static HMI_RECT_STR hmi_bmp_dyn_xy_rect_bck[HMI_DXY_BITMAPS_NUMBER]= { {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0} }; #endif #if HMI_DXY_BITMAPS_NUMBER>0 static float_32 hmi_bmp_dyn_angel_bck[HMI_DXY_BITMAPS_NUMBER]= { {0} }; #endif  #endif  #if HMI_ALL_STATIC_CONTAINERS_NUMBER > 0 static BOOLEAN hmi_engine_check_container_changed(HMI_OBJECT_ID_STR hmi_object_id,HMI_RECT_STR CONST*pfarther_rect, HMI_RECT_STR *pdirty_rect,UINT8 depth,HMI_RECT_STR hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml pcliped_farther_rect); #if (HMI_DYN_CONTAINERS_NUMBER > 0) static BOOLEAN hmi_engine_get_static_container_id(HMI_OBJECT_ID_STR hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_dyn_contain_id); #endif #endif   #if HMI_ALL_DYN_OBJECTS_NUMBER> HMI_PAGES_NUMBER static UINT8 hmi_engine_check_dynamic_object_changed(HMI_CONTAINER_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_container_info, HMI_RECT_STR CONST *pfarther_rect,  HMI_RECT_STR *pdirty_rect, U08 depth, HMI_RECT_STR *pcliped_farther_rect); #endif  static void hmi_engine_draw_container(HMI_CONTAINER_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_container_info,HMI_RECT_STR CONST *pfarther_rect, #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513)) HMI_RECT_STR *pdirty_rect, U08 depth,/*node of page NO*/ HMI_RECT_STR *pcliped_farther_rect #ifdef HMI_GRAPHIC_RGL ,UINT8 father_alpha #endif #elif defined(HMI_GRAPHIC_TWLIB)  HMI_ELEMENT_TYPE parent_object_id_type, HMI_OBJECT_ID_STR hmi_object_id, BOOLEAN bDrawBck #if HMI_RENDER_ALL_EXCEPT_BCK==NO ,HMI_OBJECT_ID_STR parent_object_id ,BOOLEAN only_draw_flag #endif #else  #endif ) REENTRANT;  static void hmi_engine_draw_object(HMI_OBJECT_PROP_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_object_prop_table,HMI_RECT_STR CONST *pfarther_rect, #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513)) HMI_RECT_STR *pdirty_rect, U08 depth, HMI_RECT_STR *pcliped_farther_rect #if(defined(HMI_GRAPHIC_RGL)) ,UINT8 father_alpha #endif #else /*tw*/ HMI_ELEMENT_TYPE parent_object_id_type #if HMI_RENDER_ALL_EXCEPT_BCK==NO  ,HMI_OBJECT_ID_STR parent_object_id ,BOOLEAN only_draw_flag #endif #endif ) REENTRANT;   HMI_OBJECT_ID_STR hmi_search_container(HMI_CONTAINER_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_container_info,HMI_RECT_STR CONST *phmi_father_rect,POINT_TP *phmi_point,BOOLEAN *phmi_is_button) REENTRANT; BOOLEAN hmi_judge_point_zone(HMI_RECT_STR CONST *rect_t,POINT_TP *point_t); HMI_OBJECT_ID_STR hmi_search_object(HMI_OBJECT_PROP_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_object_prop_table,HMI_RECT_STR CONST *phmi_father_rect,POINT_TP *press_point,BOOLEAN *phmi_is_button) REENTRANT; void hmi_get_object_screen_coor(HMI_RECT_STR CONST*pfarther_rect,HMI_RECT_STR CONST*pobject_rect,HMI_RECT_STR *phmi_temp_rect); void hmi_set_dirty_zone(HMI_RECT_STR *pfarther_rect,HMI_RECT_STR *pdirty_rect); static void hmi_cube_get_container_point(HMI_OBJECT_ID_STR hmi_object_id,  S3POINT_TP *ppoint); static BOOLEAN hmi_engine_get_bck_static_container_id(HMI_OBJECT_ID_STR hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_dyn_contain_id); void hmi_load_file_to_vram(HMI_OBJECT_ID_STR hmi_object_id); void call_C_hmi_driver_load_rotation_file(void); void hmi_union_rect(HMI_RECT_STR *prect1,HMI_RECT_STR *prect2,HMI_RECT_STR *prect_union); BOOLEAN hmi_get_rotation_pointer_dirty(HMI_RECT_STR *p_pointer_rect, HMI_RECT_STR *p_pointer_rect_old, HMI_ROTATION_STR *p_axis,HMI_ROTATION_STR *p_axis_old, float_32 new_angel,float_32 old_angel, HMI_RECT_STR *p_dirty, BOOLEAN trail,HMI_RECT_STR *p_father_rect);    void hmi_engine_init(void) { #if HMI_LAYER_0_HIGHEST_PRIORITY > 1 UINT16 hmi_count = 0U; #endif #if HMI_NB_ALL_DYN_OBJECT_BYTE>256 UINT16 hmi_dyn_object_cf = 0U; #else UINT8 hmi_dyn_object_cf = 0U; #endif  #ifdef HMI_GRAPHIC_AGG UINT8 index = 0U; #endif #ifdef HMI_GRAPHIC_RGL HMI_OBJECT_ID_STR hmi_bck_index = 0; #endif #if HMI_ALL_LAYERS_NUMBER >0U #if HMI_LAYER_0_HIGHEST_PRIORITY > 1 UINT8 hmi_layer_id = 0U; hmi_highest_active_page_priority = HMI_LAYER_0_HIGHEST_PRIORITY; #endif #if HMI_LAYER_0_HIGHEST_PRIORITY > 1 for(hmi_count=0U; hmi_count < hmi_layer_table[hmi_layer_id].max_priority; hmi_count++) #endif { #if HMI_LAYER_0_HIGHEST_PRIORITY > 1  hmi_layer_0_active_page_id[hmi_count].new_page= HMI_PAGES_NUMBER; hmi_layer_0_active_page_id[hmi_count].old_page= HMI_PAGES_NUMBER; #elif HMI_LAYER_0_HIGHEST_PRIORITY == 1 hmi_layer_0_active_page_id[0].new_page= HMI_PAGES_NUMBER; hmi_layer_0_active_page_id[0].old_page= HMI_PAGES_NUMBER; #else #endif } #endif hmi_driver_woking_status_flag = HMI_FRAMEBUFFER_FREE; #if HMI_ALL_DYN_OBJECTS_NUMBER >0U for(hmi_dyn_object_cf=0U;hmi_dyn_object_cf<HMI_NB_ALL_DYN_OBJECT_BYTE;hmi_dyn_object_cf++) { hmi_dynamic_object_changed_flag[hmi_dyn_object_cf]=0U; } #endif #if HMI_DYN_LANGUAGE_NUMBER>0 hmi_cur_language=HMI_DYN_LANGUAGE_INIT; #endif  #if (defined(HMI_GRAPHIC_RGL)) #if HMI_DXY_PAGES_NUMBER > 0 for(hmi_bck_index=0U; hmi_bck_index < HMI_DXY_PAGES_NUMBER; hmi_bck_index++) { hmi_dxy_page_rect_bck[hmi_bck_index].x = HMI_INVALID_COOR; hmi_dxy_page_rect_bck[hmi_bck_index].y = HMI_INVALID_COOR; hmi_dxy_page_rect_bck[hmi_bck_index].w = 0; hmi_dxy_page_rect_bck[hmi_bck_index].h = 0; } #endif  #if HMI_DXY_IMAGELIST_NUMBER > 0 for(hmi_bck_index=0U; hmi_bck_index < HMI_DXY_IMAGELIST_NUMBER; hmi_bck_index++) { hmi_dxy_imagelist_rect_bck[hmi_bck_index].x = HMI_INVALID_COOR; hmi_dxy_imagelist_rect_bck[hmi_bck_index].y = HMI_INVALID_COOR; hmi_dxy_imagelist_rect_bck[hmi_bck_index].w = 0; hmi_dxy_imagelist_rect_bck[hmi_bck_index].h = 0; } #endif  #if HMI_DXY_SCROLLBAR_NUMBER>0 for(hmi_bck_index=0U; hmi_bck_index < HMI_DXY_SCROLLBAR_NUMBER; hmi_bck_index++) { hmi_dxy_scrollbar_rect_bck[hmi_bck_index].x = HMI_INVALID_COOR; hmi_dxy_scrollbar_rect_bck[hmi_bck_index].y = HMI_INVALID_COOR; hmi_dxy_scrollbar_rect_bck[hmi_bck_index].w = 0; hmi_dxy_scrollbar_rect_bck[hmi_bck_index].h = 0; } #endif  #if HMI_DXY_BUTTON_NUMBER>0 for(hmi_bck_index=0U; hmi_bck_index < HMI_DXY_BUTTON_NUMBER; hmi_bck_index++) { hmi_dxy_button_rect_bck[hmi_bck_index].x = HMI_INVALID_COOR; hmi_dxy_button_rect_bck[hmi_bck_index].y = HMI_INVALID_COOR; hmi_dxy_button_rect_bck[hmi_bck_index].w = 0; hmi_dxy_button_rect_bck[hmi_bck_index].h = 0; } #endif  #if HMI_DYN_XY_EDIT_TEXTS_NUMBER>0 for(hmi_bck_index=0U; hmi_bck_index < HMI_DYN_XY_EDIT_TEXTS_NUMBER; hmi_bck_index++) { hmi_dyn_xy_edit_text_prop_table_bck[hmi_bck_index].x = HMI_INVALID_COOR; hmi_dyn_xy_edit_text_prop_table_bck[hmi_bck_index].y = HMI_INVALID_COOR; hmi_dyn_xy_edit_text_prop_table_bck[hmi_bck_index].w = 0; hmi_dyn_xy_edit_text_prop_table_bck[hmi_bck_index].h = 0; } #endif #if HMI_UNEDIT_TEXTS_DYN_XY_NUMBER>0 for(hmi_bck_index=0U; hmi_bck_index < HMI_UNEDIT_TEXTS_DYN_XY_NUMBER; hmi_bck_index++) { hmi_dyn_xy_unedit_text_prop_table_bck[hmi_bck_index].x = HMI_INVALID_COOR; hmi_dyn_xy_unedit_text_prop_table_bck[hmi_bck_index].y = HMI_INVALID_COOR; hmi_dyn_xy_unedit_text_prop_table_bck[hmi_bck_index].w = 0; hmi_dyn_xy_unedit_text_prop_table_bck[hmi_bck_index].h = 0; } #endif  #if HMI_DYN_CONTAINERS_NUMBER>0 for(hmi_bck_index=0U; hmi_bck_index < HMI_DYN_CONTAINERS_NUMBER; hmi_bck_index++) { hmi_dyn_container_table_bck[hmi_bck_index] = HMI_NB_ELEMENTS; }  #endif #if HMI_DYN_FILL_PAGES_NUMBER>0 for(hmi_bck_index=0U; hmi_bck_index < HMI_DYN_FILL_PAGES_NUMBER; hmi_bck_index++) { hmi_fills_dyn_xy_rect_bck[hmi_bck_index].x = HMI_INVALID_COOR; hmi_fills_dyn_xy_rect_bck[hmi_bck_index].y = HMI_INVALID_COOR; hmi_fills_dyn_xy_rect_bck[hmi_bck_index].w = 0; hmi_fills_dyn_xy_rect_bck[hmi_bck_index].h = 0; } #endif #if HMI_DYN_GFILL_NUMBER>0 for(hmi_bck_index=0U; hmi_bck_index < HMI_DYN_GFILL_NUMBER; hmi_bck_index++) { hmi_gradient_dxy_fill_rect_bck[hmi_bck_index].x = HMI_INVALID_COOR; hmi_gradient_dxy_fill_rect_bck[hmi_bck_index].y = HMI_INVALID_COOR; hmi_gradient_dxy_fill_rect_bck[hmi_bck_index].w = 0; hmi_gradient_dxy_fill_rect_bck[hmi_bck_index].h = 0; } #endif #if HMI_DXY_CUBE_NUMBER>0 for(hmi_bck_index=0U; hmi_bck_index < HMI_DXY_CUBE_NUMBER; hmi_bck_index++) { hmi_cubes_dyn_xy_rect_bck[hmi_bck_index].x = HMI_INVALID_COOR; hmi_cubes_dyn_xy_rect_bck[hmi_bck_index].y = HMI_INVALID_COOR; hmi_cubes_dyn_xy_rect_bck[hmi_bck_index].w = 0; hmi_cubes_dyn_xy_rect_bck[hmi_bck_index].h = 0; } #endif #if HMI_DXY_CONTAINERS_NUMBER>0 for(hmi_bck_index=0U; hmi_bck_index < HMI_DXY_CONTAINERS_NUMBER; hmi_bck_index++) { hmi_dyn_xy_container_rect_bck[hmi_bck_index].x = HMI_INVALID_COOR; hmi_dyn_xy_container_rect_bck[hmi_bck_index].y = HMI_INVALID_COOR; hmi_dyn_xy_container_rect_bck[hmi_bck_index].w = 0; hmi_dyn_xy_container_rect_bck[hmi_bck_index].h = 0; } #endif #if HMI_DXY_BITMAPS_NUMBER>0 for(hmi_bck_index=0U; hmi_bck_index < HMI_DXY_BITMAPS_NUMBER; hmi_bck_index++) { hmi_bmp_dyn_xy_rect_bck[hmi_bck_index].x = HMI_INVALID_COOR; hmi_bmp_dyn_xy_rect_bck[hmi_bck_index].y = HMI_INVALID_COOR; hmi_bmp_dyn_xy_rect_bck[hmi_bck_index].w = 0; hmi_bmp_dyn_xy_rect_bck[hmi_bck_index].h = 0; hmi_bmp_dyn_angel_bck[hmi_bck_index] = 0; } #endif #endif #ifdef HMI_GRAPHIC_AGG call_C_hmi_driver_init(); for(index=0;index < HMI_BBITMAP_NUMBER;index++) { call_C_hmi_driver_load_bigimage(hmi_bigbitmap_table[index]); } call_C_hmi_driver_load_file(); #endif  #ifdef HMI_GRAPHIC_RGL call_C_hmi_driver_init(); #if (HMI_ENABLE_BIN == HMI_YES) #if (HMI_LOAD_SOURCE_MODE == HMI_LOAD_RES_ALL_INIT)  call_C_hmi_driver_load_all_file(); #elif(HMI_LOAD_SOURCE_MODE == HMI_LOAD_RES_ONLY_ROTATION) call_C_hmi_driver_load_rotation_file(); #endif #endif #endif #ifdef HMI_GRAPHIC_ST7513 call_C_hmi_driver_init(); #endif #if (defined(HMI_MCU_TW36)||(defined(HMI_MCU_TW25))) call_C_hmi_driver_init(); #endif  }  #ifdef HMI_GRAPHIC_ST7513 HMI_HEIGHT_STR hmi_get_layer_height(UINT8 layer) { HMI_HEIGHT_STR h = 0;  h = HMI_MAX_HEIGHT; return h; } HMI_WIDTH_STR hmi_get_layer_width(UINT8 layer) { HMI_WIDTH_STR w = 0;  w = HMI_MAX_WIDTH; return w; } #endif  #if HMI_VDXY_PAGES_NUMBER+HMI_VSXY_PAGES_NUMBER > 0 static void hmi_engine_draw_video(HMI_OBJECT_ID_STR video_page_object,BOOLEAN dxy) { #ifndef HMI_GRAPHIC_ST7513 HMI_OBJECT_ID_STR video_page_index=0;  HMI_OBJECT_ID_STR video_s_dxy_page_index=0; #if HMI_VDXY_PAGES_NUMBER>0 if(dxy) { video_page_index = HMI_GET_VPAGE_DXY_ID_INDEX(video_page_object); video_s_dxy_page_index = HMI_GET_PAGE_DXY_ID_INDEX(video_page_object); if((video_page_index < HMI_VDXY_PAGES_NUMBER)&& (video_s_dxy_page_index < HMI_DXY_PAGES_NUMBER)) {  hmi_display_video(&hmi_dxy_page_video_fmt[video_page_index], &hmi_dxy_page_rect[video_s_dxy_page_index],0,0); } } else #endif #if HMI_VSXY_PAGES_NUMBER>0 { video_page_index = HMI_GET_VPAGE_SXY_ID_INDEX(video_page_object); video_s_dxy_page_index = HMI_GET_PAGE_SXY_ID_INDEX(video_page_object); if((video_page_index < HMI_VSXY_PAGES_NUMBER)&& (video_s_dxy_page_index < HMI_SXY_PAGES_NUMBER)) {  hmi_display_video(&hmi_sxy_page_video_fmt[video_page_index], (HMI_RECT_STR *)(&hmi_sxy_page_rect[video_s_dxy_page_index]),0,0); } } #endif { } #endif } #endif  #if HMI_PAGES_NUMBER>0U void hmi_engine_set_page(HMI_OBJECT_ID_STR hmi_object_id,HMI_OBJECT_DATA_STR hmi_object_data) {  #if HMI_LAYER_0_HIGHEST_PRIORITY > 1 UINT8 hmi_priority_cnt = 0U; #endif UINT16 hmi_object_index = 0U; HMI_PAGE_TABLE_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_page_info = NULL;  if(HMI_IS_PAGE(hmi_object_id)) {  #if HMI_DXY_PAGES_NUMBER > 0U if(HMI_IS_DXY_PAGE(hmi_object_id)) { hmi_object_index = HMI_GET_PAGE_DXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_DXY_PAGES_NUMBER) { phmi_page_info= &hmi_dxy_page_table[hmi_object_index]; } } else  #endif #if HMI_SXY_PAGES_NUMBER>0U if(HMI_IS_SXY_PAGE(hmi_object_id)) { hmi_object_index = HMI_GET_PAGE_SXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_SXY_PAGES_NUMBER) { phmi_page_info= &hmi_sxy_page_table[hmi_object_index]; } } else #endif { } if(phmi_page_info !=NULL) { if(hmi_object_data == HMI_REMOVE_PAGE_BIT) { if(hmi_layer_0_active_page_id[phmi_page_info ->page_priority].new_page  == hmi_object_id) { HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); #if HMI_EVENT_STAND_NUMBER>0 hmi_do_event(hmi_object_id,HMI_PAGE_OFF); #endif hmi_layer_0_active_page_id[phmi_page_info ->page_priority].old_page =  hmi_layer_0_active_page_id[phmi_page_info ->page_priority].new_page; hmi_layer_0_active_page_id[phmi_page_info ->page_priority].new_page = HMI_PAGES_NUMBER; #if HMI_LAYER_0_HIGHEST_PRIORITY > 1 hmi_priority_cnt = hmi_highest_active_page_priority; hmi_highest_active_page_priority= HMI_LAYER_0_HIGHEST_PRIORITY; if(hmi_priority_cnt < HMI_LAYER_0_HIGHEST_PRIORITY) { hmi_priority_cnt++;  while(hmi_priority_cnt != 0) { hmi_priority_cnt--; hmi_object_id = hmi_layer_0_active_page_id[hmi_priority_cnt].new_page; if(hmi_object_id != HMI_PAGES_NUMBER) { if(hmi_highest_active_page_priority == HMI_LAYER_0_HIGHEST_PRIORITY) { hmi_highest_active_page_priority = hmi_priority_cnt; } /*HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT);*/ } } } #endif  } } else if(hmi_layer_0_active_page_id[phmi_page_info->page_priority].new_page  != hmi_object_id) { HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); #if HMI_EVENT_STAND_NUMBER>0 hmi_do_event(hmi_layer_0_active_page_id[phmi_page_info ->page_priority].new_page,HMI_PAGE_OFF); hmi_do_event(hmi_object_id,HMI_PAGE_ON); #endif hmi_layer_0_active_page_id[phmi_page_info ->page_priority].old_page=hmi_layer_0_active_page_id[phmi_page_info ->page_priority].new_page; hmi_layer_0_active_page_id[phmi_page_info ->page_priority].new_page= (HMI_PAGE_ID_STR)hmi_object_id; #if defined(HMI_GRAPHIC_RGL)  /*off old page video*/ off_layer_video();  /*record new page layer and element id*/ hmi_access_layer_video_status(hmi_object_id);  #endif #if HMI_LAYER_0_HIGHEST_PRIORITY > 1  hmi_priority_cnt = HMI_LAYER_0_HIGHEST_PRIORITY; if(hmi_highest_active_page_priority == HMI_LAYER_0_HIGHEST_PRIORITY) { hmi_highest_active_page_priority = phmi_page_info->page_priority; } else if(phmi_page_info ->page_priority > hmi_highest_active_page_priority) { hmi_highest_active_page_priority = phmi_page_info ->page_priority; } else { hmi_priority_cnt = hmi_highest_active_page_priority; }  #endif  } else if(hmi_object_data == HMI_REFRESH_PAGE_BIT) { HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } else { } } } } #endif  #if HMI_DXY_CONTAINERS_NUMBER > 0 void hmi_engine_set_dxy_container(HMI_OBJECT_ID_STR hmi_object_id,HMI_OBJECT_DATA_STR hmi_object_data) {  if(HMI_IS_DYN_XY_CONTAINER_PROPERTY(hmi_object_id)) {  if(HMI_IS_DYN_X_CONTAINER(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_X_CONTAINER_INDEX(hmi_object_id); if(hmi_object_id <HMI_DXY_CONTAINERS_NUMBER) { if(hmi_dyn_xy_container_rect[hmi_object_id].x != (HMI_X_STR)hmi_object_data) { /*RGL container support video*/ #ifdef HMI_GRAPHIC_RGL if(hmi_dxy_container_video_fmt[hmi_object_id].video_fmt_channel&HMI_VIDEO_WINDOW) { /*set video xy change flag*/ hmi_dxy_container_video_status[hmi_object_id]=hmi_dxy_container_video_status[hmi_object_id]|HMI_VIDEO_XY_FLAG; } #endif hmi_dyn_xy_container_rect[hmi_object_id].x = (HMI_X_STR)hmi_object_data; hmi_object_id = HMI_DXY_CONTAINER_PRO2DXY_CONTAINER(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT);  } } } else if(HMI_IS_DYN_Y_CONTAINER(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_Y_CONTAINER_INDEX(hmi_object_id); if(hmi_object_id <HMI_DXY_CONTAINERS_NUMBER) { if(hmi_dyn_xy_container_rect[hmi_object_id].y != (HMI_Y_STR)hmi_object_data) { /*RGL container support video*/ #ifdef HMI_GRAPHIC_RGL if(hmi_dxy_container_video_fmt[hmi_object_id].video_fmt_channel&HMI_VIDEO_WINDOW) { /*set video xy change flag*/ hmi_dxy_container_video_status[hmi_object_id]=hmi_dxy_container_video_status[hmi_object_id]|HMI_VIDEO_XY_FLAG; } #endif hmi_dyn_xy_container_rect[hmi_object_id].y = (HMI_Y_STR)hmi_object_data; hmi_object_id = HMI_DXY_CONTAINER_PRO2DXY_CONTAINER(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT);  } } } else if(HMI_IS_DYN_W_CONTAINER(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_W_CONTAINER_INDEX(hmi_object_id); if(hmi_object_id <HMI_DXY_CONTAINERS_NUMBER) { if(hmi_dyn_xy_container_rect[hmi_object_id].w != (HMI_WIDTH_STR)hmi_object_data) { /*RGL container support video*/ #ifdef HMI_GRAPHIC_RGL if(hmi_dxy_container_video_fmt[hmi_object_id].video_fmt_channel&HMI_VIDEO_WINDOW) { /*set video wh change flag*/ hmi_dxy_container_video_status[hmi_object_id]=hmi_dxy_container_video_status[hmi_object_id]|HMI_VIDEO_WH_FLAG; } #endif hmi_dyn_xy_container_rect[hmi_object_id].w = (HMI_WIDTH_STR)hmi_object_data; hmi_object_id = HMI_DXY_CONTAINER_PRO2DXY_CONTAINER(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT);  } } } else if(HMI_IS_DYN_H_CONTAINER(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_H_CONTAINER_INDEX(hmi_object_id); if(hmi_object_id <HMI_DXY_CONTAINERS_NUMBER) { if(hmi_dyn_xy_container_rect[hmi_object_id].h != (HMI_HEIGHT_STR)hmi_object_data) { /*RGL container support video*/ #ifdef HMI_GRAPHIC_RGL if(hmi_dxy_container_video_fmt[hmi_object_id].video_fmt_channel&HMI_VIDEO_WINDOW) { /*set video wh change flag*/ hmi_dxy_container_video_status[hmi_object_id]=hmi_dxy_container_video_status[hmi_object_id]|((BYTE)HMI_VIDEO_WH_FLAG); } #endif hmi_dyn_xy_container_rect[hmi_object_id].h = (HMI_HEIGHT_STR)hmi_object_data; hmi_object_id = HMI_DXY_CONTAINER_PRO2DXY_CONTAINER(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT);  } } } else { ; } }  } #endif #if HMI_DXY_BITMAPS_NUMBER > 0U void hmi_engine_set_dxy_bitmaps(HMI_OBJECT_ID_STR hmi_object_id,HMI_OBJECT_DATA_STR hmi_object_data) {  #if HMI_SUPPORT_FLOAT_ANGEL==HMI_YES float_32 value_angel=0; #endif HMI_OBJECT_DATA_STR hmi_object_id_index = 0; if(HMI_IS_DYN_XY_BITMAP_PROPERTY(hmi_object_id)) { if(HMI_IS_DYN_X_BITMAP(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_X_BITMAPS_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_BITMAPS_NUMBER) {  if(hmi_bmp_dyn_xy_rect[hmi_object_id].x != (HMI_X_STR)(hmi_object_data)) { hmi_bmp_dyn_xy_rect[hmi_object_id].x = (HMI_X_STR)(hmi_object_data); hmi_object_id = HMI_DXY_BITMAP_PRO2DXY_BITMAP(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); }  } } else if(HMI_IS_DYN_Y_BITMAP(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_Y_BITMAPS_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_BITMAPS_NUMBER) { if(hmi_bmp_dyn_xy_rect[hmi_object_id].y != (HMI_Y_STR)(hmi_object_data)) { hmi_bmp_dyn_xy_rect[hmi_object_id].y = (HMI_Y_STR)(hmi_object_data); hmi_object_id = HMI_DXY_BITMAP_PRO2DXY_BITMAP(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_W_BITMAP(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_W_BITMAPS_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_BITMAPS_NUMBER) { if(hmi_bmp_dyn_xy_rect[hmi_object_id].w != (HMI_WIDTH_STR)(hmi_object_data)) { hmi_bmp_dyn_xy_rect[hmi_object_id].w = (HMI_WIDTH_STR)(hmi_object_data); hmi_object_id = HMI_DXY_BITMAP_PRO2DXY_BITMAP(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_H_BITMAP(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_H_BITMAPS_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_BITMAPS_NUMBER) { if(hmi_bmp_dyn_xy_rect[hmi_object_id].h != (HMI_HEIGHT_STR)hmi_object_data) { hmi_bmp_dyn_xy_rect[hmi_object_id].h = (HMI_HEIGHT_STR)hmi_object_data; hmi_object_id = HMI_DXY_BITMAP_PRO2DXY_BITMAP(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)) else if(HMI_IS_DYN_ALPHA_BITMAP(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_ALPHA_BITMAPS_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_BITMAPS_NUMBER) { if(hmi_bmp_dyn_xy_rect[hmi_object_id].alpha!= (UINT8)hmi_object_data) { hmi_bmp_dyn_xy_rect[hmi_object_id].alpha = (UINT8)hmi_object_data; hmi_object_id = HMI_DXY_BITMAP_PRO2DXY_BITMAP(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_ANGEL_BITMAP(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_ANGEL_BITMAPS_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_BITMAPS_NUMBER) { #if HMI_SUPPORT_FLOAT_ANGEL==HMI_YES value_angel =HMI_U32_TO_F32(hmi_object_data); if(hmi_bmp_dyn_xy_rect[hmi_object_id].angel != value_angel) #else if(hmi_bmp_dyn_xy_rect[hmi_object_id].angel != (hmi_object_data)) #endif { #if HMI_SUPPORT_FLOAT_ANGEL==HMI_YES hmi_bmp_dyn_xy_rect[hmi_object_id].angel = value_angel; #else hmi_bmp_dyn_xy_rect[hmi_object_id].angel = (hmi_object_data); #endif hmi_object_id = HMI_DXY_BITMAP_PRO2DXY_BITMAP(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } #endif #if (defined(HMI_GRAPHIC_RGL)) else if(HMI_IS_DYN_BLUR_BITMAP(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_BLUR_BITMAPS_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_BITMAPS_NUMBER) { if((hmi_bmp_dyn_xy_rect[hmi_object_id].attr & HMI_BLUR_FLAG)!= (UINT8)(hmi_object_data)) { if(hmi_object_data==HMI_BLUR_FLAG) { hmi_bmp_dyn_xy_rect[hmi_object_id].attr |= (UINT8)HMI_BLUR_FLAG; hmi_object_id = HMI_DXY_BITMAP_PRO2DXY_BITMAP(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } else { hmi_bmp_dyn_xy_rect[hmi_object_id].attr &= ((UINT8)(~HMI_BLUR_FLAG)); hmi_object_id = HMI_DXY_BITMAP_PRO2DXY_BITMAP(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT);  } } } } #endif #if (defined(HMI_GRAPHIC_RGL)) else if(HMI_IS_DYN_TRAIL_BITMAP(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_TRAIL_BITMAPS_INDEX(hmi_object_id); if(hmi_object_id >= HMI_DXY_CENTER_BITMAPS_NUMBER) { hmi_object_id_index = hmi_object_id - HMI_DXY_CENTER_BITMAPS_NUMBER; if(hmi_object_id_index < HMI_DXY_ROTATION_BITMAPS_NUMBER) { #if HMI_DXY_ROTATION_BITMAPS_NUMBER > 0 if((hmi_dxy_bitmap_rotation_trail_attr[hmi_object_id_index] & HMI_BMP_TRAIL) != (UINT8)(hmi_object_data)) { if(hmi_object_data == HMI_ROT_IMAGE_TAIL_CW) { hmi_dxy_bitmap_rotation_trail_attr[hmi_object_id_index] |= (UINT8)HMI_ROT_IMAGE_TAIL_CW; hmi_object_id = HMI_DXY_BITMAP_PRO2DXY_BITMAP(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } else { hmi_dxy_bitmap_rotation_trail_attr[hmi_object_id_index] &= ((UINT8)(~HMI_ROT_IMAGE_TAIL_CW)); hmi_object_id = HMI_DXY_BITMAP_PRO2DXY_BITMAP(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } #endif } } } #endif else { ; } } } #endif #if HMI_DXY_IMAGELIST_NUMBER >0U void hmi_engine_set_dxy_imagelist(HMI_OBJECT_ID_STR hmi_object_id,HMI_OBJECT_DATA_STR hmi_object_data) {  if(HMI_IS_DYN_XY_IMGLIST_PROPERTY(hmi_object_id)) { if(HMI_IS_DYN_X_IMAGELIST(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_X_IMAGELIST_INDEX(hmi_object_id); if(hmi_object_id<HMI_DXY_IMAGELIST_NUMBER) { if(hmi_dxy_imagelist_rect[hmi_object_id].x != (HMI_X_STR)hmi_object_data) { hmi_dxy_imagelist_rect[hmi_object_id].x = (HMI_X_STR)hmi_object_data; hmi_object_id = HMI_DXY_IMGLIST_PRO2DXY_IMGLIST(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_Y_IMAGELIST(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_Y_IMAGELIST_INDEX(hmi_object_id); if(hmi_object_id<HMI_DXY_IMAGELIST_NUMBER) { if(hmi_dxy_imagelist_rect[hmi_object_id].y != (HMI_Y_STR)hmi_object_data) { hmi_dxy_imagelist_rect[hmi_object_id].y = (HMI_Y_STR)hmi_object_data; hmi_object_id = HMI_DXY_IMGLIST_PRO2DXY_IMGLIST(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_W_IMAGELIST(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_W_IMAGELIST_INDEX(hmi_object_id); if(hmi_object_id<HMI_DXY_IMAGELIST_NUMBER) { if(hmi_dxy_imagelist_rect[hmi_object_id].w !=(HMI_WIDTH_STR) hmi_object_data) { hmi_dxy_imagelist_rect[hmi_object_id].w = (HMI_WIDTH_STR)hmi_object_data; hmi_object_id = HMI_DXY_IMGLIST_PRO2DXY_IMGLIST(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_H_IMAGELIST(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_H_IMAGELIST_INDEX(hmi_object_id); if(hmi_object_id<HMI_DXY_IMAGELIST_NUMBER) { if(hmi_dxy_imagelist_rect[hmi_object_id].h != (HMI_HEIGHT_STR)hmi_object_data) { hmi_dxy_imagelist_rect[hmi_object_id].h = (HMI_HEIGHT_STR)hmi_object_data; hmi_object_id = HMI_DXY_IMGLIST_PRO2DXY_IMGLIST(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_ALPHA_IMAGELIST(hmi_object_id)) { #if (defined(HMI_GRAPHIC_STGLIB)||defined(HMI_GRAPHIC_AGG)|| \ defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_TWLIB))  hmi_object_id = HMI_GET_DYN_ALPHA_IMAGELIST_INDEX(hmi_object_id); if(hmi_object_id<HMI_DXY_IMAGELIST_NUMBER) { if(hmi_dxy_imagelist_rect[hmi_object_id].alpha != (UINT8)hmi_object_data) { hmi_dxy_imagelist_rect[hmi_object_id].alpha = (UINT8)hmi_object_data; hmi_object_id = HMI_DXY_IMGLIST_PRO2DXY_IMGLIST(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } #endif }  else { } } } #endif #if HMI_DXY_SCROLLBAR_NUMBER >0U #ifndef HMI_GRAPHIC_TWLIB void hmi_engine_set_dxy_scrollbar(HMI_OBJECT_ID_STR hmi_object_id,HMI_OBJECT_DATA_STR hmi_object_data) {  if(HMI_IS_DYN_XY_SCROLLBAR_PROPERTY(hmi_object_id)) { if(HMI_IS_DYN_X_SCROLLBAR(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_X_SCROLLBAR_INDEX(hmi_object_id); if(hmi_object_id<HMI_DXY_SCROLLBAR_NUMBER) { if(hmi_dxy_scrollbar_rect[hmi_object_id].x != (HMI_X_STR)hmi_object_data) { hmi_dxy_scrollbar_rect[hmi_object_id].x = (HMI_X_STR)hmi_object_data; hmi_object_id=HMI_DXY_SCROLLBAR_PRO2DXY_SCROLLBAR(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_Y_SCROLLBAR(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_Y_SCROLLBAR_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_SCROLLBAR_NUMBER) { if(hmi_dxy_scrollbar_rect[hmi_object_id].y != (HMI_Y_STR)hmi_object_data) { hmi_dxy_scrollbar_rect[hmi_object_id].y = (HMI_Y_STR)hmi_object_data; hmi_object_id = HMI_DXY_SCROLLBAR_PRO2DXY_SCROLLBAR(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_W_SCROLLBAR(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_W_SCROLLBAR_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_SCROLLBAR_NUMBER) { if(hmi_dxy_scrollbar_rect[hmi_object_id].w != (HMI_WIDTH_STR)hmi_object_data) { hmi_dxy_scrollbar_rect[hmi_object_id].w = (HMI_WIDTH_STR)hmi_object_data; hmi_object_id = HMI_DXY_SCROLLBAR_PRO2DXY_SCROLLBAR(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_H_SCROLLBAR(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_H_SCROLLBAR_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_SCROLLBAR_NUMBER) { if(hmi_dxy_scrollbar_rect[hmi_object_id].h != (HMI_HEIGHT_STR)hmi_object_data) { hmi_dxy_scrollbar_rect[hmi_object_id].h = (HMI_HEIGHT_STR)hmi_object_data; hmi_object_id = HMI_DXY_SCROLLBAR_PRO2DXY_SCROLLBAR(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_ALPHA_SCROLLBAR(hmi_object_id)) { #if (defined(HMI_GRAPHIC_STGLIB)||defined(HMI_GRAPHIC_AGG)|| \ defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_TWLIB))  hmi_object_id = HMI_GET_DYN_ALPHA_SCROLLBAR_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_SCROLLBAR_NUMBER) { if(hmi_dxy_scrollbar_rect[hmi_object_id].alpha != (UINT8)hmi_object_data) { hmi_dxy_scrollbar_rect[hmi_object_id].alpha = (UINT8)hmi_object_data; hmi_object_id = HMI_DXY_SCROLLBAR_PRO2DXY_SCROLLBAR(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } #endif } else  { } } } #endif #endif #if HMI_DXY_BUTTON_NUMBER>0U void hmi_engine_set_dxy_button(HMI_OBJECT_ID_STR hmi_object_id,HMI_OBJECT_DATA_STR hmi_object_data) { if(HMI_IS_DYN_XY_BUTTON_PROPERTY(hmi_object_id)) { if(HMI_IS_DYN_X_BUTTON(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_X_BUTTON_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_BUTTON_NUMBER) { if(hmi_dxy_button_rect[hmi_object_id].x != (HMI_X_STR)hmi_object_data) { hmi_dxy_button_rect[hmi_object_id].x = (HMI_X_STR)hmi_object_data; hmi_object_id = HMI_DXY_BUTTON_PRO2DXY_BUTTON(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_Y_BUTTON(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_Y_BUTTON_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_BUTTON_NUMBER) { if(hmi_dxy_button_rect[hmi_object_id].y != (HMI_Y_STR)hmi_object_data) { hmi_dxy_button_rect[hmi_object_id].y = (HMI_Y_STR)hmi_object_data; hmi_object_id = HMI_DXY_BUTTON_PRO2DXY_BUTTON(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_W_BUTTON(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_W_BUTTON_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_BUTTON_NUMBER) { if(hmi_dxy_button_rect[hmi_object_id].w != (HMI_WIDTH_STR)hmi_object_data) { hmi_dxy_button_rect[hmi_object_id].w = (HMI_WIDTH_STR)hmi_object_data; hmi_object_id = HMI_DXY_BUTTON_PRO2DXY_BUTTON(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_H_BUTTON(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_H_BUTTON_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_BUTTON_NUMBER) { if(hmi_dxy_button_rect[hmi_object_id].h != (HMI_HEIGHT_STR)hmi_object_data) { hmi_dxy_button_rect[hmi_object_id].h = (HMI_HEIGHT_STR)hmi_object_data; hmi_object_id = HMI_DXY_BUTTON_PRO2DXY_BUTTON(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_ALPHA_BUTTON(hmi_object_id)) { #if (defined(HMI_GRAPHIC_STGLIB)||defined(HMI_GRAPHIC_AGG)|| \ defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_TWLIB))  hmi_object_id = HMI_GET_DYN_ALPHA_BUTTON_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_BUTTON_NUMBER) { if(hmi_dxy_button_rect[hmi_object_id].alpha != (UINT8)hmi_object_data) { hmi_dxy_button_rect[hmi_object_id].alpha = (UINT8)hmi_object_data; hmi_object_id = HMI_DXY_BUTTON_PRO2DXY_BUTTON(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } #endif } else  { } }  } #endif #if HMI_DXY_PAGES_NUMBER>0U void hmi_engine_set_dyn_pages(HMI_OBJECT_ID_STR hmi_object_id,HMI_OBJECT_DATA_STR hmi_object_data) {  if(HMI_IS_DYN_XY_PAGE_PROPERTY(hmi_object_id)) { if(HMI_IS_DYN_X_PAGES(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_X_PAGES_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_PAGES_NUMBER) { if(hmi_dxy_page_rect[hmi_object_id].x != (HMI_X_STR)hmi_object_data) { hmi_dxy_page_rect[hmi_object_id].x = (HMI_X_STR)hmi_object_data; hmi_object_id = HMI_DXY_PAGE_PRO2DXY_PAGE(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_Y_PAGES(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_Y_PAGES_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_PAGES_NUMBER) { if(hmi_dxy_page_rect[hmi_object_id].y != (HMI_Y_STR)hmi_object_data) { hmi_dxy_page_rect[hmi_object_id].y = (HMI_Y_STR)hmi_object_data; hmi_object_id = HMI_DXY_PAGE_PRO2DXY_PAGE(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_W_PAGES(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_W_PAGES_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_PAGES_NUMBER) { if(hmi_dxy_page_rect[hmi_object_id].w != (HMI_WIDTH_STR)hmi_object_data) { hmi_dxy_page_rect[hmi_object_id].w =(HMI_WIDTH_STR) hmi_object_data; hmi_object_id = HMI_DXY_PAGE_PRO2DXY_PAGE(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_H_PAGES(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_H_PAGES_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_PAGES_NUMBER) { if(hmi_dxy_page_rect[hmi_object_id].h != (HMI_HEIGHT_STR)hmi_object_data) { hmi_dxy_page_rect[hmi_object_id].h = (HMI_HEIGHT_STR)hmi_object_data; hmi_object_id = HMI_DXY_PAGE_PRO2DXY_PAGE(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_ALPHA_PAGES(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_ALPHA_PAGES_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_PAGES_NUMBER) { if(hmi_dxy_page_rect[hmi_object_id].alpha != (UINT8)hmi_object_data) { hmi_dxy_page_rect[hmi_object_id].alpha = (UINT8)hmi_object_data; hmi_object_id = HMI_DXY_PAGE_PRO2DXY_PAGE(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); #ifdef HMI_GRAPHIC_RGL /*page alpha change not draw page*/ HMI_GFX_SET_STATUS(HMI_RGL_PROP_EVENT); #else HMI_GFX_SET_STATUS(HMI_SEND_EVENT); #endif } } } else { } } } #endif  #if HMI_DYN_XY_EDIT_TEXTS_NUMBER > 0U void hmi_engine_set_dxy_edit_texts(HMI_OBJECT_ID_STR hmi_object_id,HMI_OBJECT_DATA_STR hmi_object_data) {  if(HMI_IS_DYN_XY_DTEXT_PROPERTY(hmi_object_id)) { if(HMI_IS_DYN_X_DTEXT(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_X_DTEXT_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DYN_XY_EDIT_TEXTS_NUMBER) { if((HMI_X_STR)(hmi_object_data) != hmi_dyn_xy_edit_text_prop_table[hmi_object_id].text_rect.x) { hmi_dyn_xy_edit_text_prop_table[hmi_object_id].text_rect.x = (HMI_X_STR)(hmi_object_data);  hmi_object_id = HMI_DXY_DTEXT_PRO2DXY_DTEXT(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_Y_DTEXT(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_Y_DTEXT_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DYN_XY_EDIT_TEXTS_NUMBER) { if((HMI_Y_STR)(hmi_object_data) != hmi_dyn_xy_edit_text_prop_table[hmi_object_id].text_rect.y) { hmi_dyn_xy_edit_text_prop_table[hmi_object_id].text_rect.y = (HMI_Y_STR)(hmi_object_data);  hmi_object_id = HMI_DXY_DTEXT_PRO2DXY_DTEXT(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_W_DTEXT(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_W_DTEXT_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DYN_XY_EDIT_TEXTS_NUMBER) { if((HMI_WIDTH_STR)hmi_object_data != hmi_dyn_xy_edit_text_prop_table[hmi_object_id].text_rect.w) { hmi_dyn_xy_edit_text_prop_table[hmi_object_id].text_rect.w = (HMI_WIDTH_STR)hmi_object_data;  hmi_object_id = HMI_DXY_DTEXT_PRO2DXY_DTEXT(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_H_DTEXT(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_H_DTEXT_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DYN_XY_EDIT_TEXTS_NUMBER) { if((HMI_HEIGHT_STR)hmi_object_data != hmi_dyn_xy_edit_text_prop_table[hmi_object_id].text_rect.h) { hmi_dyn_xy_edit_text_prop_table[hmi_object_id].text_rect.h = (HMI_HEIGHT_STR)hmi_object_data;  hmi_object_id = HMI_DXY_DTEXT_PRO2DXY_DTEXT(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_DCOLOR_DTEXT(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_DCOLOR_DTEXT_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DYN_XY_EDIT_TEXTS_NUMBER) { if((HMI_COLOR_STR)(hmi_object_data) != hmi_dyn_xy_edit_text_prop_table[hmi_object_id].color) { hmi_dyn_xy_edit_text_prop_table[hmi_object_id].color = (HMI_COLOR_STR)(hmi_object_data);  hmi_object_id = HMI_DXY_DTEXT_PRO2DXY_DTEXT(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } }  else { } } } #endif   #if HMI_UNEDIT_TEXTS_DYN_XY_NUMBER > 0U void hmi_engine_set_dxy_unedit_texts(HMI_OBJECT_ID_STR hmi_object_id,HMI_OBJECT_DATA_STR hmi_object_data) {  if(HMI_IS_DYN_XY_STEXT_PROPERTY(hmi_object_id)) { if(HMI_IS_DYN_X_UNEDIT(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_X_STEXT_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_UNEDIT_TEXTS_DYN_XY_NUMBER) { if((HMI_X_STR)(hmi_object_data) != hmi_dyn_xy_unedit_text_prop_table[hmi_object_id].text_rect.x) { hmi_dyn_xy_unedit_text_prop_table[hmi_object_id].text_rect.x = (HMI_X_STR)(hmi_object_data);  hmi_object_id = HMI_DXY_STEXT_PRO2DXY_STEXT(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_Y_UNEDIT(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_Y_STEXT_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_UNEDIT_TEXTS_DYN_XY_NUMBER) { if((HMI_Y_STR)(hmi_object_data) != hmi_dyn_xy_unedit_text_prop_table[hmi_object_id].text_rect.y) { hmi_dyn_xy_unedit_text_prop_table[hmi_object_id].text_rect.y = (HMI_Y_STR)(hmi_object_data);  hmi_object_id = HMI_DXY_STEXT_PRO2DXY_STEXT(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_W_UNEDIT(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_W_STEXT_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_UNEDIT_TEXTS_DYN_XY_NUMBER) { if((HMI_WIDTH_STR)hmi_object_data != hmi_dyn_xy_unedit_text_prop_table[hmi_object_id].text_rect.w) { hmi_dyn_xy_unedit_text_prop_table[hmi_object_id].text_rect.w = (HMI_WIDTH_STR)hmi_object_data;  hmi_object_id = HMI_DXY_STEXT_PRO2DXY_STEXT(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_H_UNEDIT(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_H_STEXT_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_UNEDIT_TEXTS_DYN_XY_NUMBER) { if((HMI_HEIGHT_STR)hmi_object_data != hmi_dyn_xy_unedit_text_prop_table[hmi_object_id].text_rect.h) { hmi_dyn_xy_unedit_text_prop_table[hmi_object_id].text_rect.h = (HMI_HEIGHT_STR)hmi_object_data;  hmi_object_id = HMI_DXY_STEXT_PRO2DXY_STEXT(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_COLOR_UNEDIT(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_DCOLOR_STEXT_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_UNEDIT_TEXTS_DYN_XY_NUMBER) { if((HMI_COLOR_STR)(hmi_object_data) != hmi_dyn_xy_unedit_text_prop_table[hmi_object_id].color) { hmi_dyn_xy_unedit_text_prop_table[hmi_object_id].color = (HMI_COLOR_STR)(hmi_object_data);  hmi_object_id = HMI_DXY_STEXT_PRO2DXY_STEXT(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } }  else { } } } #endif   #if HMI_DYN_FILL_PAGES_NUMBER > 0U void hmi_engine_set_dyn_fill_pages(HMI_OBJECT_ID_STR hmi_object_id,HMI_OBJECT_DATA_STR hmi_object_data) {  if(HMI_IS_DYN_XY_FILL_PROPERTY(hmi_object_id)) { if(HMI_IS_DYN_X_NFILL(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_X_NFILL_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DYN_FILL_PAGES_NUMBER) { if((HMI_X_STR)(hmi_object_data) != hmi_fills_dyn_xy_rect[hmi_object_id].x) { hmi_fills_dyn_xy_rect[hmi_object_id].x = (HMI_X_STR)(hmi_object_data); hmi_object_id = HMI_DXY_FILL_PRO2DXY_FILL(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_Y_NFILL(hmi_object_id)/*hmi_object_id < HMI_DYN_Y_NFILL_MAX_ID*/) { hmi_object_id = HMI_GET_DYN_Y_NFILL_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DYN_FILL_PAGES_NUMBER) { if((HMI_Y_STR)(hmi_object_data) != hmi_fills_dyn_xy_rect[hmi_object_id].y) { hmi_fills_dyn_xy_rect[hmi_object_id].y = (HMI_Y_STR)(hmi_object_data); hmi_object_id = HMI_DXY_FILL_PRO2DXY_FILL(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_W_NFILL(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_W_NFILL_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DYN_FILL_PAGES_NUMBER) { if((HMI_WIDTH_STR)(hmi_object_data) != hmi_fills_dyn_xy_rect[hmi_object_id].w) { hmi_fills_dyn_xy_rect[hmi_object_id].w = (HMI_WIDTH_STR)(hmi_object_data);  hmi_object_id = HMI_DXY_FILL_PRO2DXY_FILL(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } }  else if(HMI_IS_DYN_H_NFILL(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_H_NFILL_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DYN_FILL_PAGES_NUMBER) { if((HMI_HEIGHT_STR)(hmi_object_data) != hmi_fills_dyn_xy_rect[hmi_object_id].h) { hmi_fills_dyn_xy_rect[hmi_object_id].h = (HMI_HEIGHT_STR)(hmi_object_data);  hmi_object_id = HMI_DXY_FILL_PRO2DXY_FILL(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_COLOR_NFILL(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_COLOR_NFILL_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DYN_FILL_PAGES_NUMBER) { if((HMI_COLOR_STR)(hmi_object_data) != hmi_fills_dyn_prop_table[hmi_object_id].color) { hmi_fills_dyn_prop_table[hmi_object_id].color = (HMI_COLOR_STR)(hmi_object_data);  hmi_object_id = HMI_DXY_FILL_PRO2DXY_FILL(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_Z_NFILL(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_Z_NFILL_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DYN_FILL_PAGES_NUMBER) { if((HMI_Z_STR)(hmi_object_data) != hmi_fills_dyn_xy_rect[hmi_object_id].z) { hmi_fills_dyn_xy_rect[hmi_object_id].z= (HMI_Z_STR)(hmi_object_data);  hmi_object_id = HMI_DXY_FILL_PRO2DXY_FILL(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else { } } } #endif  #if HMI_DYN_GFILL_NUMBER > 0U #ifndef HMI_GRAPHIC_TWLIB void hmi_engine_set_dyn_gfill_pages(HMI_OBJECT_ID_STR hmi_object_id,HMI_OBJECT_DATA_STR hmi_object_data) {  if(HMI_IS_DYN_XY_GFILL_PROPERTY(hmi_object_id)) { if(HMI_IS_DYN_X_GFILL(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_X_GFILL_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DYN_GFILL_NUMBER) { if((HMI_X_STR)(hmi_object_data) != hmi_gradient_dxy_fill_rect[hmi_object_id].x) { hmi_gradient_dxy_fill_rect[hmi_object_id].x = (HMI_X_STR)(hmi_object_data);  hmi_object_id = HMI_DXY_GFILL_PRO2DXY_GFILL(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_Y_GFILL(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_Y_GFILL_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DYN_GFILL_NUMBER) { if((HMI_Y_STR)(hmi_object_data) != hmi_gradient_dxy_fill_rect[hmi_object_id].y) { hmi_gradient_dxy_fill_rect[hmi_object_id].y = (HMI_Y_STR)(hmi_object_data);  hmi_object_id = HMI_DXY_GFILL_PRO2DXY_GFILL(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_W_GFILL(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_W_GFILL_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DYN_GFILL_NUMBER) { if((HMI_WIDTH_STR)(hmi_object_data) != hmi_gradient_dxy_fill_rect[hmi_object_id].w) { hmi_gradient_dxy_fill_rect[hmi_object_id].w = (HMI_WIDTH_STR)(hmi_object_data);  hmi_object_id = HMI_DXY_GFILL_PRO2DXY_GFILL(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } }  else if(HMI_IS_DYN_H_GFILL(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_H_GFILL_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DYN_GFILL_NUMBER) { if((HMI_HEIGHT_STR)(hmi_object_data) != hmi_gradient_dxy_fill_rect[hmi_object_id].h) { hmi_gradient_dxy_fill_rect[hmi_object_id].h = (HMI_HEIGHT_STR)(hmi_object_data);  hmi_object_id = HMI_DXY_GFILL_PRO2DXY_GFILL(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_C1_GFILL(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_C1_GFILL_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DYN_GFILL_NUMBER) { if((HMI_COLOR_STR)(hmi_object_data) != hmi_gradient_dxy_fill_table[hmi_object_id].color1) { hmi_gradient_dxy_fill_table[hmi_object_id].color1= (HMI_COLOR_STR)(hmi_object_data);  hmi_object_id = HMI_DXY_GFILL_PRO2DXY_GFILL(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_C2_GFILL(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_C2_GFILL_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DYN_GFILL_NUMBER) { if((HMI_COLOR_STR)(hmi_object_data) != hmi_gradient_dxy_fill_table[hmi_object_id].color2) { hmi_gradient_dxy_fill_table[hmi_object_id].color2= (HMI_COLOR_STR)(hmi_object_data);  hmi_object_id = HMI_DXY_GFILL_PRO2DXY_GFILL(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_Z_GFILL(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_Z_GFILL_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DYN_GFILL_NUMBER) { if((HMI_Z_STR)(hmi_object_data) != hmi_gradient_dxy_fill_rect[hmi_object_id].z) { hmi_gradient_dxy_fill_rect[hmi_object_id].z= (HMI_Z_STR)(hmi_object_data);  hmi_object_id = HMI_DXY_GFILL_PRO2DXY_GFILL(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else  { } } } #endif #endif #if HMI_DXY_CUBE_NUMBER > 0U void hmi_engine_set_dyn_cube(HMI_OBJECT_ID_STR hmi_object_id,HMI_OBJECT_DATA_STR hmi_object_data) {  #if HMI_SUPPORT_FLOAT_ANGEL==HMI_YES float_32 value_angel=0; #endif if(HMI_IS_DYN_XY_CUBE_PROPERTY(hmi_object_id)) { if(HMI_IS_DYN_X_CUBE(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_X_CUBE_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_CUBE_NUMBER) { if((HMI_X_STR)(hmi_object_data) != hmi_cubes_dyn_xy_rect[hmi_object_id].cube_rect.x) { hmi_cubes_dyn_xy_rect[hmi_object_id].cube_rect.x = (HMI_X_STR)(hmi_object_data);  hmi_object_id = HMI_DXY_CUBED_PRO2DXY_CUBE(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_Y_CUBE(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_Y_CUBE_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_CUBE_NUMBER) { if((HMI_Y_STR)(hmi_object_data) != hmi_cubes_dyn_xy_rect[hmi_object_id].cube_rect.y) { hmi_cubes_dyn_xy_rect[hmi_object_id].cube_rect.y= (HMI_Y_STR)(hmi_object_data);  hmi_object_id = HMI_DXY_CUBED_PRO2DXY_CUBE(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_W_CUBE(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_W_CUBE_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_CUBE_NUMBER) { if((HMI_WIDTH_STR)(hmi_object_data) != hmi_cubes_dyn_xy_rect[hmi_object_id].cube_rect.w) { hmi_cubes_dyn_xy_rect[hmi_object_id].cube_rect.w= (HMI_WIDTH_STR)(hmi_object_data);  hmi_object_id = HMI_DXY_CUBED_PRO2DXY_CUBE(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } }  else if(HMI_IS_DYN_H_CUBE(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_H_CUBE_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_CUBE_NUMBER) { if((HMI_WIDTH_STR)(hmi_object_data) != hmi_cubes_dyn_xy_rect[hmi_object_id].cube_rect.h) { hmi_cubes_dyn_xy_rect[hmi_object_id].cube_rect.h= (HMI_HEIGHT_STR)(hmi_object_data);  hmi_object_id = HMI_DXY_CUBED_PRO2DXY_CUBE(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_BUMP_CUBE(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_BUMP_CUBE_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_CUBE_NUMBER) { if((BOOLEAN)(hmi_object_data) != hmi_cubes_dyn_xy_rect[hmi_object_id].bump) { hmi_cubes_dyn_xy_rect[hmi_object_id].bump= (BOOLEAN)(hmi_object_data);  hmi_object_id = HMI_DXY_CUBED_PRO2DXY_CUBE(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_ANGEL_CUBE(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_ANGEL_CUBE_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_CUBE_NUMBER) { #if HMI_SUPPORT_FLOAT_ANGEL==HMI_YES value_angel =HMI_U32_TO_F32(hmi_object_data); if(hmi_cubes_dyn_xy_rect[hmi_object_id].angel!=value_angel ) #else if(hmi_cubes_dyn_xy_rect[hmi_object_id].angel!= (hmi_object_data)) #endif { #if HMI_SUPPORT_FLOAT_ANGEL==HMI_YES hmi_cubes_dyn_xy_rect[hmi_object_id].angel = value_angel; #else hmi_cubes_dyn_xy_rect[hmi_object_id].angel = (hmi_object_data); #endif hmi_object_id = HMI_DXY_CUBED_PRO2DXY_CUBE(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_PRI_AXIS_CUBE(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_PRI_AXIS_CUBE_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_CUBE_NUMBER) { #if HMI_SUPPORT_FLOAT_ANGEL==HMI_YES value_angel =HMI_U32_TO_F32(hmi_object_data); if(hmi_cubes_dyn_xy_rect[hmi_object_id].private_angel!=value_angel ) #else if(hmi_cubes_dyn_xy_rect[hmi_object_id].private_angel!= (hmi_object_data)) #endif { #if HMI_SUPPORT_FLOAT_ANGEL==HMI_YES hmi_cubes_dyn_xy_rect[hmi_object_id].private_angel= value_angel; #else hmi_cubes_dyn_xy_rect[hmi_object_id].private_angel = (hmi_object_data); #endif hmi_object_id = HMI_DXY_CUBED_PRO2DXY_CUBE(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else if(HMI_IS_DYN_Z_CUBE(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_Z_CUBE_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_CUBE_NUMBER) { if(hmi_cubes_dyn_xy_rect[hmi_object_id].z!= (hmi_object_data)) { hmi_cubes_dyn_xy_rect[hmi_object_id].z = (hmi_object_data); hmi_object_id = HMI_DXY_CUBED_PRO2DXY_CUBE(hmi_object_id); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } else  { } } } #endif  #if ((HMI_SCROLL_TEXT_SUPPORT != 0U) && (HMI_DYN_EDIT_TEXTS_NUMBER > 0U)) #ifndef HMI_GRAPHIC_TWLIB void hmi_engine_set_text_scroll_step(HMI_OBJECT_ID_STR hmi_object_id,HMI_OBJECT_DATA_STR hmi_object_data) {  if(HMI_IS_EDITSCROLL_PROPERTY(hmi_object_id)) { hmi_object_id = HMI_GET_SCROLL_TEXT_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DYN_EDIT_TEXTS_NUMBER) { HMI_TEXT_PROP_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_dyn_text_info = &hmi_edit_text_table[hmi_object_id]; HMI_CHAR_STR hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_data=NULL; HMI_CHAR_STR hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_temp_data=NULL; HMI_OBJECT_DATA_STR fl_data=0U; if((phmi_dyn_text_info->properties & HMI_TEXT_PROP_SCROLABLE) != 0) { phmi_data = &((HMI_CHAR_STR *)(phmi_dyn_text_info->hmi_string))[phmi_dyn_text_info->length+1]; phmi_temp_data=&((HMI_CHAR_STR *)(phmi_dyn_text_info->hmi_string))[phmi_dyn_text_info->length+1]; #if HMI_FONT_CODE==HMI_FONT_CODE_UNICODE fl_data = *phmi_temp_data; #else fl_data = *phmi_temp_data++; (fl_data)<<=8; fl_data += *phmi_temp_data; #endif if(hmi_object_data==HMI_CLEAR_SCROLL_OFFSET) { hmi_object_data=0U; } else { hmi_object_data+=fl_data; } hmi_object_id=HMI_EDITSCROLL_PRO2EDITSCROLL(hmi_object_id); #if HMI_FONT_CODE == HMI_FONT_CODE_UNICODE if(*phmi_data != (HMI_CHAR_STR)hmi_object_data) { *phmi_data =(HMI_CHAR_STR) hmi_object_data;  HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } #else /*hmi_object_id=HMI_GET_SCROLL_PROP_EDIT_TEXT_ID_INDEX(hmi_object_id);*/  if(*phmi_data != (HMI_CHAR_STR)(hmi_object_data>>8)) { *phmi_data = (HMI_CHAR_STR)(hmi_object_data>>8); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } phmi_data++; if(*phmi_data != (HMI_CHAR_STR)(hmi_object_data)) { *phmi_data = (HMI_CHAR_STR)(hmi_object_data); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } #endif } } } } #endif #endif  #if defined(HMI_GRAPHIC_RGL) void hmi_access_layer_video_status(HMI_OBJECT_ID_STR hmi_page_id) { #if HMI_DXY_CONTAINERS_NUMBER > 0U HMI_PAGE_TABLE_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_page_info = NULL; HMI_OBJECT_ID_STR hmi_object_index = 0;  UINT8 hmi_number_object = 0; HMI_OBJECT_PROP_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_container_object_table = NULL; UINT8 hmi_number_object_const = 0; U08 depth = 0; HMI_OBJECT_ID_STR hmi_object_id = 0; clear_layer_video_status();//clear layer_video_element NULL; #if HMI_DXY_PAGES_NUMBER > 0U if(HMI_IS_DXY_PAGE(hmi_page_id)) { hmi_object_index = HMI_GET_PAGE_DXY_ID_INDEX(hmi_page_id); phmi_page_info = &hmi_dxy_page_table[hmi_object_index]; } else #endif #if HMI_SXY_PAGES_NUMBER>0U if(HMI_IS_SXY_PAGE(hmi_page_id))  { hmi_object_index = HMI_GET_PAGE_SXY_ID_INDEX(hmi_page_id); phmi_page_info = &hmi_sxy_page_table[hmi_object_index]; } else #endif { }  if(phmi_page_info !=NULL) { phmi_container_object_table = phmi_page_info->container.container_object_table.p_object_table; hmi_number_object = phmi_page_info->container.container_object_table.object_number; hmi_number_object_const = hmi_number_object;  }  /*draw element*/  while(hmi_number_object > 0)  { depth = (hmi_number_object_const-hmi_number_object);/*node of page no*/ hmi_object_id = phmi_container_object_table->object_id; phmi_container_object_table++; hmi_object_index= 0;   if(HMI_IS_DYN_XY_CONTAINER(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_XY_CONTAINER_INDEX(hmi_object_id ); if(hmi_object_index < HMI_DXY_CONTAINERS_NUMBER) { if(hmi_dxy_container_video_fmt[hmi_object_index].video_fmt_channel &HMI_VIDEO_WINDOW) { /*record depth and video container relation*/ set_layer_video_status(depth,hmi_object_id, &hmi_dxy_container_video_status[hmi_object_index]); }/*2016.9.7. for support video capture in*/ } }   hmi_number_object--; } #endif }  void hmi_engine_create_rgl_window(void) {  HMI_PAGE_TABLE_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_page_info = NULL; HMI_OBJECT_ID_STR hmi_object_index = 0;  HMI_RECT_STR hmi_screen_rect = {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0}; HMI_RECT_STR *pfarther_rect = NULL; UINT8 hmi_number_object = 0; HMI_OBJECT_PROP_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_container_object_table = NULL; UINT8 hmi_number_object_const = 0; U08 depth = 0; HMI_OBJECT_ID_STR hmi_object_id = 0; HMI_OBJECT_ID_STR hmi_page_id = hmi_layer_0_active_page_id[0].new_page; HMI_RECT_STR hmi_rect_temp = {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0}; //hmi_driver_clear_rgl_window();//removed by pxguo 161031 #if HMI_DXY_PAGES_NUMBER > 0U if(HMI_IS_DXY_PAGE(hmi_page_id)) { pfarther_rect = &hmi_dxy_page_rect[hmi_page_id]; phmi_page_info = &hmi_dxy_page_table[hmi_page_id]; } else #endif #if HMI_SXY_PAGES_NUMBER>0U if(HMI_IS_SXY_PAGE(hmi_page_id))  { hmi_object_index= HMI_GET_PAGE_SXY_ID_INDEX(hmi_page_id); pfarther_rect = (HMI_RECT_STR *)&hmi_sxy_page_rect[hmi_object_index]; phmi_page_info = &hmi_sxy_page_table[hmi_object_index];  } else #endif { } if(phmi_page_info != NULL) { phmi_container_object_table = phmi_page_info->container.container_object_table.p_object_table; hmi_number_object = phmi_page_info->container.container_object_table.object_number; hmi_number_object_const = hmi_number_object;  }  /*draw element*/  while(hmi_number_object > 0)  { depth = (hmi_number_object_const-hmi_number_object);/*node of page no*/ hmi_object_id = phmi_container_object_table->object_id; phmi_container_object_table++; hmi_object_index= 0; if(hmi_object_id >= HMI_PAGE_SXY_MAX_ID)/*not a page*/ {  #if HMI_ALL_DYN_OBJECTS_NUMBER >0U if(hmi_object_id < HMI_ALL_DYN_OBJECTS_NUMBER) {  } #endif #if HMI_DXY_IMAGELIST_NUMBER>0 if(HMI_IS_DYN_IMAGELIST_DXY(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_IMAGELIST_DXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_DXY_IMAGELIST_NUMBER) { hmi_rect_temp.x = hmi_dxy_imagelist_rect[hmi_object_index].x; hmi_rect_temp.y = hmi_dxy_imagelist_rect[hmi_object_index].y; hmi_rect_temp.w = hmi_dxy_imagelist_rect[hmi_object_index].w; hmi_rect_temp.h = hmi_dxy_imagelist_rect[hmi_object_index].h; HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_rect_temp), (&(hmi_screen_rect))); }   #ifdef HMI_GRAPHIC_RGL if(hmi_object_index < HMI_DXY_IMAGELIST_NUMBER) { hmi_driver_create_rgl_window((&(hmi_screen_rect)),depth); } #endif  }  else #endif #if HMI_SXY_IMAGELIST_NUMBER>0 if(HMI_IS_DYN_IMAGELIST_SXY(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_IMAGELIST_SXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_SXY_IMAGELIST_NUMBER) { hmi_rect_temp.x = hmi_sxy_imagelist_rect[hmi_object_index].x; hmi_rect_temp.y = hmi_sxy_imagelist_rect[hmi_object_index].y; hmi_rect_temp.w = hmi_sxy_imagelist_rect[hmi_object_index].w; hmi_rect_temp.h = hmi_sxy_imagelist_rect[hmi_object_index].h; HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_rect_temp), (&hmi_screen_rect));  } #ifdef HMI_GRAPHIC_RGL if(hmi_object_index < HMI_SXY_IMAGELIST_NUMBER) { hmi_driver_create_rgl_window((&(hmi_screen_rect)),depth); } #endif  } else #endif #if HMI_DXY_SCROLLBAR_NUMBER>0 if(HMI_IS_DYN_SCROLLBAR_DXY(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_SCROLLBAR_DXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_DXY_SCROLLBAR_NUMBER) { hmi_rect_temp.x = hmi_dxy_scrollbar_rect[hmi_object_index].x; hmi_rect_temp.y = hmi_dxy_scrollbar_rect[hmi_object_index].y; hmi_rect_temp.w = hmi_dxy_scrollbar_rect[hmi_object_index].w; hmi_rect_temp.h = hmi_dxy_scrollbar_rect[hmi_object_index].h; HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_rect_temp), (&(hmi_screen_rect))); }  #ifdef HMI_GRAPHIC_RGL hmi_driver_create_rgl_window((&(hmi_screen_rect)),depth); #endif  } else  #endif #if HMI_SXY_SCROLLBAR_NUMBER>0 if(HMI_IS_DYN_SCROLLBAR_SXY(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_SCROLLBAR_SXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_SXY_SCROLLBAR_NUMBER) { hmi_rect_temp.x = hmi_sxy_scrollbar_rect[hmi_object_index].x; hmi_rect_temp.y = hmi_sxy_scrollbar_rect[hmi_object_index].y; hmi_rect_temp.w = hmi_sxy_scrollbar_rect[hmi_object_index].w; hmi_rect_temp.h = hmi_sxy_scrollbar_rect[hmi_object_index].h; HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_rect_temp), (&(hmi_screen_rect)));  } #ifdef HMI_GRAPHIC_RGL hmi_driver_create_rgl_window((&(hmi_screen_rect)),depth); #endif } else #endif #if HMI_DXY_BUTTON_NUMBER > 0  if(HMI_IS_DYN_BUTTON_DXY(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_BUTTON_DXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_DXY_BUTTON_NUMBER) { hmi_rect_temp.x = hmi_dxy_button_rect[hmi_object_index].x; hmi_rect_temp.y = hmi_dxy_button_rect[hmi_object_index].y; hmi_rect_temp.w = hmi_dxy_button_rect[hmi_object_index].w; hmi_rect_temp.h = hmi_dxy_button_rect[hmi_object_index].h; HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_rect_temp), (&(hmi_screen_rect)));  }  #ifdef HMI_GRAPHIC_RGL  hmi_driver_create_rgl_window((&(hmi_screen_rect)),depth); #endif  }  else #endif #if HMI_SXY_BUTTON_NUMBER>0  if(HMI_IS_DYN_BUTTON_SXY(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_BUTTON_SXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_SXY_BUTTON_NUMBER) { hmi_rect_temp.x = hmi_sxy_button_rect[hmi_object_index].x; hmi_rect_temp.y = hmi_sxy_button_rect[hmi_object_index].y; hmi_rect_temp.w = hmi_sxy_button_rect[hmi_object_index].w; hmi_rect_temp.h = hmi_sxy_button_rect[hmi_object_index].h; HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_rect_temp), (&(hmi_screen_rect)));  } #ifdef HMI_GRAPHIC_RGL hmi_driver_create_rgl_window((&(hmi_screen_rect)),depth); #endif }  else  #endif #if HMI_DYN_EDIT_TEXTS_NUMBER/*editable text*/ > 0  if(HMI_IS_DYN_TEXTS(hmi_object_id)) {  #if HMI_DYN_XY_EDIT_TEXTS_NUMBER > 0 if(HMI_IS_DYN_TEXT_DXY(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_TEXTS_DXY_POS_INDEX(hmi_object_id); if(hmi_object_index < HMI_DYN_XY_EDIT_TEXTS_NUMBER) { hmi_get_object_screen_coor((HMI_RECT_STR CONST *)pfarther_rect, &hmi_dyn_xy_edit_text_prop_table[hmi_object_index].text_rect, &(hmi_screen_rect));  } #ifdef HMI_GRAPHIC_RGL hmi_driver_create_rgl_window((&(hmi_screen_rect)),depth); #endif  } else #endif  #if HMI_S_XY_EDIT_TEXTS_NUMBER > 0 if(HMI_IS_DYN_TEXT_SXY(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_TEXTS_SXY_POS_INDEX(hmi_object_id); if(hmi_object_index < HMI_S_XY_EDIT_TEXTS_NUMBER) { hmi_get_object_screen_coor((HMI_RECT_STR CONST *)pfarther_rect, &hmi_static_xy_edit_text_prop_table[hmi_object_index].text_rect, &(hmi_screen_rect));  } #ifdef HMI_GRAPHIC_RGL hmi_driver_create_rgl_window((&(hmi_screen_rect)),depth); #endif  } else #endif { } } else #endif  #if HMI_DYN_CONTAINERS_NUMBER > 0 if(HMI_IS_DYN_CONTAINER(hmi_object_id)) {  #if HMI_ALL_STATIC_CONTAINERS_NUMBER > 0  hmi_object_id = HMI_GET_DYN_CONTAINERS_ID_INDEX(hmi_object_id); hmi_engine_get_static_container_id(&hmi_object_id);/*get static container ID*/  #if HMI_DXY_CONTAINERS_NUMBER>0U if(HMI_IS_DYN_XY_CONTAINER(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_XY_CONTAINER_INDEX(hmi_object_id ); if(hmi_object_id< HMI_DXY_CONTAINERS_NUMBER) { hmi_get_object_screen_coor((HMI_RECT_STR CONST *)pfarther_rect, &hmi_dyn_xy_container_rect[hmi_object_id], &(hmi_screen_rect));  } #ifdef HMI_GRAPHIC_RGL hmi_driver_create_rgl_window((&(hmi_screen_rect)),depth); #endif } else #endif { } #if HMI_SXY_CONTAINERS_NUMBER>0 if(HMI_IS_CONTAINERS_SXY(hmi_object_id)) { hmi_object_id = HMI_GET_CONTAINERS_SXY_ID_INDEX(hmi_object_id ); if(hmi_object_id< HMI_SXY_CONTAINERS_NUMBER) { hmi_get_object_screen_coor((HMI_RECT_STR CONST *)pfarther_rect, &hmi_static_container_rect[hmi_object_id],&(hmi_screen_rect));  }  #ifdef HMI_GRAPHIC_RGL hmi_driver_create_rgl_window((&(hmi_screen_rect)),depth); #endif } else #endif { }  #endif  } else #endif #if HMI_DYN_FILL_PAGES_NUMBER > 0 if(HMI_IS_DYN_NFILL(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_NFILL_INDEX(hmi_object_id ); if(hmi_object_id< HMI_DYN_FILL_PAGES_NUMBER) { hmi_rect_temp.x = hmi_fills_dyn_xy_rect[hmi_object_index].x; hmi_rect_temp.y = hmi_fills_dyn_xy_rect[hmi_object_index].y; hmi_rect_temp.w = hmi_fills_dyn_xy_rect[hmi_object_index].w; hmi_rect_temp.h = hmi_fills_dyn_xy_rect[hmi_object_index].h; HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_rect_temp) ,(&(hmi_screen_rect)));  } #ifdef HMI_GRAPHIC_RGL hmi_driver_create_rgl_window((&(hmi_screen_rect)),depth); #endif  } else #endif #if HMI_DYN_GFILL_NUMBER > 0 if(HMI_IS_DYN_GFILL(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_GFILL_INDEX(hmi_object_id ); if(hmi_object_id < HMI_DYN_GFILL_NUMBER) { hmi_get_object_screen_coor((HMI_RECT_STR CONST *)pfarther_rect, &hmi_gradient_dxy_fill_rect[hmi_object_id],&(hmi_screen_rect));  } #ifdef HMI_GRAPHIC_RGL hmi_driver_create_rgl_window((&(hmi_screen_rect)),depth); #endif } else #endif #if HMI_DXY_CUBE_NUMBER > 0 if(HMI_IS_DYN_CUBE(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_CUBE_INDEX(hmi_object_id ); if(hmi_object_id < HMI_DXY_CUBE_NUMBER) { hmi_get_object_screen_coor((HMI_RECT_STR CONST *)pfarther_rect, &hmi_cubes_dyn_xy_rect[hmi_object_id].cube_rect,&(hmi_screen_rect));  } #ifdef HMI_GRAPHIC_RGL hmi_driver_create_rgl_window((&(hmi_screen_rect)),depth); #endif } else #endif #if HMI_DXY_CONTAINERS_NUMBER > 0U  if(HMI_IS_DYN_XY_CONTAINER(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_XY_CONTAINER_INDEX(hmi_object_id ); if(hmi_object_id < HMI_DXY_CONTAINERS_NUMBER) { hmi_get_object_screen_coor((HMI_RECT_STR CONST *)pfarther_rect, &hmi_dyn_xy_container_rect[hmi_object_id], &(hmi_screen_rect));  } #ifdef HMI_GRAPHIC_RGL hmi_driver_create_rgl_window((&(hmi_screen_rect)),depth); #endif } else #endif #if HMI_DXY_BITMAPS_NUMBER> 0  if(HMI_IS_DYN_XY_BITMAP(hmi_object_id)) {  hmi_object_index = HMI_GET_DYN_XY_BITMAP_INDEX(hmi_object_id ); hmi_rect_temp.x = hmi_bmp_dyn_xy_rect[hmi_object_index].x; hmi_rect_temp.y = hmi_bmp_dyn_xy_rect[hmi_object_index].y; hmi_rect_temp.w = hmi_bmp_dyn_xy_rect[hmi_object_index].w; hmi_rect_temp.h = hmi_bmp_dyn_xy_rect[hmi_object_index].h; HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect,(&hmi_rect_temp), (&(hmi_screen_rect)));  #ifdef HMI_GRAPHIC_RGL hmi_driver_create_rgl_window((&(hmi_screen_rect)),depth); #endif } else #endif #if HMI_STATIC_TEXTS_NUMBER/*uneditable text*/ > 0  if(HMI_IS_STATIC_TEXTS(hmi_object_id))  {  #if HMI_UNEDIT_TEXTS_DYN_XY_NUMBER > 0 if(HMI_IS_UNEDIT_TEXT_DYN_XY(hmi_object_id)/*HMI_UNEDIT_TEXTS_DYN_XY_NUMBER*/) {  hmi_object_index = HMI_GET_DYN_XY_UNEDIT_POS_COLOR_INDEX(hmi_object_id); if(hmi_object_index < HMI_UNEDIT_TEXTS_DYN_XY_NUMBER) { hmi_get_object_screen_coor((HMI_RECT_STR CONST *)pfarther_rect, &hmi_dyn_xy_unedit_text_prop_table[hmi_object_index].text_rect, &(hmi_screen_rect));  }  #ifdef HMI_GRAPHIC_RGL hmi_driver_create_rgl_window((&(hmi_screen_rect)),depth); #endif  } else  #endif { #if HMI_UNEDIT_TEXTS_STATIC_XY_NUMBER > 0  if(HMI_IS_UNEDIT_TEXT_STATIC_XY(hmi_object_id)/*hmi_object_index < HMI_UNEDIT_TEXTS_STATIC_XY_NUMBER*/) { hmi_object_index = HMI_GET_S_XY_UNEDIT_POS_COLOR_INDEX(hmi_object_id); if(hmi_object_index < HMI_UNEDIT_TEXTS_STATIC_XY_NUMBER) { hmi_get_object_screen_coor((HMI_RECT_STR CONST *)pfarther_rect, &hmi_static_xy_unedit_text_prop_table[hmi_object_index].text_rect, &(hmi_screen_rect)); }  #ifdef HMI_GRAPHIC_RGL hmi_driver_create_rgl_window((&(hmi_screen_rect)),depth); #endif } #endif } }  else #endif  /*draw static element*/ #if HMI_STATIC_FILL_PAGES_NUMBER > 0  if(HMI_IS_SXY_FILL_PAGES(hmi_object_id)) { hmi_object_id = HMI_GET_SXY_FILL_PAGES_ID_INDEX(hmi_object_id ); if(hmi_object_id < HMI_STATIC_FILL_PAGES_NUMBER) { hmi_rect_temp.x = hmi_fills_static_xy_rect[hmi_object_index].x; hmi_rect_temp.y = hmi_fills_static_xy_rect[hmi_object_index].y; hmi_rect_temp.w = hmi_fills_static_xy_rect[hmi_object_index].w; hmi_rect_temp.h = hmi_fills_static_xy_rect[hmi_object_index].h; HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_rect_temp), (&(hmi_screen_rect))); } #ifdef HMI_GRAPHIC_RGL hmi_driver_create_rgl_window((&(hmi_screen_rect)),depth); #endif  } else #endif #if HMI_STATIC_GFILL_NUMBER> 0 if(HMI_IS_SXY_GFILL_PAGES(hmi_object_id)) { hmi_object_id = HMI_GET_SXY_GFILL_PAGES_ID_INDEX(hmi_object_id); hmi_get_object_screen_coor((HMI_RECT_STR CONST *)pfarther_rect, &hmi_gradient_sxy_fill_rect[hmi_object_id ],&(hmi_screen_rect)); #ifdef HMI_GRAPHIC_RGL hmi_driver_create_rgl_window((&(hmi_screen_rect)),depth); #endif  } else #endif #if HMI_SXY_CUBE_NUMBER > 0 if(HMI_IS_SXY_CUBE(hmi_object_id)) { hmi_object_id = HMI_GET_SXY_CUBE_ID_INDEX(hmi_object_id ); if(hmi_object_id < HMI_SXY_CUBE_NUMBER) { hmi_get_object_screen_coor((HMI_RECT_STR CONST *)pfarther_rect, &hmi_cubes_static_xy_rect[hmi_object_id].cube_rect,&(hmi_screen_rect));  } #ifdef HMI_GRAPHIC_RGL hmi_driver_create_rgl_window((&(hmi_screen_rect)),depth); #endif } else #endif #if HMI_SXY_BITMAPS_NUMBER> 0 if(HMI_IS_S_XY_BITMAP(hmi_object_id)) {  hmi_object_index = HMI_GET_SXY_BITMAPS_ID_INDEX(hmi_object_id);  if(hmi_object_index < HMI_SXY_BITMAPS_NUMBER) { hmi_rect_temp.x = hmi_bmp_static_xy_rect[hmi_object_index].x; hmi_rect_temp.y = hmi_bmp_static_xy_rect[hmi_object_index].y; hmi_rect_temp.w = hmi_bmp_static_xy_rect[hmi_object_index].w; hmi_rect_temp.h = hmi_bmp_static_xy_rect[hmi_object_index].h; HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_rect_temp), (&(hmi_screen_rect)));  #ifdef HMI_GRAPHIC_RGL hmi_driver_create_rgl_window((&(hmi_screen_rect)),depth); #endif } } else #endif  #if HMI_SXY_CONTAINERS_NUMBER > 0  if(HMI_IS_CONTAINERS_SXY(hmi_object_id)) { #if HMI_SXY_CONTAINERS_NUMBER >0 hmi_object_id = HMI_GET_CONTAINERS_SXY_ID_INDEX(hmi_object_id ); hmi_get_object_screen_coor((HMI_RECT_STR CONST *)pfarther_rect, &hmi_static_container_rect[hmi_object_id], &(hmi_screen_rect)); #ifdef HMI_GRAPHIC_RGL hmi_driver_create_rgl_window((&(hmi_screen_rect)),depth); #endif #endif } else #endif  { ; }  } hmi_number_object--; } } #endif  #if HMI_ALL_DYN_OBJECTS_NUMBER > 0  void hmi_engine_set_object_info(HMI_OBJECT_ID_STR hmi_object_id,HMI_OBJECT_DATA_STR hmi_object_data) { #if ((HMI_DXY_IMAGELIST_NUMBER > 0U) \ ||(HMI_SXY_IMAGELIST_NUMBER > 0U) \ ||(HMI_DXY_SCROLLBAR_NUMBER > 0U) \ ||(HMI_SXY_SCROLLBAR_NUMBER > 0U) \ ||(HMI_DXY_BUTTON_NUMBER > 0U) \ ||(HMI_SXY_BUTTON_NUMBER > 0U)) BYTE value_imglist = 0;/*for btn,imglist*/ BYTE value_index = 0;/*for btn,imglist*/ BYTE value_beg_bits = 0;/*for btn,imglist*/ BYTE value_clr = 0;/*for btn,imglist*/ #endif #if HMI_ALL_DYN_OBJECTS_NUMBER > HMI_PAGES_NUMBER  HMI_OBJECT_ID_STR hmi_dyn_object_offset = 0U;  #endif #if HMI_LAYER_0_HIGHEST_PRIORITY > 1 UINT8 hmi_priority_cnt = 0U; #endif  #ifdef HMI_GRAPHIC_RGL #if ((HMI_DXY_IMAGELIST_NUMBER+HMI_SXY_IMAGELIST_NUMBER+ \ HMI_DXY_SCROLLBAR_NUMBER+HMI_SXY_SCROLLBAR_NUMBER+ \ HMI_DXY_BUTTON_NUMBER+HMI_SXY_BUTTON_NUMBER+ \ HMI_DXY_BITMAPS_NUMBER+HMI_SXY_BITMAPS_NUMBER)>0)  HMI_CONTAINER_STR hmi_container_info = {{0,0}}; HMI_OBJECT_PROP_STR hmi_object_prop = {0}; #endif #endif if(hmi_object_id < HMI_DYN_OBJECT_MAX_ID) { if(HMI_IS_PAGE(hmi_object_id)) { #if HMI_PAGES_NUMBER > 0U hmi_engine_set_page(hmi_object_id,hmi_object_data); #endif } #if HMI_DXY_IMAGELIST_NUMBER > 0U else if(hmi_object_id < HMI_DYN_IMAGELIST_DXY_MAX_ID) { hmi_dyn_object_offset = HMI_GET_DYN_IMAGELIST_DXY_ID_INDEX(hmi_object_id); if(hmi_dyn_object_offset < HMI_DXY_IMAGELIST_NUMBER) { if(hmi_dxy_imagelist_table[hmi_dyn_object_offset].list_len >((UINT8)hmi_object_data)) { #if (HMI_IMGLIST_MAX_STATUS!=0) value_index=(hmi_dyn_object_offset*HMI_IMGLIST_MAX_STATUS_BIT_LEN) >> 3/*/8*/; value_beg_bits=(hmi_dyn_object_offset*HMI_IMGLIST_MAX_STATUS_BIT_LEN)&0x07/*%8*/; value_imglist=hmi_dxy_imagelist_index[value_index]; value_imglist=value_imglist<<(8-(value_beg_bits+HMI_IMGLIST_MAX_STATUS_BIT_LEN)); value_imglist=value_imglist>>(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN); if(value_imglist != (UINT8)hmi_object_data) { value_clr=0xff; value_clr=value_clr<<(8-(value_beg_bits+HMI_IMGLIST_MAX_STATUS_BIT_LEN)); value_clr=value_clr>>(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN); value_clr=value_clr<<value_beg_bits; hmi_dxy_imagelist_index[value_index]&=(BYTE)(~value_clr);/*clear */ hmi_object_data=hmi_object_data<<(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN); hmi_object_data=hmi_object_data&0xff; hmi_object_data=hmi_object_data>>(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN); hmi_object_data=hmi_object_data<<value_beg_bits; hmi_dxy_imagelist_index[value_index]|=hmi_object_data;  HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } #else #error hmi_engine.c: The compiler, imageList length equal zero. #endif } else if((UINT8)hmi_object_data==HMI_IMAGELIST_NEXT) { #if (HMI_IMGLIST_MAX_STATUS!=0) value_index=(hmi_dyn_object_offset*HMI_IMGLIST_MAX_STATUS_BIT_LEN)>>3/*/8*/; value_beg_bits=(hmi_dyn_object_offset*HMI_IMGLIST_MAX_STATUS_BIT_LEN)&0x07/*%8*/; hmi_object_data=hmi_dxy_imagelist_index[value_index]; hmi_object_data=hmi_object_data<<(8-(value_beg_bits+HMI_IMGLIST_MAX_STATUS_BIT_LEN)); hmi_object_data=hmi_object_data&0xff; hmi_object_data=hmi_object_data>>(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN); hmi_object_data++; if(hmi_dxy_imagelist_table[hmi_dyn_object_offset].list_len <= (UINT8)hmi_object_data) { value_clr=0xff; value_clr=value_clr<<(8-(value_beg_bits+HMI_IMGLIST_MAX_STATUS_BIT_LEN)); value_clr=value_clr>>(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN); value_clr=value_clr<<value_beg_bits; hmi_dxy_imagelist_index[value_index] &= (BYTE)(~value_clr); } else { value_clr=0xff; value_clr=value_clr<<(8-(value_beg_bits+HMI_IMGLIST_MAX_STATUS_BIT_LEN)); value_clr=value_clr>>(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN); value_clr=value_clr<<value_beg_bits; hmi_dxy_imagelist_index[value_index]&= (BYTE)(~value_clr);/*clear*/ hmi_object_data=hmi_object_data<<(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN); hmi_object_data=hmi_object_data&0xff; hmi_object_data=hmi_object_data>>(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN); hmi_object_data=hmi_object_data<<value_beg_bits; hmi_dxy_imagelist_index[value_index]|= (UINT8)hmi_object_data; } HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); #else #error hmi_engine.c: The compiler, imageList length equal zero. #endif  } else if((UINT8)hmi_object_data==HMI_IMAGELIST_PRE) { #if (HMI_IMGLIST_MAX_STATUS!=0) value_index=(hmi_dyn_object_offset*HMI_IMGLIST_MAX_STATUS_BIT_LEN)>>3/*/8*/; value_beg_bits=(hmi_dyn_object_offset*HMI_IMGLIST_MAX_STATUS_BIT_LEN)&0x07/*%8*/; hmi_object_data=hmi_dxy_imagelist_index[value_index]; hmi_object_data=hmi_object_data<<(8-(value_beg_bits+HMI_IMGLIST_MAX_STATUS_BIT_LEN)); hmi_object_data=hmi_object_data&0xff; hmi_object_data=hmi_object_data>>(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN); /*clear*/ value_clr=0xff; value_clr=value_clr<<(8-(value_beg_bits+HMI_IMGLIST_MAX_STATUS_BIT_LEN)); value_clr=value_clr>>(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN); value_clr=value_clr<<value_beg_bits; hmi_dxy_imagelist_index[hmi_dyn_object_offset] &= (BYTE)(~value_clr); /*set new value*/ if((UINT8)hmi_object_data==0U ) { hmi_object_data=hmi_dxy_imagelist_table[hmi_dyn_object_offset].list_len-1; hmi_object_data=hmi_object_data<<(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN); hmi_object_data=hmi_object_data&0xff; hmi_object_data=hmi_object_data>>(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN); hmi_object_data=hmi_object_data<<value_beg_bits; hmi_dxy_imagelist_index[value_index] |= hmi_object_data; } else { hmi_object_data--; hmi_object_data=hmi_object_data<<(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN); hmi_object_data=hmi_object_data&0xff; hmi_object_data=hmi_object_data>>(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN); hmi_object_data=hmi_object_data<<value_beg_bits; hmi_dxy_imagelist_index[value_index] |= (UINT8)hmi_object_data; } HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); #else #error hmi_engine.c: The compiler, imageList length equal zero. #endif } #ifdef HMI_GRAPHIC_RGL else if((UINT8)hmi_object_data == HMI_LOAD_IMAGE) { hmi_container_info.container_object_table.object_number = 1; hmi_object_prop.object_id = hmi_object_id; hmi_container_info.container_object_table.p_object_table = (HMI_OBJECT_PROP_STR CONST *)(&hmi_object_prop); call_C_hmi_driver_load_file(&hmi_container_info); } else if((UINT8)hmi_object_data == HMI_REMOVE_IMAGE) { hmi_container_info.container_object_table.object_number = 1; hmi_object_prop.object_id = hmi_object_id; hmi_container_info.container_object_table.p_object_table = (HMI_OBJECT_PROP_STR CONST *)(&hmi_object_prop); call_C_hmi_driver_remove_load_file(&hmi_container_info); } #endif else { } } } #endif #if HMI_SXY_IMAGELIST_NUMBER>0U else if(hmi_object_id<HMI_DYN_IMAGELIST_SXY_MAX_ID) {  hmi_dyn_object_offset=HMI_GET_DYN_IMAGELIST_SXY_ID_INDEX(hmi_object_id); if(hmi_dyn_object_offset<HMI_SXY_IMAGELIST_NUMBER) { #if (HMI_IMGLIST_MAX_STATUS!=0) value_index=(hmi_dyn_object_offset*HMI_IMGLIST_MAX_STATUS_BIT_LEN)>>3/*/8*/; value_beg_bits=(hmi_dyn_object_offset*HMI_IMGLIST_MAX_STATUS_BIT_LEN)&0x07/*%8*/; value_imglist=hmi_sxy_imagelist_index[value_index]; value_imglist=value_imglist<<(8-(value_beg_bits+HMI_IMGLIST_MAX_STATUS_BIT_LEN)); value_imglist=value_imglist>>(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN); if(hmi_sxy_imagelist_table[hmi_dyn_object_offset].list_len >((UINT8)hmi_object_data)) { if(value_imglist != (UINT8)hmi_object_data) { value_clr=0xff; value_clr=value_clr<<(8-(value_beg_bits+HMI_IMGLIST_MAX_STATUS_BIT_LEN)); value_clr=value_clr>>(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN); value_clr=value_clr<<value_beg_bits; hmi_sxy_imagelist_index[value_index]&=(BYTE)(~value_clr);/*clear*/ hmi_object_data=hmi_object_data<<(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN); hmi_object_data=hmi_object_data&0xff; hmi_object_data=hmi_object_data>>(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN); hmi_object_data=hmi_object_data<<value_beg_bits; hmi_sxy_imagelist_index[value_index] |= (UINT8)hmi_object_data; HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } else if((UINT8)hmi_object_data==HMI_IMAGELIST_NEXT) {  hmi_object_data=hmi_sxy_imagelist_index[value_index]; hmi_object_data=hmi_object_data<<(8-(value_beg_bits+HMI_IMGLIST_MAX_STATUS_BIT_LEN)); hmi_object_data=hmi_object_data&0xff; hmi_object_data=hmi_object_data>>(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN); hmi_object_data++; value_clr=0xff; value_clr=value_clr<<(8-(value_beg_bits+HMI_IMGLIST_MAX_STATUS_BIT_LEN)); value_clr=value_clr>>(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN); value_clr=value_clr<<value_beg_bits; hmi_sxy_imagelist_index[value_index]&=(BYTE)(~value_clr);/*clear*/ if(hmi_sxy_imagelist_table[hmi_dyn_object_offset].list_len <= (UINT8)hmi_object_data) { /*hmi_sxy_imagelist_index[hmi_dyn_object_offset] = 0;*/ } else { hmi_object_data=hmi_object_data<<(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN); hmi_object_data=hmi_object_data&0xff; hmi_object_data=hmi_object_data>>(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN); hmi_object_data=hmi_object_data<<value_beg_bits; hmi_sxy_imagelist_index[value_index] |= (UINT8)hmi_object_data; } HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } else if((UINT8)hmi_object_data==HMI_IMAGELIST_PRE) { hmi_object_data=hmi_sxy_imagelist_index[value_index]; hmi_object_data=hmi_object_data<<(8-(value_beg_bits+HMI_IMGLIST_MAX_STATUS_BIT_LEN)); hmi_object_data=hmi_object_data&0xff; hmi_object_data=hmi_object_data>>(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN); value_clr=0xff; value_clr=value_clr<<(8-(value_beg_bits+HMI_IMGLIST_MAX_STATUS_BIT_LEN)); value_clr=value_clr>>(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN); value_clr=value_clr<<value_beg_bits;  hmi_sxy_imagelist_index[value_index]&= (BYTE)(~value_clr);/*clear*/ if((UINT8)hmi_object_data ==0U ) { hmi_object_data=hmi_sxy_imagelist_table[hmi_dyn_object_offset].list_len-1;  } else { hmi_object_data--;  } hmi_object_data=hmi_object_data<<(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN); hmi_object_data=hmi_object_data&0xff; hmi_object_data=hmi_object_data>>(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN); hmi_object_data=hmi_object_data<<value_beg_bits; hmi_sxy_imagelist_index[value_index] |= hmi_object_data; HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } #ifdef HMI_GRAPHIC_RGL else if((UINT8)hmi_object_data == HMI_LOAD_IMAGE) { hmi_container_info.container_object_table.object_number = 1; hmi_object_prop.object_id = hmi_object_id; hmi_container_info.container_object_table.p_object_table = (HMI_OBJECT_PROP_STR CONST *)(&hmi_object_prop); call_C_hmi_driver_load_file(&hmi_container_info); } else if((UINT8)hmi_object_data == HMI_REMOVE_IMAGE) { hmi_container_info.container_object_table.object_number = 1; hmi_object_prop.object_id = hmi_object_id; hmi_container_info.container_object_table.p_object_table = (HMI_OBJECT_PROP_STR CONST *)(&hmi_object_prop); call_C_hmi_driver_remove_load_file(&hmi_container_info); } #endif else { } #else #error hmi_engine.c: The compiler, imageList length equal zero. #endif }  } #endif #if HMI_DXY_SCROLLBAR_NUMBER>0U else if(hmi_object_id<HMI_DYN_SCROLLBAR_DXY_MAX_ID) { hmi_dyn_object_offset = HMI_GET_DYN_SCROLLBAR_DXY_ID_INDEX(hmi_object_id); if(hmi_dyn_object_offset<HMI_DXY_SCROLLBAR_NUMBER) { if((hmi_dxy_scrollbar_table[hmi_dyn_object_offset].min_range<=(HMI_RANGE_STR)hmi_object_data) && (hmi_dxy_scrollbar_table[hmi_dyn_object_offset].max_range>=(HMI_RANGE_STR)hmi_object_data)) {  value_index=(hmi_dyn_object_offset*HMI_SCROLLBAR_MAX_STATUS_BIT_LEN)>>3/*/8*/; value_beg_bits=(hmi_dyn_object_offset*HMI_SCROLLBAR_MAX_STATUS_BIT_LEN)&0x07/*%8*/; value_imglist=hmi_dxy_scrollbar_cur_range[value_index]; value_imglist=value_imglist<<(8-(value_beg_bits+HMI_SCROLLBAR_MAX_STATUS_BIT_LEN)); value_imglist=value_imglist>>(8-HMI_SCROLLBAR_MAX_STATUS_BIT_LEN);  if(value_imglist != (UINT8)hmi_object_data) { value_clr=0xff; value_clr=value_clr<<(8-(value_beg_bits+HMI_SCROLLBAR_MAX_STATUS_BIT_LEN)); value_clr=value_clr>>(8-HMI_SCROLLBAR_MAX_STATUS_BIT_LEN); value_clr=value_clr<<value_beg_bits; hmi_dxy_scrollbar_cur_range[value_index]&=(BYTE)(~value_clr);/*clear*/ hmi_object_data=hmi_object_data<<(8-HMI_SCROLLBAR_MAX_STATUS_BIT_LEN); hmi_object_data=hmi_object_data&0xff; hmi_object_data=hmi_object_data>>(8-HMI_SCROLLBAR_MAX_STATUS_BIT_LEN); hmi_object_data=hmi_object_data<<value_beg_bits; hmi_dxy_scrollbar_cur_range[value_index] |= (UINT8)hmi_object_data; HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } #if 0 if(hmi_dxy_scrollbar_cur_range[hmi_dyn_object_offset] != (HMI_RANGE_STR)hmi_object_data) { hmi_dxy_scrollbar_cur_range[hmi_dyn_object_offset] = (HMI_RANGE_STR)hmi_object_data; HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } #endif } #ifdef HMI_GRAPHIC_RGL else if((UINT8)hmi_object_data == HMI_LOAD_IMAGE) { hmi_container_info.container_object_table.object_number = 1; hmi_object_prop.object_id = hmi_object_id; hmi_container_info.container_object_table.p_object_table = (HMI_OBJECT_PROP_STR CONST *)(&hmi_object_prop); call_C_hmi_driver_load_file(&hmi_container_info); } else if((UINT8)hmi_object_data == HMI_REMOVE_IMAGE) { hmi_container_info.container_object_table.object_number = 1; hmi_object_prop.object_id = hmi_object_id; hmi_container_info.container_object_table.p_object_table = (HMI_OBJECT_PROP_STR CONST *)(&hmi_object_prop); call_C_hmi_driver_remove_load_file(&hmi_container_info); } #endif else {  } } } #endif #if HMI_SXY_SCROLLBAR_NUMBER>0U else if(hmi_object_id<HMI_DYN_SCROLLBAR_SXY_MAX_ID) { hmi_dyn_object_offset = HMI_GET_DYN_SCROLLBAR_SXY_ID_INDEX(hmi_object_id); if(hmi_dyn_object_offset<HMI_SXY_SCROLLBAR_NUMBER) { if((hmi_sxy_scrollbar_table[hmi_dyn_object_offset].min_range<=(HMI_RANGE_STR)hmi_object_data) && (hmi_sxy_scrollbar_table[hmi_dyn_object_offset].max_range>=(HMI_RANGE_STR)hmi_object_data)) {  value_index=(hmi_dyn_object_offset*HMI_SCROLLBAR_MAX_STATUS_BIT_LEN)>>3/*/8*/; value_beg_bits=(hmi_dyn_object_offset*HMI_SCROLLBAR_MAX_STATUS_BIT_LEN)&0x07/*%8*/; value_imglist=hmi_sxy_scrollbar_cur_range[value_index]; value_imglist=value_imglist<<(8-(value_beg_bits+HMI_SCROLLBAR_MAX_STATUS_BIT_LEN)); value_imglist=value_imglist>>(8-HMI_SCROLLBAR_MAX_STATUS_BIT_LEN);  if(value_imglist != (UINT8)hmi_object_data) { value_clr=0xff; value_clr=value_clr<<(8-(value_beg_bits+HMI_SCROLLBAR_MAX_STATUS_BIT_LEN)); value_clr=value_clr>>(8-HMI_SCROLLBAR_MAX_STATUS_BIT_LEN); value_clr=value_clr<<value_beg_bits; hmi_sxy_scrollbar_cur_range[value_index]&=(BYTE)(~value_clr);/*clear*/ hmi_object_data=hmi_object_data<<(8-HMI_SCROLLBAR_MAX_STATUS_BIT_LEN); hmi_object_data=hmi_object_data&0xff; hmi_object_data=hmi_object_data>>(8-HMI_SCROLLBAR_MAX_STATUS_BIT_LEN); hmi_object_data=hmi_object_data<<value_beg_bits; hmi_sxy_scrollbar_cur_range[value_index] |= (UINT8)hmi_object_data; HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } #if 0  if(hmi_sxy_scrollbar_cur_range[hmi_dyn_object_offset] != (HMI_RANGE_STR)hmi_object_data) { hmi_sxy_scrollbar_cur_range[hmi_dyn_object_offset] = (HMI_RANGE_STR)hmi_object_data; HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } #endif } #ifdef HMI_GRAPHIC_RGL else if((UINT8)hmi_object_data == HMI_LOAD_IMAGE) { hmi_container_info.container_object_table.object_number = 1; hmi_object_prop.object_id = hmi_object_id; hmi_container_info.container_object_table.p_object_table = (HMI_OBJECT_PROP_STR CONST *)(&hmi_object_prop); call_C_hmi_driver_load_file(&hmi_container_info); } else if((UINT8)hmi_object_data == HMI_REMOVE_IMAGE) { hmi_container_info.container_object_table.object_number = 1; hmi_object_prop.object_id = hmi_object_id; hmi_container_info.container_object_table.p_object_table = (HMI_OBJECT_PROP_STR CONST *)(&hmi_object_prop); call_C_hmi_driver_remove_load_file(&hmi_container_info); } #endif else {  } } } #endif #if HMI_DXY_BUTTON_NUMBER>0U else if(hmi_object_id<HMI_DYN_BUTTON_DXY_MAX_ID) { hmi_dyn_object_offset = HMI_GET_DYN_BUTTON_DXY_ID_INDEX(hmi_object_id); if(hmi_dyn_object_offset<HMI_DXY_BUTTON_NUMBER) { if(hmi_dxy_button_table[hmi_dyn_object_offset].button_image.list_len>(UINT8)(hmi_object_data)) { #if (HMI_BTN_MAX_STATUS!=0) value_index=(hmi_dyn_object_offset*HMI_BTN_MAX_STATUS_BIT_LEN)>>3/*/8*/; value_beg_bits=(hmi_dyn_object_offset*HMI_BTN_MAX_STATUS_BIT_LEN)&0x07/*%8*/; value_imglist=hmi_dxy_button_press_status[value_index]; value_imglist=value_imglist<<(8-(value_beg_bits+HMI_BTN_MAX_STATUS_BIT_LEN)); value_imglist=value_imglist>>(8-HMI_BTN_MAX_STATUS_BIT_LEN); if(value_imglist!=(UINT8)(hmi_object_data)) {  /*if((value_imglist!=HMI_BUTTON_HIGHTLIGHT_INDEX)&& (value_imglist!=HMI_BUTTON_DISABLE_INDEX))*/ { /*clear*/ value_clr=0xff; value_clr=value_clr<<(8-(value_beg_bits+HMI_BTN_MAX_STATUS_BIT_LEN)); value_clr=value_clr>>(8-HMI_BTN_MAX_STATUS_BIT_LEN); value_clr=value_clr<<value_beg_bits; hmi_dxy_button_press_status[value_index] &= (BYTE)(~value_clr);  hmi_object_data=hmi_object_data<<(8-HMI_BTN_MAX_STATUS_BIT_LEN); hmi_object_data=hmi_object_data&0xff; hmi_object_data=hmi_object_data>>(8-HMI_BTN_MAX_STATUS_BIT_LEN); hmi_object_data=hmi_object_data<<value_beg_bits; hmi_dxy_button_press_status[value_index]|=(UINT8)(hmi_object_data); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } #else #error hmi_engine.c: The compiler, imageList length equal zero. #endif } #ifdef HMI_GRAPHIC_RGL else if((UINT8)hmi_object_data == HMI_LOAD_IMAGE) { hmi_container_info.container_object_table.object_number = 1; hmi_object_prop.object_id = hmi_object_id; hmi_container_info.container_object_table.p_object_table = (HMI_OBJECT_PROP_STR CONST *)(&hmi_object_prop); call_C_hmi_driver_load_file(&hmi_container_info); } else if((UINT8)hmi_object_data == HMI_REMOVE_IMAGE) { hmi_container_info.container_object_table.object_number = 1; hmi_object_prop.object_id = hmi_object_id; hmi_container_info.container_object_table.p_object_table = (HMI_OBJECT_PROP_STR CONST *)(&hmi_object_prop); call_C_hmi_driver_remove_load_file(&hmi_container_info); } #endif else {  } } } #endif #if HMI_SXY_BUTTON_NUMBER>0U else if(hmi_object_id<HMI_DYN_BUTTON_SXY_MAX_ID) { hmi_dyn_object_offset = HMI_GET_DYN_BUTTON_SXY_ID_INDEX(hmi_object_id); if(hmi_dyn_object_offset<HMI_SXY_BUTTON_NUMBER) { if(hmi_sxy_button_table[hmi_dyn_object_offset].button_image.list_len>(UINT8)(hmi_object_data)) { #if (HMI_BTN_MAX_STATUS!=0) value_index=(hmi_dyn_object_offset*HMI_BTN_MAX_STATUS_BIT_LEN)>>3/*/8*/; value_beg_bits=(hmi_dyn_object_offset*HMI_BTN_MAX_STATUS_BIT_LEN)&0x07/*%8*/; value_imglist=hmi_sxy_button_press_status[value_index]; value_imglist=value_imglist<<(8-(value_beg_bits+HMI_BTN_MAX_STATUS_BIT_LEN)); value_imglist=value_imglist>>(8-HMI_BTN_MAX_STATUS_BIT_LEN); if(value_imglist!=(UINT8)(hmi_object_data)) { /*if((value_imglist!=HMI_BUTTON_HIGHTLIGHT_INDEX)&& (value_imglist!=HMI_BUTTON_DISABLE_INDEX))*/ { /*clear*/ value_clr=0xff; value_clr=value_clr<<(8-(value_beg_bits+HMI_BTN_MAX_STATUS_BIT_LEN)); value_clr=value_clr>>(8-HMI_BTN_MAX_STATUS_BIT_LEN); value_clr=value_clr<<value_beg_bits; hmi_sxy_button_press_status[value_index] &= (BYTE)(~value_clr);  hmi_object_data=hmi_object_data<<(8-HMI_BTN_MAX_STATUS_BIT_LEN); hmi_object_data=hmi_object_data&0xff; hmi_object_data=hmi_object_data>>(8-HMI_BTN_MAX_STATUS_BIT_LEN); hmi_object_data=hmi_object_data<<value_beg_bits; hmi_sxy_button_press_status[value_index]|=(UINT8)(hmi_object_data); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } #else #error hmi_engine.c: The compiler, imageList length equal zero. #endif } #ifdef HMI_GRAPHIC_RGL else if((UINT8)hmi_object_data == HMI_LOAD_IMAGE) { hmi_container_info.container_object_table.object_number = 1; hmi_object_prop.object_id = hmi_object_id; hmi_container_info.container_object_table.p_object_table = (HMI_OBJECT_PROP_STR CONST *)(&hmi_object_prop); call_C_hmi_driver_load_file(&hmi_container_info); } else if((UINT8)hmi_object_data == HMI_REMOVE_IMAGE) { hmi_container_info.container_object_table.object_number = 1; hmi_object_prop.object_id = hmi_object_id; hmi_container_info.container_object_table.p_object_table = (HMI_OBJECT_PROP_STR CONST *)(&hmi_object_prop); call_C_hmi_driver_remove_load_file(&hmi_container_info); } #endif else {  } } } #endif #if HMI_DYN_EDIT_TEXTS_NUMBER > 0U else if(hmi_object_id< HMI_DYN_TEXTS_MAX_ID) { hmi_dyn_object_offset = HMI_GET_DYN_TEXTS_INDEX(hmi_object_id); if(hmi_dyn_object_offset<HMI_DYN_EDIT_TEXTS_NUMBER) { if(hmi_object_data == (HMI_OBJECT_DATA_STR)HMI_CLEAR_TXT)/*clear text*/ { if((*(HMI_CHAR_STR*)(hmi_edit_text_table[hmi_dyn_object_offset].hmi_string))!= 0) { (*(HMI_CHAR_STR*)(hmi_edit_text_table[hmi_dyn_object_offset].hmi_string)) = 0; HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } else if(hmi_object_data == (HMI_OBJECT_DATA_STR)HMI_REFRESH_TXT)/*refresh text again*/ { HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } else /*set dyn font for editable text*/ { #if HMI_EDIT_TEXT_DXY_DYN_FONT_NUM > 0 if(HMI_IS_DYN_TEXT_DXY_DYN_FONT(hmi_object_id)) { hmi_dyn_object_offset = HMI_GET_DYN_TEXTS_DXY_DYN_FONT_POS_INDEX(hmi_object_id); if(hmi_dyn_object_offset < HMI_EDIT_TEXT_DXY_DYN_FONT_NUM) { if(hmi_edit_text_dxy_dyn_font_table[hmi_dyn_object_offset]!=(U08)hmi_object_data) { hmi_edit_text_dxy_dyn_font_table[hmi_dyn_object_offset]=(U08)hmi_object_data; HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } #endif #if HMI_EDIT_TEXT_SXY_DYN_FONT_NUM > 0 if(HMI_IS_DYN_TEXT_SXY_DYN_FONT(hmi_object_id)) { hmi_dyn_object_offset = HMI_GET_DYN_TEXTS_SXY_DYN_FONT_POS_INDEX(hmi_object_id); if(hmi_dyn_object_offset < HMI_EDIT_TEXT_SXY_DYN_FONT_NUM) { if(hmi_edit_text_sxy_dyn_font_table[hmi_dyn_object_offset]!=(U08)hmi_object_data) { hmi_edit_text_sxy_dyn_font_table[hmi_dyn_object_offset]=(U08)hmi_object_data; HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } #endif } } } #endif #if HMI_DYN_CONTAINERS_NUMBER > 0 else if(hmi_object_id < HMI_DYN_CONTAINERS_MAX_ID) { hmi_dyn_object_offset = HMI_GET_DYN_CONTAINERS_ID_INDEX(hmi_object_id); if(hmi_dyn_object_offset<HMI_DYN_CONTAINERS_NUMBER) { if(hmi_dyn_container_table[hmi_dyn_object_offset] != hmi_object_data) { hmi_dyn_container_table[hmi_dyn_object_offset] = (HMI_DYN_CONTAINER_DATA_STR)hmi_object_data; HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } #endif #if HMI_DYN_FILL_PAGES_NUMBER > 0U else if(hmi_object_id < HMI_DYN_NFILL_MAX_ID) { HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } #endif #if HMI_DYN_GFILL_NUMBER > 0U else if(hmi_object_id < HMI_DYN_GFILL_MAX_ID) { hmi_dyn_object_offset=HMI_GET_DYN_GFILL_INDEX(hmi_object_id); if(hmi_dyn_object_offset<HMI_DYN_GFILL_NUMBER) { if((UINT8)(hmi_object_data) != hmi_gradient_dxy_fill_table[hmi_dyn_object_offset].fill_type) { hmi_gradient_dxy_fill_table[hmi_dyn_object_offset].fill_type=(UINT8)(hmi_object_data);  HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } #endif #if HMI_DXY_CUBE_NUMBER > 0U else if(hmi_object_id < HMI_DYN_CUBE_MAX_ID) { HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } #endif #if HMI_DYN_LANGUAGE_NUMBER>0U else if(hmi_object_id < HMI_DYN_LANGUAGE_MAX_ID) {  hmi_dyn_object_offset=(HMI_OBJECT_ID_STR)HMI_GET_NB_LANGUAGE_ID_INDEX(hmi_object_data); if(hmi_dyn_object_offset <HMI_LANGUAGE_NUMBER) { if((HMI_OBJECT_ID_STR)hmi_object_data !=hmi_cur_language) { hmi_cur_language=(HMI_OBJECT_ID_STR)(hmi_object_data); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } #endif #if HMI_DXY_CONTAINERS_NUMBER>0U else if(hmi_object_id < HMI_DYN_XY_CONTAINER_MAX_ID) {  #ifdef HMI_GRAPHIC_RGL /*2016.9.6 .support RGL video capture*/ hmi_dyn_object_offset = HMI_GET_DYN_XY_CONTAINER_INDEX(hmi_object_id); if(hmi_object_data == HMI_VIDEO_CAPTURE_EN)  {  if(!(hmi_dxy_container_video_status[hmi_dyn_object_offset]&HMI_VIDEO_ENABLE_STATUS)) { hmi_dxy_container_video_status[hmi_dyn_object_offset] |= HMI_VIDEO_ENABLE_STATUS; HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); /*set video enable flag*/ hmi_dxy_container_video_status[hmi_dyn_object_offset] |= HMI_VIDEO_ENABLE_FLAG;  } } else if(hmi_object_data == HMI_VIDEO_CAPTURE_DIS) { if(hmi_dxy_container_video_status[hmi_dyn_object_offset]&HMI_VIDEO_ENABLE_STATUS) { hmi_dxy_container_video_status[hmi_dyn_object_offset] &= ((BYTE)(~HMI_VIDEO_ENABLE_STATUS)); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); /*set video enable flag*/ hmi_dxy_container_video_status[hmi_dyn_object_offset] |= HMI_VIDEO_ENABLE_FLAG;  } } else if(hmi_object_data == HMI_VIDEO_CAPTURE_DESTORY) { if(hmi_dxy_container_video_status[hmi_dyn_object_offset]&HMI_VIDEO_CREATE_STATUS) { hmi_dxy_container_video_status[hmi_dyn_object_offset] &= ((BYTE)(~HMI_VIDEO_CREATE_STATUS)); HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); /*set video create flag*/ hmi_dxy_container_video_status[hmi_dyn_object_offset] |= HMI_VIDEO_CREATE_FLAG; } } else if(hmi_object_data == HMI_VIDEO_CAPTURE_INIT) { if(!(hmi_dxy_container_video_status[hmi_dyn_object_offset]&HMI_VIDEO_CREATE_STATUS)) { hmi_dxy_container_video_status[hmi_dyn_object_offset] |= HMI_VIDEO_CREATE_STATUS; HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); /*set video create flag*/ hmi_dxy_container_video_status[hmi_dyn_object_offset] |= HMI_VIDEO_CREATE_FLAG; } } else { } #endif  } #endif #if HMI_DXY_BITMAPS_NUMBER> 0U else if(hmi_object_id < HMI_DYN_XY_BITMAP_MAX_ID) { #ifdef HMI_GRAPHIC_RGL if((UINT8)hmi_object_data == HMI_LOAD_IMAGE) { hmi_container_info.container_object_table.object_number = 1; hmi_object_prop.object_id = hmi_object_id; hmi_container_info.container_object_table.p_object_table = (HMI_OBJECT_PROP_STR CONST *)(&hmi_object_prop); call_C_hmi_driver_load_file(&hmi_container_info); } else if((UINT8)hmi_object_data == HMI_REMOVE_IMAGE) { hmi_container_info.container_object_table.object_number = 1; hmi_object_prop.object_id = hmi_object_id; hmi_container_info.container_object_table.p_object_table = (HMI_OBJECT_PROP_STR CONST *)(&hmi_object_prop); call_C_hmi_driver_remove_load_file(&hmi_container_info); }  else #endif { HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } #endif /*set uneditable dxy text dyn font*/ #if HMI_UNEDIT_TEXT_DXY_DYN_FONT_NUM > 0 if(HMI_IS_UNEDIT_TEXT_DYN_XY_DYN_FONT(hmi_object_id)) { hmi_dyn_object_offset = HMI_GET_DYN_XY_UNEDIT_DYN_FONT_INDEX(hmi_object_id); if(hmi_dyn_object_offset < HMI_UNEDIT_TEXT_DXY_DYN_FONT_NUM) { if(hmi_unedit_text_dxy_dyn_font_table[hmi_dyn_object_offset]!=(U08)hmi_object_data) { hmi_unedit_text_dxy_dyn_font_table[hmi_dyn_object_offset]=(U08)hmi_object_data; HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } #endif /*set uneditable sxy text dyn font*/ #if HMI_UNEDIT_TEXT_SXY_DYN_FONT_NUM > 0 if(HMI_IS_UNEDIT_TEXT_STATIC_XY_DYN_FONT(hmi_object_id)) { hmi_dyn_object_offset = HMI_GET_S_XY_UNEDIT_DYN_FONT_INDEX(hmi_object_id); if(hmi_dyn_object_offset < HMI_UNEDIT_TEXT_SXY_DYN_FONT_NUM) { if(hmi_unedit_text_sxy_dyn_font_table[hmi_dyn_object_offset]!=(U08)hmi_object_data) { hmi_unedit_text_sxy_dyn_font_table[hmi_dyn_object_offset]=(U08)hmi_object_data; HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } #endif #if HMI_SEGMENT_MAX>0 if(HMI_IS_SEGMENT(hmi_object_id)) {  #if HMI_LOAD_SOURCE_MODE == HMI_LOAD_RES_SEGMEN hmi_dyn_object_offset = HMI_GET_SEGMENT_INDEX(hmi_object_id); if(hmi_dyn_object_offset < HMI_SEGMENT_MAX) { if(HMI_LOAD_IMAGE==(U08)hmi_object_data) { call_C_hmi_driver_load_file(&hmi_seg_info_list[hmi_dyn_object_offset]); } else if(HMI_REMOVE_IMAGE==(U08)hmi_object_data) { call_C_hmi_driver_remove_load_file(&hmi_seg_info_list[hmi_dyn_object_offset]); } else { } } #endif } #endif /*Set element x,y,w,h,color,alpha,angel*/ #if HMI_DXY_CONTAINERS_NUMBER > 0 else if(HMI_IS_DYN_XY_CONTAINER_PROPERTY(hmi_object_id)) { hmi_engine_set_dxy_container(hmi_object_id,hmi_object_data); } #endif #if HMI_DXY_BITMAPS_NUMBER > 0U else if(HMI_IS_DYN_XY_BITMAP_PROPERTY(hmi_object_id)) { hmi_engine_set_dxy_bitmaps(hmi_object_id,hmi_object_data); } #endif #if HMI_DXY_PAGES_NUMBER>0U else if(HMI_IS_DYN_XY_PAGE_PROPERTY(hmi_object_id)) { hmi_engine_set_dyn_pages(hmi_object_id,hmi_object_data); } #endif #if HMI_DXY_IMAGELIST_NUMBER >0U else if(HMI_IS_DYN_XY_IMGLIST_PROPERTY(hmi_object_id)) { hmi_engine_set_dxy_imagelist(hmi_object_id,hmi_object_data); } #endif #if HMI_DXY_SCROLLBAR_NUMBER >0U else if(HMI_IS_DYN_XY_SCROLLBAR_PROPERTY(hmi_object_id)) { #ifndef HMI_GRAPHIC_TWLIB hmi_engine_set_dxy_scrollbar(hmi_object_id,hmi_object_data); #endif } #endif #if HMI_DXY_BUTTON_NUMBER>0U else if(HMI_IS_DYN_XY_BUTTON_PROPERTY(hmi_object_id)) { hmi_engine_set_dxy_button(hmi_object_id,hmi_object_data); } #endif #if HMI_UNEDIT_TEXTS_DYN_XY_NUMBER > 0U else if(HMI_IS_DYN_XY_STEXT_PROPERTY(hmi_object_id)) { hmi_engine_set_dxy_unedit_texts(hmi_object_id,hmi_object_data); } #endif #if HMI_DYN_XY_EDIT_TEXTS_NUMBER > 0U else if(HMI_IS_DYN_XY_DTEXT_PROPERTY(hmi_object_id)) { hmi_engine_set_dxy_edit_texts(hmi_object_id,hmi_object_data); } #endif #if HMI_DYN_FILL_PAGES_NUMBER > 0U else if(HMI_IS_DYN_XY_FILL_PROPERTY(hmi_object_id)) { hmi_engine_set_dyn_fill_pages(hmi_object_id,hmi_object_data); } #endif #if HMI_DYN_GFILL_NUMBER > 0U else if(HMI_IS_DYN_XY_GFILL_PROPERTY(hmi_object_id)) { #ifndef HMI_GRAPHIC_TWLIB hmi_engine_set_dyn_gfill_pages(hmi_object_id,hmi_object_data); #endif } #endif #if HMI_DXY_CUBE_NUMBER > 0U else if(HMI_IS_DYN_XY_CUBE_PROPERTY(hmi_object_id)) { hmi_engine_set_dyn_cube(hmi_object_id,hmi_object_data); } #endif #if HMI_ALL_DYN_OBJECTS_NUMBER > HMI_PAGES_NUMBER else { } #endif } #if ((HMI_SCROLL_TEXT_SUPPORT != 0U)&&(HMI_DYN_EDIT_TEXTS_NUMBER > 0U)) else if(HMI_IS_EDITSCROLL_PROPERTY(hmi_object_id)) {  #ifndef HMI_GRAPHIC_TWLIB hmi_engine_set_text_scroll_step(hmi_object_id,hmi_object_data);  #endif } #endif #if HMI_SXY_BITMAPS_NUMBER>0 else if(HMI_IS_S_XY_BITMAP(hmi_object_id)) { #ifdef HMI_GRAPHIC_RGL if((UINT8)hmi_object_data == HMI_LOAD_IMAGE) { hmi_container_info.container_object_table.object_number = 1; hmi_object_prop.object_id = hmi_object_id; hmi_container_info.container_object_table.p_object_table = (HMI_OBJECT_PROP_STR CONST *)(&hmi_object_prop); call_C_hmi_driver_load_file(&hmi_container_info); } else if((UINT8)hmi_object_data == HMI_REMOVE_IMAGE) { hmi_container_info.container_object_table.object_number = 1; hmi_object_prop.object_id = hmi_object_id; hmi_container_info.container_object_table.p_object_table = (HMI_OBJECT_PROP_STR CONST *)(&hmi_object_prop); call_C_hmi_driver_remove_load_file(&hmi_container_info); }  else { } #endif } #endif #if HMI_ALL_EVENT_NUMBER>0 else if(IS_EVENT(hmi_object_id)) { if(hmi_object_data==HMI_SEND_EVENT_ON) { hmi_action_send_event(hmi_object_id); } else { } } #endif #if HMI_ACTION_GROUP_NUMBER>0 else if(IS_GROUP(hmi_object_id)) { if((hmi_object_data==HMI_ACTION_RUN)|| (hmi_object_data==HMI_ACTION_CONTINUE)|| (hmi_object_data==HMI_ACTION_PAUSE)) { hmi_set_action_status(hmi_object_id,hmi_object_data); } else { } } #endif /*Set dyn timer elapse*/  #if 0/*HMI_DYN_TIMER_ACTION_DURATION_NUMBER>0*/ else if(HMI_IS_TIMER_ACTION_D_DURATION_NO_OFFSET(hmi_object_id)) { hmi_object_id=HMI_GET_ACTION_ID_INDEX(hmi_object_id);/*Get action begin offset*/ hmi_object_id=HMI_GET_TIMER_ACTION_D_DURATION_ID_INDEX(hmi_object_id); hmi_set_timer_s_e(hmi_object_id,hmi_object_data,HMI_SET_ELAPSE); } #endif /*Set dyn timer start and duration*/ #if HMI_DYN_TIMER_ACTION_DURATION_NUMBER>0 else if(HMI_IS_DYN_TIMER_S_E(hmi_object_id)/*HMI_IS_DYN_TIMER_S_E_NO_OFFSET(hmi_object_id)*/) {  if(HMI_IS_DYN_TIMER_START(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_TIMER_S_INDEX(hmi_object_id); hmi_set_timer_s_e(hmi_object_id,hmi_object_data,HMI_SET_START); } else /*dyn timer end*/ { hmi_object_id=HMI_GET_DYN_TIMER_E_INDEX(hmi_object_id); hmi_set_timer_s_e(hmi_object_id,hmi_object_data,HMI_SET_DURATION); }  }  #endif /*Set dyn pos start and end*/ #if HMI_ANIM_DYN_SET_POS_NUMBER>0 else if(HMI_IS_DYN_POS_S_E(hmi_object_id)) { if(HMI_IS_DYN_POS_START(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_POS_START(hmi_object_id); hmi_set_dyn_pos_s_e(hmi_object_id,hmi_object_data,TRUE); } else /*end*/ { hmi_object_id=HMI_GET_DYN_POS_END(hmi_object_id); hmi_set_dyn_pos_s_e(hmi_object_id,hmi_object_data,FALSE); } } #endif /*Set dyn width heigh start and end*/ #if HMI_ANIM_DYN_SET_W_H_NUMBER>0 else if(HMI_IS_DYN_WH_S_E(hmi_object_id)) { if(HMI_IS_DYN_WH_START(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_WH_START(hmi_object_id); hmi_set_dyn_wh_s_e(hmi_object_id,hmi_object_data,TRUE); } else /*end*/ { hmi_object_id=HMI_GET_DYN_WH_END(hmi_object_id); hmi_set_dyn_wh_s_e(hmi_object_id,hmi_object_data,FALSE); } } #endif /*Set dyn fcolor start and end*/ #if HMI_ANIM_DYN_SET_FOR_COLOR_NUMBER>0 else if(HMI_IS_DYN_FCOLOR_S_E(hmi_object_id)) { if(HMI_IS_DYN_FCOLOR_START(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_FCOLOR_START(hmi_object_id); hmi_set_dyn_fcolor_s_e(hmi_object_id,hmi_object_data,TRUE); } else /*end*/ { hmi_object_id=HMI_GET_DYN_FCOLOR_END(hmi_object_id); hmi_set_dyn_fcolor_s_e(hmi_object_id,hmi_object_data,FALSE); } } #endif /*Set dyn image list start and end*/ #if HMI_ANIM_DYN_SET_IMAGELIST_INDEX_NUMBER>0 else if(HMI_IS_DYN_IMGLST_S_E(hmi_object_id)) { if(HMI_IS_DYN_IMGLST_START(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_IMGLST_START(hmi_object_id); hmi_set_dyn_imglist_s_e(hmi_object_id,hmi_object_data,TRUE); } else /*end*/ { hmi_object_id=HMI_GET_DYN_IMGLST_END(hmi_object_id); hmi_set_dyn_imglist_s_e(hmi_object_id,hmi_object_data,FALSE); } } #endif /*Set dyn alpha start and end*/ #if HMI_ANIM_DYN_SET_ALPHA_NUMBER>0 else if(HMI_IS_DYN_ALPHA_S_E(hmi_object_id)) { if(HMI_IS_DYN_ALPHA_START(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_ALPHA_START(hmi_object_id); hmi_set_dyn_alpha_s_e(hmi_object_id,hmi_object_data,TRUE); } else /*end*/ { hmi_object_id=HMI_GET_DYN_ALPHA_END(hmi_object_id); hmi_set_dyn_alpha_s_e(hmi_object_id,hmi_object_data,FALSE); } } #endif /*Set dyn angel start and end*/ #if HMI_ANIM_DYN_SET_ANGEL_NUMBER>0 else if(HMI_IS_DYN_ANGEL_S_E(hmi_object_id)) { #ifndef HMI_GRAPHIC_TWLIB #ifndef HMI_GRAPHIC_ST7513 if(HMI_IS_DYN_ANGEL_START(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_ANGEL_START(hmi_object_id); hmi_set_dyn_angel_s_e(hmi_object_id,hmi_object_data,TRUE); } else /*end*/ { hmi_object_id=HMI_GET_DYN_ANGEL_END(hmi_object_id); hmi_set_dyn_angel_s_e(hmi_object_id,hmi_object_data,FALSE); } #endif #endif } #endif else { } } #endif  #if HMI_DYN_EDIT_TEXTS_NUMBER > 0 void hmi_engine_edit_text(HMI_OBJECT_ID_STR hmi_object_id,HMI_CHAR_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_dst_string) { HMI_OBJECT_ID_STR hmi_dyn_object_offset=0U; HMI_CHAR_STR hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_src_string=NULL; HMI_TEXT_LENGTH_STR hmi_src_string_length=0U; UINT8 hmi_string_changed_flag=FALSE;  if(HMI_IS_DYN_TEXTS(hmi_object_id)) { if(phmi_dst_string !=NULL) { hmi_dyn_object_offset = HMI_GET_DYN_TEXTS_INDEX(hmi_object_id); phmi_src_string = (HMI_CHAR_STR *)hmi_edit_text_table[hmi_dyn_object_offset].hmi_string/*.p_dyn_data*/; hmi_src_string_length = hmi_edit_text_table[hmi_dyn_object_offset].length; hmi_string_changed_flag = FALSE; while((hmi_src_string_length != 0) && (*phmi_dst_string != 0)) { if(*phmi_dst_string != *phmi_src_string) { *phmi_src_string = *phmi_dst_string; hmi_string_changed_flag =TRUE; } phmi_src_string++; phmi_dst_string++; hmi_src_string_length--; } if(*phmi_src_string != 0U) { *phmi_src_string = 0U; hmi_string_changed_flag = TRUE; } if( hmi_string_changed_flag) { HMI_DYNAMIC_OBJECT_SET_CHANGED_FLAG(hmi_object_id); HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } } } } #endif   #if HMI_ALL_DYN_OBJECTS_NUMBER > HMI_PAGES_NUMBER #if HMI_GET_INFO_FUNC==YES BOOLEAN hmi_engine_get_object_info(HMI_OBJECT_ID_STR hmi_object_id,HMI_OBJECT_DATA_STR hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_object_data) { BOOLEAN hmi_get_status = FALSE; #if ((HMI_DYN_TIMER_ACTION_DURATION_NUMBER > 0) \ || (HMI_ANIM_DYN_SET_ANGEL_NUMBER > 0)) HMI_TIME time_angel = 0; #endif #if ((HMI_DXY_IMAGELIST_NUMBER+HMI_SXY_IMAGELIST_NUMBER+ \ HMI_DXY_SCROLLBAR_NUMBER+HMI_SXY_SCROLLBAR_NUMBER+ \ HMI_DXY_BUTTON_NUMBER+HMI_SXY_BUTTON_NUMBER) > 0U) BYTE value_imglist = 0;/*for btn,imglist*/ BYTE value_index = 0;/*for btn,imglist*/ BYTE value_beg_bits = 0;/*for btn,imglist*/ #endif HMI_CHAR_STR hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_string = 0U; U08 font_id = HMI_INVALIATE_FONT_ID; HMI_OBJECT_ID_STR hmi_object_index = 0; if(hmi_object_id < HMI_DYN_OBJECT_MAX_ID)  { if(hmi_object_id < HMI_PAGE_SXY_MAX_ID) { } #if HMI_DXY_IMAGELIST_NUMBER>0 else if(HMI_IS_DYN_IMAGELIST_DXY(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_IMAGELIST_DXY_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_IMAGELIST_NUMBER) {  value_index=(hmi_object_id*HMI_IMGLIST_MAX_STATUS_BIT_LEN)/8; value_beg_bits=(hmi_object_id*HMI_IMGLIST_MAX_STATUS_BIT_LEN)%8; value_imglist=hmi_dxy_imagelist_index[value_index]; value_imglist=value_imglist<<(8-(value_beg_bits+HMI_IMGLIST_MAX_STATUS_BIT_LEN)); value_imglist=value_imglist>>(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN);  *phmi_object_data = value_imglist; hmi_get_status = TRUE; } } #endif #if HMI_SXY_IMAGELIST_NUMBER>0 else if(HMI_IS_DYN_IMAGELIST_SXY(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_IMAGELIST_SXY_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_SXY_IMAGELIST_NUMBER) { value_index=(hmi_object_id*HMI_IMGLIST_MAX_STATUS_BIT_LEN)/8; value_beg_bits=(hmi_object_id*HMI_IMGLIST_MAX_STATUS_BIT_LEN)%8; value_imglist=hmi_sxy_imagelist_index[value_index]; value_imglist=value_imglist<<(8-(value_beg_bits+HMI_IMGLIST_MAX_STATUS_BIT_LEN)); value_imglist=value_imglist>>(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN); *phmi_object_data = value_imglist; hmi_get_status = TRUE; } } #endif #if HMI_DXY_SCROLLBAR_NUMBER>0 else if(HMI_IS_DYN_SCROLLBAR_DXY(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_SCROLLBAR_DXY_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_SCROLLBAR_NUMBER) { *phmi_object_data = hmi_dxy_scrollbar_cur_range[hmi_object_id]; hmi_get_status = TRUE; } } #endif #if HMI_SXY_SCROLLBAR_NUMBER>0 else if(HMI_IS_DYN_SCROLLBAR_SXY(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_SCROLLBAR_SXY_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_SXY_SCROLLBAR_NUMBER) { *phmi_object_data = hmi_sxy_scrollbar_cur_range[hmi_object_id]; hmi_get_status = TRUE; } } #endif #if HMI_DXY_BUTTON_NUMBER>0 else if(HMI_IS_DYN_BUTTON_DXY(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_BUTTON_DXY_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_BUTTON_NUMBER) { value_index=(hmi_object_id*HMI_BTN_MAX_STATUS_BIT_LEN)>>3/*/8*/; value_beg_bits=(hmi_object_id*HMI_BTN_MAX_STATUS_BIT_LEN)&0x07/*%8*/; value_imglist=hmi_dxy_button_press_status[value_index]; value_imglist=value_imglist<<(8-(value_beg_bits+HMI_BTN_MAX_STATUS_BIT_LEN)); value_imglist=value_imglist>>(8-HMI_BTN_MAX_STATUS_BIT_LEN); *phmi_object_data = value_imglist; hmi_get_status = TRUE; } } #endif #if HMI_SXY_BUTTON_NUMBER>0 else if(HMI_IS_DYN_BUTTON_SXY(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_BUTTON_SXY_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_SXY_BUTTON_NUMBER) { value_index=(hmi_object_id*HMI_BTN_MAX_STATUS_BIT_LEN)>>3/*/8*/; value_beg_bits=(hmi_object_id*HMI_BTN_MAX_STATUS_BIT_LEN)&0x07/*%8*/; value_imglist=hmi_sxy_button_press_status[value_index]; value_imglist=value_imglist<<(8-(value_beg_bits+HMI_BTN_MAX_STATUS_BIT_LEN)); value_imglist=value_imglist>>(8-HMI_BTN_MAX_STATUS_BIT_LEN); *phmi_object_data = value_imglist; hmi_get_status = TRUE; } } #endif #if HMI_DYN_EDIT_TEXTS_NUMBER > 0 else if(HMI_IS_DYN_TEXTS(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_TEXTS_INDEX(hmi_object_id); if(hmi_object_index < HMI_DYN_EDIT_TEXTS_NUMBER)  { phmi_string = (HMI_CHAR_STR *)hmi_edit_text_table[hmi_object_index].hmi_string; font_id = hmi_edit_text_table[hmi_object_index].font_id; #if HMI_EDIT_TEXT_DXY_DYN_FONT_NUM > 0 if(HMI_IS_DYN_TEXT_DXY_DYN_FONT(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_TEXTS_DXY_DYN_FONT_POS_INDEX(hmi_object_id); if(hmi_object_index < HMI_EDIT_TEXT_DXY_DYN_FONT_NUM) { font_id = hmi_edit_text_dxy_dyn_font_table[hmi_object_index]; } } else #endif #if HMI_EDIT_TEXT_SXY_DYN_FONT_NUM > 0 if(HMI_IS_DYN_TEXT_SXY_DYN_FONT(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_TEXTS_SXY_DYN_FONT_POS_INDEX(hmi_object_id); if(hmi_object_index < HMI_EDIT_TEXT_SXY_DYN_FONT_NUM) { font_id = hmi_edit_text_sxy_dyn_font_table[hmi_object_index]; } } else #endif { }  if((phmi_string != NULL)) { *phmi_object_data = hmi_driver_get_string_len(phmi_string,font_id); hmi_get_status = TRUE; } }  } #endif #if HMI_DYN_CONTAINERS_NUMBER > 0 else if(HMI_IS_DYN_CONTAINER(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_CONTAINERS_ID_INDEX(hmi_object_id); if(hmi_object_id<HMI_DYN_CONTAINERS_NUMBER) { *phmi_object_data = hmi_dyn_container_table[hmi_object_id]; hmi_get_status = TRUE; } } #endif #if HMI_DYN_FILL_PAGES_NUMBER > 0 else if(HMI_IS_DYN_NFILL(hmi_object_id)) { } #endif #if HMI_DYN_GFILL_NUMBER>0 else if(HMI_IS_DYN_GFILL(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_GFILL_INDEX(hmi_object_id); if(hmi_object_id<HMI_DYN_GFILL_NUMBER) { *phmi_object_data = hmi_gradient_dxy_fill_table[hmi_object_id].fill_type; hmi_get_status = TRUE; } } #endif #if HMI_DXY_CUBE_NUMBER>0 else if(HMI_IS_DYN_CUBE(hmi_object_id)) { } #endif #if HMI_DYN_LANGUAGE_NUMBER>0U else if(HMI_IS_DYN_LANGUAGE(hmi_object_id)) { *phmi_object_data=(HMI_OBJECT_DATA_STR)hmi_cur_language; hmi_get_status = TRUE; } #endif #if HMI_DXY_CONTAINERS_NUMBER>0 else if(HMI_IS_DYN_XY_CONTAINER(hmi_object_id)) { /*2016.9.6 support RGL video capture.get video enable/disable*/ #ifdef HMI_GRAPHIC_RGL  hmi_object_id = HMI_GET_DYN_XY_CONTAINER_INDEX(hmi_object_id);  *phmi_object_data = (HMI_OBJECT_DATA_STR)((hmi_dxy_container_video_status[hmi_object_id]& HMI_VIDEO_ENABLE_CREATE_BIT)); hmi_get_status = TRUE; #endif } #endif #if HMI_DXY_BITMAPS_NUMBER > 0 else if(hmi_object_id < HMI_DYN_XY_BITMAP_MAX_ID) { } #endif #if HMI_SEGMENT_MAX>0 else if(HMI_IS_SEGMENT(hmi_object_id)) { } #endif /*Get element x,y,w,h,color,alpha,angel*/ #if HMI_DXY_CONTAINERS_NUMBER>0 else if(HMI_IS_DYN_X_CONTAINER(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_X_CONTAINER_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_CONTAINERS_NUMBER) { *phmi_object_data = hmi_dyn_xy_container_rect[hmi_object_id].x; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_Y_CONTAINER(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_Y_CONTAINER_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_CONTAINERS_NUMBER) { *phmi_object_data = hmi_dyn_xy_container_rect[hmi_object_id].y; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_W_CONTAINER(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_W_CONTAINER_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_CONTAINERS_NUMBER) { *phmi_object_data = hmi_dyn_xy_container_rect[hmi_object_id].w; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_H_CONTAINER(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_H_CONTAINER_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_CONTAINERS_NUMBER) { *phmi_object_data = hmi_dyn_xy_container_rect[hmi_object_id].h; hmi_get_status = TRUE; } } #endif #if HMI_DXY_BITMAPS_NUMBER > 0 else if(HMI_IS_DYN_X_BITMAP(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_X_BITMAPS_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_BITMAPS_NUMBER) { *phmi_object_data = hmi_bmp_dyn_xy_rect[hmi_object_id].x; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_Y_BITMAP(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_Y_BITMAPS_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_BITMAPS_NUMBER) { *phmi_object_data= hmi_bmp_dyn_xy_rect[hmi_object_id].y; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_W_BITMAP(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_W_BITMAPS_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_BITMAPS_NUMBER) { *phmi_object_data= hmi_bmp_dyn_xy_rect[hmi_object_id].w; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_H_BITMAP(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_H_BITMAPS_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_BITMAPS_NUMBER) { *phmi_object_data= hmi_bmp_dyn_xy_rect[hmi_object_id].h; hmi_get_status = TRUE; } } #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_TWLIB)) else if(HMI_IS_DYN_ALPHA_BITMAP(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_ALPHA_BITMAPS_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_BITMAPS_NUMBER) { *phmi_object_data= hmi_bmp_dyn_xy_rect[hmi_object_id].alpha; hmi_get_status = TRUE; } } #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)) else if(HMI_IS_DYN_ANGEL_BITMAP(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_ANGEL_BITMAPS_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_BITMAPS_NUMBER) { #if HMI_SUPPORT_FLOAT_ANGEL == HMI_YES *phmi_object_data= HMI_F32_TO_U32(hmi_bmp_dyn_xy_rect[hmi_object_id].angel); #else *phmi_object_data= (hmi_bmp_dyn_xy_rect[hmi_object_id].angel); #endif hmi_get_status = TRUE; } } #endif #if (defined(HMI_GRAPHIC_RGL)) else if(HMI_IS_DYN_BLUR_BITMAP(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_BLUR_BITMAPS_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_BITMAPS_NUMBER) { *phmi_object_data= (hmi_bmp_dyn_xy_rect[hmi_object_id].attr&HMI_BLUR_FLAG); hmi_get_status = TRUE; } } #endif #endif #endif #if HMI_DXY_PAGES_NUMBER>0U else if(HMI_IS_DYN_X_PAGES(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_X_PAGES_INDEX(hmi_object_id); if(hmi_object_id<HMI_DXY_PAGES_NUMBER) { *phmi_object_data= hmi_dxy_page_rect[hmi_object_id].x ; hmi_get_status = TRUE;  } } else if(HMI_IS_DYN_Y_PAGES(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_Y_PAGES_INDEX(hmi_object_id); if(hmi_object_id<HMI_DXY_PAGES_NUMBER) { *phmi_object_data= hmi_dxy_page_rect[hmi_object_id].y ; hmi_get_status = TRUE;  } } else if(HMI_IS_DYN_W_PAGES(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_W_PAGES_INDEX(hmi_object_id); if(hmi_object_id<HMI_DXY_PAGES_NUMBER) { *phmi_object_data= hmi_dxy_page_rect[hmi_object_id].w ; hmi_get_status = TRUE;  } } else if(HMI_IS_DYN_H_PAGES(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_H_PAGES_INDEX(hmi_object_id); if(hmi_object_id<HMI_DXY_PAGES_NUMBER) { *phmi_object_data= hmi_dxy_page_rect[hmi_object_id].h ; hmi_get_status = TRUE;  } } #endif #if HMI_DXY_IMAGELIST_NUMBER>0U else if(HMI_IS_DYN_X_IMAGELIST(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_X_IMAGELIST_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_IMAGELIST_NUMBER) { *phmi_object_data = hmi_dxy_imagelist_rect[hmi_object_id].x; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_Y_IMAGELIST(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_Y_IMAGELIST_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_IMAGELIST_NUMBER) { *phmi_object_data = hmi_dxy_imagelist_rect[hmi_object_id].y; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_W_IMAGELIST(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_W_IMAGELIST_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_IMAGELIST_NUMBER) { *phmi_object_data = hmi_dxy_imagelist_rect[hmi_object_id].w; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_H_IMAGELIST(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_H_IMAGELIST_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_IMAGELIST_NUMBER) { *phmi_object_data = hmi_dxy_imagelist_rect[hmi_object_id].h; hmi_get_status = TRUE; } } #endif #if HMI_DXY_SCROLLBAR_NUMBER>0U else if(HMI_IS_DYN_X_SCROLLBAR(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_X_SCROLLBAR_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_SCROLLBAR_NUMBER) { *phmi_object_data = hmi_dxy_scrollbar_rect[hmi_object_id].x; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_Y_SCROLLBAR(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_Y_SCROLLBAR_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_SCROLLBAR_NUMBER) { *phmi_object_data = hmi_dxy_scrollbar_rect[hmi_object_id].y; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_W_SCROLLBAR(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_W_SCROLLBAR_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_SCROLLBAR_NUMBER) { *phmi_object_data = hmi_dxy_scrollbar_rect[hmi_object_id].w; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_H_SCROLLBAR(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_H_SCROLLBAR_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_SCROLLBAR_NUMBER) { *phmi_object_data = hmi_dxy_scrollbar_rect[hmi_object_id].h; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_ALPHA_SCROLLBAR(hmi_object_id)) { #if (defined(HMI_GRAPHIC_STGLIB)||defined(HMI_GRAPHIC_AGG)|| \ defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_TWLIB))  hmi_object_id=HMI_GET_DYN_ALPHA_SCROLLBAR_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_SCROLLBAR_NUMBER) { *phmi_object_data = hmi_dxy_scrollbar_rect[hmi_object_id].alpha; hmi_get_status = TRUE; } #endif } #endif #if HMI_DXY_BUTTON_NUMBER>0 else if(HMI_IS_DYN_X_BUTTON(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_X_BUTTON_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_BUTTON_NUMBER) { *phmi_object_data = hmi_dxy_button_rect[hmi_object_id].x; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_Y_BUTTON(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_Y_BUTTON_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_BUTTON_NUMBER) { *phmi_object_data = hmi_dxy_button_rect[hmi_object_id].y; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_W_BUTTON(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_W_BUTTON_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_BUTTON_NUMBER) { *phmi_object_data = hmi_dxy_button_rect[hmi_object_id].w; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_H_BUTTON(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_H_BUTTON_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_BUTTON_NUMBER) { *phmi_object_data = hmi_dxy_button_rect[hmi_object_id].h; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_ALPHA_BUTTON(hmi_object_id)) { #if (defined(HMI_GRAPHIC_STGLIB)||defined(HMI_GRAPHIC_AGG)|| \ defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_TWLIB))  hmi_object_id=HMI_GET_DYN_ALPHA_BUTTON_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_BUTTON_NUMBER) { *phmi_object_data = hmi_dxy_button_rect[hmi_object_id].alpha; hmi_get_status = TRUE; } #endif } #endif #if HMI_DYN_XY_EDIT_TEXTS_NUMBER > 0 else if(HMI_IS_DYN_X_DTEXT(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_X_DTEXT_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DYN_XY_EDIT_TEXTS_NUMBER) { *phmi_object_data= hmi_dyn_xy_edit_text_prop_table[hmi_object_id].text_rect.x; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_Y_DTEXT(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_Y_DTEXT_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DYN_XY_EDIT_TEXTS_NUMBER) { *phmi_object_data= hmi_dyn_xy_edit_text_prop_table[hmi_object_id].text_rect.y; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_W_DTEXT(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_W_DTEXT_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DYN_XY_EDIT_TEXTS_NUMBER) { *phmi_object_data = hmi_dyn_xy_edit_text_prop_table[hmi_object_id].text_rect.w; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_H_DTEXT(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_H_DTEXT_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DYN_XY_EDIT_TEXTS_NUMBER) { *phmi_object_data = hmi_dyn_xy_edit_text_prop_table[hmi_object_id].text_rect.h; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_DCOLOR_DTEXT(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_DCOLOR_DTEXT_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DYN_XY_EDIT_TEXTS_NUMBER) { *phmi_object_data = hmi_dyn_xy_edit_text_prop_table[hmi_object_id].color; hmi_get_status = TRUE; } } #endif #if HMI_UNEDIT_TEXTS_DYN_XY_NUMBER > 0 else if(HMI_IS_DYN_X_UNEDIT(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_X_STEXT_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_UNEDIT_TEXTS_DYN_XY_NUMBER) { *phmi_object_data = hmi_dyn_xy_unedit_text_prop_table[hmi_object_id].text_rect.x; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_Y_UNEDIT(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_Y_STEXT_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_UNEDIT_TEXTS_DYN_XY_NUMBER) { *phmi_object_data= hmi_dyn_xy_unedit_text_prop_table[hmi_object_id].text_rect.y; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_W_UNEDIT(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_W_STEXT_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_UNEDIT_TEXTS_DYN_XY_NUMBER) { *phmi_object_data = hmi_dyn_xy_unedit_text_prop_table[hmi_object_id].text_rect.w; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_H_UNEDIT(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_H_STEXT_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_UNEDIT_TEXTS_DYN_XY_NUMBER) { *phmi_object_data = hmi_dyn_xy_unedit_text_prop_table[hmi_object_id].text_rect.h; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_COLOR_UNEDIT(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_DCOLOR_STEXT_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_UNEDIT_TEXTS_DYN_XY_NUMBER) { *phmi_object_data= hmi_dyn_xy_unedit_text_prop_table[hmi_object_id].color; hmi_get_status = TRUE; } } #endif  #if HMI_DYN_FILL_PAGES_NUMBER > 0 else if(HMI_IS_DYN_X_NFILL(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_X_NFILL_ID_INDEX(hmi_object_id);  if(hmi_object_id < HMI_DYN_FILL_PAGES_NUMBER) { *phmi_object_data = hmi_fills_dyn_xy_rect[hmi_object_id].x; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_Y_NFILL(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_Y_NFILL_ID_INDEX(hmi_object_id);  if(hmi_object_id < HMI_DYN_FILL_PAGES_NUMBER) { *phmi_object_data = hmi_fills_dyn_xy_rect[hmi_object_id].y; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_W_NFILL(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_W_NFILL_ID_INDEX(hmi_object_id);  if(hmi_object_id< HMI_DYN_FILL_PAGES_NUMBER) { *phmi_object_data = hmi_fills_dyn_xy_rect[hmi_object_id].w; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_H_NFILL(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_H_NFILL_ID_INDEX(hmi_object_id);  if(hmi_object_id < HMI_DYN_FILL_PAGES_NUMBER) { *phmi_object_data = hmi_fills_dyn_xy_rect[hmi_object_id].h; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_COLOR_NFILL(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_COLOR_NFILL_ID_INDEX(hmi_object_id);  if(hmi_object_id < HMI_DYN_FILL_PAGES_NUMBER) { *phmi_object_data = hmi_fills_dyn_prop_table[hmi_object_id].color; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_Z_NFILL(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_Z_NFILL_ID_INDEX(hmi_object_id);  if(hmi_object_id < HMI_DYN_FILL_PAGES_NUMBER) { *phmi_object_data = hmi_fills_dyn_xy_rect[hmi_object_id].z; hmi_get_status = TRUE; } } #endif #if HMI_DYN_GFILL_NUMBER>0U else if(HMI_IS_DYN_X_GFILL(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_X_GFILL_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DYN_GFILL_NUMBER) { *phmi_object_data = hmi_gradient_dxy_fill_rect[hmi_object_id].x; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_Y_GFILL(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_Y_GFILL_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DYN_GFILL_NUMBER) { *phmi_object_data = hmi_gradient_dxy_fill_rect[hmi_object_id].y; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_W_GFILL(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_W_GFILL_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DYN_GFILL_NUMBER) { *phmi_object_data = hmi_gradient_dxy_fill_rect[hmi_object_id].w; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_H_GFILL(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_H_GFILL_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DYN_GFILL_NUMBER) { *phmi_object_data = hmi_gradient_dxy_fill_rect[hmi_object_id].h; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_C1_GFILL(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_C1_GFILL_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DYN_GFILL_NUMBER) { *phmi_object_data = hmi_gradient_dxy_fill_table[hmi_object_id].color1; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_C2_GFILL(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_C2_GFILL_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DYN_GFILL_NUMBER) { *phmi_object_data = hmi_gradient_dxy_fill_table[hmi_object_id].color2; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_Z_GFILL(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_Z_GFILL_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DYN_GFILL_NUMBER) { *phmi_object_data = hmi_gradient_dxy_fill_rect[hmi_object_id].z; hmi_get_status = TRUE; } } #endif #if HMI_DXY_CUBE_NUMBER>0U else if(HMI_IS_DYN_X_CUBE(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_X_CUBE_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_CUBE_NUMBER) { *phmi_object_data = hmi_cubes_dyn_xy_rect[hmi_object_id].cube_rect.x; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_Y_CUBE(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_Y_CUBE_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_CUBE_NUMBER) { *phmi_object_data = hmi_cubes_dyn_xy_rect[hmi_object_id].cube_rect.y; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_W_CUBE(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_W_CUBE_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_CUBE_NUMBER) { *phmi_object_data = hmi_cubes_dyn_xy_rect[hmi_object_id].cube_rect.w; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_H_CUBE(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_H_CUBE_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_CUBE_NUMBER) { *phmi_object_data = hmi_cubes_dyn_xy_rect[hmi_object_id].cube_rect.h; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_BUMP_CUBE(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_BUMP_CUBE_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_CUBE_NUMBER) { *phmi_object_data = hmi_cubes_dyn_xy_rect[hmi_object_id].bump; hmi_get_status = TRUE; } } else if(HMI_IS_DYN_ANGEL_CUBE(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_ANGEL_CUBE_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_CUBE_NUMBER) { *phmi_object_data = hmi_cubes_dyn_xy_rect[hmi_object_id].angel; hmi_get_status = TRUE; } } #endif #if HMI_ALL_DYN_OBJECTS_NUMBER > HMI_PAGES_NUMBER else { } #endif }  else { #if (HMI_SCROLL_TEXT_SUPPORT != 0) && (HMI_DYN_EDIT_TEXTS_NUMBER > 0) if(HMI_IS_EDIT_DXY_TEXT_SCROLL(hmi_object_id)) { hmi_object_id=HMI_GET_SCROLL_TEXT_ID_INDEX(hmi_object_id);  if(hmi_object_id < HMI_DYN_EDIT_TEXTS_NUMBER) { HMI_TEXT_PROP_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_dyn_text_info = &hmi_edit_text_table[hmi_object_id]; HMI_CHAR_STR hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml hmi_scroll_text_offset=NULL; if((phmi_dyn_text_info->properties & HMI_TEXT_PROP_SCROLABLE) != 0) { hmi_scroll_text_offset = &((HMI_CHAR_STR *)(phmi_dyn_text_info->hmi_string))[phmi_dyn_text_info->length+1]; #if HMI_FONT_CODE==HMI_FONT_CODE_UNICODE *phmi_object_data = *hmi_scroll_text_offset; #else *phmi_object_data = *hmi_scroll_text_offset++; (*phmi_object_data)<<=8; *phmi_object_data += *hmi_scroll_text_offset; #endif hmi_get_status = TRUE; } }  } else #endif  /*Set dyn timer elapse*/ #if HMI_DYN_TIMER_ACTION_DURATION_NUMBER>0 if(HMI_IS_TIMER_ACTION_D_DURATION(hmi_object_id)) { hmi_object_id=HMI_GET_TIMER_ACTION_D_DURATION_ID_INDEX(hmi_object_id); time_angel=hmi_get_timer_s_e(hmi_object_id,HMI_SET_ELAPSE); *phmi_object_data=HMI_F32_TO_U32(time_angel); hmi_get_status = TRUE; } else #endif /*Set dyn timer start and duration*/ #if HMI_DYN_TIMER_ACTION_DURATION_NUMBER>0 if(HMI_IS_DYN_TIMER_S_E(hmi_object_id)) { if(HMI_IS_DYN_TIMER_START(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_TIMER_S_INDEX(hmi_object_id); time_angel=hmi_get_timer_s_e(hmi_object_id,HMI_SET_START); *phmi_object_data=HMI_F32_TO_U32(time_angel); hmi_get_status = TRUE; } else /*dyn timer end*/ { hmi_object_id=HMI_GET_DYN_TIMER_E_INDEX(hmi_object_id); time_angel=hmi_get_timer_s_e(hmi_object_id,HMI_SET_START); *phmi_object_data=HMI_F32_TO_U32(time_angel); hmi_get_status = TRUE; }  } else #endif /*Set dyn pos start and end*/ #if HMI_ANIM_DYN_SET_POS_NUMBER>0 if(HMI_IS_DYN_POS_S_E(hmi_object_id)) { if(HMI_IS_DYN_POS_START(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_POS_START(hmi_object_id); *phmi_object_data=hmi_get_dyn_pos_s_e(hmi_object_id,TRUE); hmi_get_status = TRUE; } else /*end*/ { hmi_object_id=HMI_GET_DYN_POS_END(hmi_object_id); *phmi_object_data=hmi_get_dyn_pos_s_e(hmi_object_id,FALSE); hmi_get_status = TRUE; } } else #endif /*Set dyn width heigh start and end*/ #if HMI_ANIM_DYN_SET_W_H_NUMBER>0 if(HMI_IS_DYN_WH_S_E(hmi_object_id)) { if(HMI_IS_DYN_WH_START(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_WH_START(hmi_object_id); *phmi_object_data=hmi_get_dyn_wh_s_e(hmi_object_id,TRUE); hmi_get_status = TRUE; } else /*end*/ { hmi_object_id=HMI_GET_DYN_WH_END(hmi_object_id); *phmi_object_data=hmi_get_dyn_wh_s_e(hmi_object_id,FALSE); hmi_get_status = TRUE; } } else #endif /*Set dyn fcolor start and end*/ #if HMI_ANIM_DYN_SET_FOR_COLOR_NUMBER>0 if(HMI_IS_DYN_FCOLOR_S_E(hmi_object_id)) { if(HMI_IS_DYN_FCOLOR_START(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_FCOLOR_START(hmi_object_id); *phmi_object_data=hmi_get_dyn_fcolor_s_e(hmi_object_id,TRUE); hmi_get_status = TRUE; } else /*end*/ { hmi_object_id=HMI_GET_DYN_FCOLOR_END(hmi_object_id); *phmi_object_data=hmi_get_dyn_fcolor_s_e(hmi_object_id,FALSE); hmi_get_status = TRUE; } } else #endif /*Set dyn image list start and end*/ #if HMI_ANIM_DYN_SET_IMAGELIST_INDEX_NUMBER>0 if(HMI_IS_DYN_IMGLST_S_E(hmi_object_id)) { if(HMI_IS_DYN_IMGLST_START(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_IMGLST_START(hmi_object_id); *phmi_object_data=hmi_get_dyn_imglist_s_e(hmi_object_id,TRUE); hmi_get_status = TRUE; } else /*end*/ { hmi_object_id=HMI_GET_DYN_IMGLST_END(hmi_object_id); *phmi_object_data=hmi_get_dyn_imglist_s_e(hmi_object_id,FALSE); hmi_get_status = TRUE; } } else #endif /*Set dyn alpha start and end*/ #if HMI_ANIM_DYN_SET_ALPHA_NUMBER>0 if(HMI_IS_DYN_ALPHA_S_E(hmi_object_id)) { if(HMI_IS_DYN_ALPHA_START(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_ALPHA_START(hmi_object_id); *phmi_object_data=hmi_get_dyn_alpha_s_e(hmi_object_id,TRUE); hmi_get_status = TRUE; } else /*end*/ { hmi_object_id=HMI_GET_DYN_ALPHA_END(hmi_object_id); *phmi_object_data=hmi_get_dyn_alpha_s_e(hmi_object_id,FALSE); hmi_get_status = TRUE; } } else #endif /*Set dyn angel start and end*/ #if HMI_ANIM_DYN_SET_ANGEL_NUMBER>0 if(HMI_IS_DYN_ANGEL_S_E(hmi_object_id)) { if(HMI_IS_DYN_ANGEL_START(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_ANGEL_START(hmi_object_id); #ifndef HMI_GRAPHIC_TWLIB time_angel=hmi_get_dyn_angel_s_e(hmi_object_id,TRUE);  #if HMI_SUPPORT_FLOAT_ANGEL == HMI_YES *phmi_object_data = HMI_F32_TO_U32(time_angel); #else *phmi_object_data = time_angel; #endif  #else time_angel = 0;/*tw not support*/ *phmi_object_data = time_angel; #endif  hmi_get_status = TRUE; } else /*end*/ { hmi_object_id = HMI_GET_DYN_ANGEL_END(hmi_object_id); time_angel = hmi_get_dyn_angel_s_e(hmi_object_id,FALSE); #if HMI_SUPPORT_FLOAT_ANGEL == HMI_YES *phmi_object_data = HMI_F32_TO_U32(time_angel); #else *phmi_object_data = (time_angel); #endif  hmi_get_status = TRUE; } } #endif { } }  return hmi_get_status; } #endif #endif  #if HMI_DYN_EDIT_TEXTS_NUMBER > 0 #if HMI_GET_TEXT_FUNC==YES HMI_CHAR_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml hmi_engine_get_text(HMI_OBJECT_ID_STR hmi_object_id) { HMI_CHAR_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_string = 0U; if(HMI_IS_DYN_TEXTS(hmi_object_id)) {  hmi_object_id = HMI_GET_DYN_TEXTS_INDEX(hmi_object_id); if(hmi_object_id<HMI_DYN_EDIT_TEXTS_NUMBER)  { phmi_string = (HMI_CHAR_STR *)hmi_edit_text_table[hmi_object_id].hmi_string; } } return(phmi_string); } #endif #endif  /* intersection p_r1 and p_r2 zont to phmi_temp_rect */ #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513)) void hmi_get_intersec_rect(HMI_RECT_STR CONST *p_r1,HMI_RECT_STR CONST *p_r2,HMI_RECT_STR *phmi_temp_rect) {  HMI_X_STR min_right = 0; HMI_Y_STR min_bottom = 0;  if((p_r1 != NULL)&&(p_r2 != NULL)&&(phmi_temp_rect != NULL)) {  phmi_temp_rect->x = HMI_INVALID_COOR; phmi_temp_rect->y = HMI_INVALID_COOR; phmi_temp_rect->w = 0; phmi_temp_rect->h = 0;  if((p_r1->x) > (p_r2->x)) { phmi_temp_rect->x = p_r1->x; } else { phmi_temp_rect->x = p_r2->x; } if((p_r1->y) > (p_r2->y)) { phmi_temp_rect->y = p_r1->y; } else { phmi_temp_rect->y = p_r2->y; }  if((p_r1->x + p_r1->w) < (p_r2->x + p_r2->w)) { min_right = p_r1->x + p_r1->w; } else { min_right = p_r2->x + p_r2->w; } if((p_r1->y + p_r1->h)<(p_r2->y + p_r2->h)) { min_bottom = p_r1->y + p_r1->h; } else { min_bottom = p_r2->y + p_r2->h; } if(phmi_temp_rect->x <= min_right) { phmi_temp_rect->w = min_right-phmi_temp_rect->x; } else { phmi_temp_rect->x = HMI_INVALID_COOR; phmi_temp_rect->y = HMI_INVALID_COOR; phmi_temp_rect->w = 0; phmi_temp_rect->h = 0; } if(phmi_temp_rect->y <= min_bottom) { phmi_temp_rect->h = min_bottom-phmi_temp_rect->y; } else { phmi_temp_rect->x = HMI_INVALID_COOR; phmi_temp_rect->y = HMI_INVALID_COOR; phmi_temp_rect->w = 0; phmi_temp_rect->h = 0; } }  }  /* p_node_pos intersec with p_dirty[]  */ void hmi_get_intersec_rect_depth(HMI_RECT_STR CONST *p_node_screen_pos,U08 depth,HMI_RECT_STR *p_dirty,HMI_RECT_STR *p_insect) {  UINT8 gdi_layer = 0;  if((p_node_screen_pos != NULL)&&(p_dirty != NULL)&&(p_insect != NULL)) { #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)|| \ defined(HMI_GRAPHIC_ST)) //gdi_layer = get_layer_from_depth(depth);//removed by pxguo if(gdi_layer < HMI_LAYER_MAX_CNT) { hmi_get_intersec_rect(p_node_screen_pos, &(p_dirty[depth]/*&(p_dirty[gdi_layer]*/), p_insect); } #endif  #if defined(HMI_GRAPHIC_ST7513) gdi_layer = 0;  hmi_get_intersec_rect(p_node_screen_pos, &p_dirty[gdi_layer], p_insect);  #endif }  }   #endif  /* get screen coordinate */ void hmi_get_object_screen_coor(HMI_RECT_STR CONST *pfarther_rect,HMI_RECT_STR CONST *pobject_rect,HMI_RECT_STR *phmi_temp_rect) {  phmi_temp_rect->x=pfarther_rect->x+pobject_rect->x; phmi_temp_rect->y=pfarther_rect->y+pobject_rect->y; phmi_temp_rect->w=pobject_rect->w; phmi_temp_rect->h=pobject_rect->h;  }  /* union pfarther_rect and pdirty_rect to pdirty_rect zone */ #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513)) void hmi_set_dirty_zone(HMI_RECT_STR *pfarther_rect,HMI_RECT_STR *pdirty_rect) { HMI_X_STR max_right = 0; HMI_Y_STR max_bottom = 0; HMI_X_STR parent_right = 0; HMI_Y_STR parent_bottom = 0; HMI_X_STR dirty_right = 0; HMI_Y_STR dirty_bottom = 0;  if((pfarther_rect != NULL)&&(pdirty_rect != NULL)) { if((pdirty_rect->x == HMI_INVALID_COOR)&&  (pdirty_rect->y == HMI_INVALID_COOR)&&  (pdirty_rect->w == 0)&& (pdirty_rect->h == 0)) { pdirty_rect->x = pfarther_rect->x; pdirty_rect->y = pfarther_rect->y; pdirty_rect->w = pfarther_rect->w; pdirty_rect->h = pfarther_rect->h; } else { /*union pfarther_rect and pdirty_rect to pdirty_rect zone*/ parent_right = pfarther_rect->x + pfarther_rect->w; dirty_right = pdirty_rect->x + pdirty_rect->w; parent_bottom = pfarther_rect->y + pfarther_rect->h; dirty_bottom = pdirty_rect->y + pdirty_rect->h; if(parent_right > dirty_right) { max_right = parent_right; } else { max_right = dirty_right; } if(parent_bottom > dirty_bottom) { max_bottom = parent_bottom; } else { max_bottom = dirty_bottom; } if(pfarther_rect->x < pdirty_rect->x) { pdirty_rect->x = pfarther_rect->x; } if(pfarther_rect->y < pdirty_rect->y) { pdirty_rect->y = pfarther_rect->y; } pdirty_rect->w = max_right - pdirty_rect->x; pdirty_rect->h = max_bottom - pdirty_rect->y; } }  }  void hmi_set_dirty_zone_layer(HMI_RECT_STR *pnode_rect,HMI_RECT_STR *pdirty_rect, U08 depth/*page node depth*/) {  U08 layer = 0; U08 i = 0; U08 buffer_layer= FALSE; HMI_RECT_STR full_screen = {0,0,HMI_MAX_WIDTH,HMI_MAX_HEIGHT};  #if (defined(HMI_GRAPHIC_RGL)) { layer = HMI_LAYER_MAX_CNT; } #else { layer = 1; } #endif if(depth == HMI_PAGE_ALL_LAYER)/*all layer*/ { for(i=0;i < layer;i++) {  buffer_layer = is_buffer_layer(i); if(buffer_layer == TRUE) { hmi_add_dirty(pnode_rect, pdirty_rect,i);  } else { hmi_add_dirty(&full_screen, pdirty_rect,i);  } } } else  {  if(depth < layer) {  buffer_layer = is_buffer_layer(depth/*i*/); if(buffer_layer == TRUE) { hmi_add_dirty(pnode_rect, pdirty_rect,depth);  } else { hmi_add_dirty(&full_screen, pdirty_rect,depth);  } } }  }  #endif  #if 0 UINT8 hmi_engine_draw_page(UINT8 cur_step #ifndef HMI_GRAPHIC_TWLIB ,HMI_RECT_STR *pdirty_zone #endif ) {  BOOLEAN is_video_page=FALSE; HMI_RECT_STR CONST *phmi_page_rect=NULL; #if HMI_LAYER_0_HIGHEST_PRIORITY> 1U UINT8 hmi_priority_cnt=0U; UINT8 hmi_layer_highest_active_priority=0U; #endif UINT8 hmi_object_index = 0U; HMI_LAYER_TABLE_STR CONST *phmi_active_layer_info = &hmi_layer_table[0]; #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST))  HMI_RECT_STR hmi_temp_rect={HMI_INVALID_COOR,HMI_INVALID_COOR,0,0}; HMI_RECT_STR hmi_union_rect ={HMI_INVALID_COOR,HMI_INVALID_COOR,0,0}; HMI_RECT_STR CONST *pold_page_rect=NULL; HMI_RECT_STR hmi_screen_rect={0,0,HMI_MAX_WIDTH,HMI_MAX_HEIGHT}; #else /*tw*/  HMI_ELEMENT_TYPE element_type=HMI_ELEM_TYPE_SPAGE; BOOLEAN bDrawBck=FALSE; #endif //HMI_RECT_STR hmi_screen_rect={0,0,HMI_MAX_WIDTH,HMI_MAX_HEIGHT}; hmi_driver_woking_status_flag = 0U; #ifdef HMI_GRAPHIC_RGL set_first_draw_all(); #endif #if 0 #if HMI_LAYER_0_HIGHEST_PRIORITY > 1 hmi_layer_highest_active_priority = HMI_LAYER_0_HIGHEST_PRIORITY; #endif #endif #if 0 if(hmi_driver_check_busy_status() == TRUE) { HMI_GFX_SET_STATUS(HMI_SEND_EVENT); } else #endif #if HMI_LAYER_0_HIGHEST_PRIORITY > 1 { hmi_layer_highest_active_priority = hmi_highest_active_page_priority; } if(hmi_layer_highest_active_priority < HMI_LAYER_0_HIGHEST_PRIORITY) #endif { #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)) #if HMI_DYN_LANGUAGE_NUMBER>0 if((cur_step==HMI_GET_DIRTY_ZONE)&&(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(HMI_LANGUAGE)!=0U)) { hmi_set_dirty_zone(&hmi_screen_rect,pdirty_zone); HMI_DYNAMIC_OBJECT_CANCEL_CHANGED_FLAG(HMI_LANGUAGE); } else #endif  #endif {  #if HMI_LAYER_0_HIGHEST_PRIORITY > 1  /*if get dirty zone ,search all priority page table.*/ if(cur_step==HMI_GET_DIRTY_ZONE) { hmi_layer_highest_active_priority=HMI_LAYER_0_HIGHEST_PRIORITY-1; } for(hmi_priority_cnt=0U; hmi_priority_cnt <= hmi_layer_highest_active_priority; hmi_priority_cnt++) #endif { #if HMI_LAYER_0_HIGHEST_PRIORITY > 1 HMI_PAGE_ID_STR hmi_page_id = hmi_layer_0_active_page_id[hmi_priority_cnt].new_page; HMI_PAGE_ID_STR hmi_old_page = hmi_layer_0_active_page_id[hmi_priority_cnt].old_page; #else HMI_PAGE_ID_STR hmi_page_id = hmi_layer_0_active_page_id[0].new_page; HMI_PAGE_ID_STR hmi_old_page =hmi_layer_0_active_page_id[0].old_page; #endif HMI_PAGE_TABLE_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_page_info = NULL; #if HMI_DXY_PAGES_NUMBER>0U if(HMI_IS_DXY_PAGE(hmi_page_id)) { if(HMI_IS_VIDEO_DXY_PAGE(hmi_page_id)) { is_video_page=TRUE; phmi_page_info=NULL; hmi_engine_draw_video(); } else { phmi_page_rect=&hmi_dxy_page_rect[hmi_page_id]; phmi_page_info = &hmi_dxy_page_table[hmi_page_id]; } #ifdef HMI_GRAPHIC_TWLIB element_type=HMI_ELEM_TYPE_DPAGE; #endif } else #endif #if HMI_SXY_PAGES_NUMBER>0U if(HMI_IS_SXY_PAGE(hmi_page_id))  { if(HMI_IS_VIDEO_SXY_PAGE(hmi_page_id)) { is_video_page=TRUE; phmi_page_info=NULL; hmi_engine_draw_video(); } else { hmi_object_index=HMI_GET_PAGE_SXY_ID_INDEX(hmi_page_id); phmi_page_rect=&hmi_sxy_page_rect[hmi_object_index]; phmi_page_info = &hmi_sxy_page_table[hmi_object_index]; } #ifdef HMI_GRAPHIC_TWLIB element_type=HMI_ELEM_TYPE_SPAGE; #endif } else #endif { } #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)) if(cur_step==HMI_GET_DIRTY_ZONE) { /*old page rect is dirty zone*/ if(hmi_old_page!=HMI_PAGES_NUMBER) { pold_page_rect=NULL;  #if HMI_NDXY_PAGES_NUMBER>0U if(HMI_IS_NORMAL_DXY_PAGE(hmi_old_page)/*hmi_old_page<HMI_DXY_PAGES_NUMBER*/) { pold_page_rect=&hmi_dxy_page_rect[hmi_old_page]; } else #endif #if HMI_NSXY_PAGES_NUMBER>0U if(HMI_IS_NORMAL_SXY_PAGE/*hmi_old_page<HMI_PAGE_SXY_MAX_ID*/) { hmi_object_index=HMI_GET_PAGE_SXY_ID_INDEX(hmi_old_page); pold_page_rect=&hmi_sxy_page_rect[hmi_object_index]; } else #endif { } hmi_get_intersec_rect((HMI_RECT_STR CONST *)pold_page_rect,(HMI_RECT_STR CONST *)&hmi_screen_rect,&hmi_union_rect); if((hmi_union_rect.x==HMI_INVALID_COOR)&&(hmi_union_rect.y==HMI_INVALID_COOR)&&(hmi_union_rect.w==0)&&(hmi_union_rect.h==0)) {} else { if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_old_page)!=0) { hmi_set_dirty_zone(&hmi_union_rect,pdirty_zone); HMI_DYNAMIC_OBJECT_CANCEL_CHANGED_FLAG(hmi_old_page);  } } } } #endif if(phmi_page_info!=NULL) { if(cur_step==HMI_DRAW_PAGE) { if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_page_id)!=0) { HMI_DYNAMIC_OBJECT_CANCEL_CHANGED_FLAG(hmi_page_id); #ifdef HMI_GRAPHIC_TWLIB bDrawBck=TRUE; #endif } #if defined(HMI_GRAPHIC_TWLIB) else { bDrawBck=FALSE; } #endif #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)) hmi_get_intersec_rect((HMI_RECT_STR CONST *)phmi_page_rect,(HMI_RECT_STR CONST *)&hmi_screen_rect,&hmi_union_rect); hmi_engine_draw_container(&phmi_page_info->container,(HMI_RECT_STR CONST *)phmi_page_rect,&hmi_union_rect,pdirty_zone); #else /*tw*/  hmi_engine_draw_container(&phmi_page_info->container, (HMI_RECT_STR CONST *)phmi_page_rect, element_type,hmi_page_id,bDrawBck); #endif } #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)) else if(cur_step==HMI_GET_DIRTY_ZONE) { /*new page dirty zone*/ hmi_get_intersec_rect((HMI_RECT_STR CONST *)phmi_page_rect,(HMI_RECT_STR CONST *)&hmi_screen_rect,&hmi_union_rect); if((hmi_union_rect.x==HMI_INVALID_COOR)&&(hmi_union_rect.y==HMI_INVALID_COOR)&&(hmi_union_rect.w==0)&&(hmi_union_rect.h==0)) {} else { if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_page_id)!=0) {  #if HMI_DXY_PAGES_NUMBER>0U if(hmi_page_id<HMI_DXY_PAGES_NUMBER) { /*dyn page dirty zone is buffer rect*/ hmi_set_dirty_zone(&hmi_screen_rect,pdirty_zone); } else #endif #if HMI_SXY_PAGES_NUMBER>0U if(hmi_page_id<HMI_PAGE_SXY_MAX_ID) { /*static page dirty zone is page rect*/ hmi_set_dirty_zone(&hmi_union_rect,pdirty_zone); } else #endif { } } #if HMI_ALL_DYN_OBJECTS_NUMBER > HMI_PAGES_NUMBER #if (HMI_ENGINE_LOW_PRIOR_PAGE_UPDATA == HMI_UPDATE_BUSY) && (HMI_LAYER_0_HIGHEST_PRIORITY > 1) else if(hmi_priority_cnt >= hmi_highest_active_page_priority) #else else #endif { hmi_engine_check_dynamic_object_changed(&phmi_page_info->container,(HMI_RECT_STR CONST *)phmi_page_rect,&hmi_union_rect,pdirty_zone); } #if (HMI_ENGINE_LOW_PRIOR_PAGE_UPDATA == HMI_UPDATE_BUSY) && (HMI_LAYER_0_HIGHEST_PRIORITY > 1) else { } #endif #endif } } else {} #endif } } } } if((cur_step==HMI_DRAW_PAGE)&&(!is_video_page)) { #if defined(HMI_GRAPHIC_TWLIB)  call_C_hmi_driver_refresh_LCD(bDrawBck); #else call_C_hmi_driver_refresh_LCD(); #endif } return(hmi_driver_woking_status_flag); }  #endif  #if HMI_PAGES_NUMBER>0 #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513)) UINT8 hmi_engine_get_dirty_zone_page(HMI_RECT_STR *pdirty_zone) {  BOOLEAN is_video_page = FALSE; #if defined(HMI_GRAPHIC_RGL) BOOLEAN exist_video_page= FALSE; #endif BOOLEAN dxy_page = FALSE; HMI_RECT_STR hmi_page_rect = {0}; #if HMI_LAYER_0_HIGHEST_PRIORITY > 1U  UINT8 hmi_priority_cnt= 0U; UINT8 hmi_layer_highest_active_priority = 0U; #endif UINT8 hmi_object_index = 0U; #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513))  HMI_RECT_STR hmi_insec_rect = {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0}; HMI_RECT_STR old_page_rect = {0}; HMI_RECT_STR hmi_screen_rect = {0,0,HMI_MAX_WIDTH,HMI_MAX_HEIGHT};  HMI_RECT_STR cliped_farther_rect = {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0}; #endif HMI_PAGE_TABLE_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_page_info = NULL;  HMI_PAGE_ID_STR hmi_page_id = 0; HMI_PAGE_ID_STR hmi_old_page = 0;  #if HMI_LAYER_0_HIGHEST_PRIORITY > 1 UINT8 pop_up_window_layer = 0; { hmi_layer_highest_active_priority = hmi_highest_active_page_priority; } if(hmi_layer_highest_active_priority < HMI_LAYER_0_HIGHEST_PRIORITY) #endif {  #if HMI_DYN_LANGUAGE_NUMBER > 0 /*language number >1*/ if((HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(HMI_LANGUAGE) != 0U))/*if change language setting,all active page need refresh*/ {  hmi_set_dirty_zone_layer(&hmi_screen_rect,pdirty_zone,HMI_PAGE_ALL_LAYER); HMI_DYNAMIC_OBJECT_CANCEL_CHANGED_FLAG(HMI_LANGUAGE); } else  #endif {  #if HMI_LAYER_0_HIGHEST_PRIORITY > 1  /*Search all priority page table.*/  hmi_layer_highest_active_priority = HMI_LAYER_0_HIGHEST_PRIORITY-1;  for(hmi_priority_cnt=0U; hmi_priority_cnt <= hmi_layer_highest_active_priority; hmi_priority_cnt++) #endif { #if HMI_LAYER_0_HIGHEST_PRIORITY > 1 hmi_page_id = hmi_layer_0_active_page_id[hmi_priority_cnt].new_page; hmi_old_page = hmi_layer_0_active_page_id[hmi_priority_cnt].old_page; hmi_layer_0_active_page_id[hmi_priority_cnt].old_page = HMI_PAGES_NUMBER; #else hmi_page_id = hmi_layer_0_active_page_id[0].new_page; hmi_old_page = hmi_layer_0_active_page_id[0].old_page; hmi_layer_0_active_page_id[0].old_page = HMI_PAGES_NUMBER; #endif  #if HMI_DXY_PAGES_NUMBER > 0U /*Get current dxy page info*/ if(HMI_IS_DXY_PAGE(hmi_page_id)) { dxy_page = TRUE; if(HMI_IS_VIDEO_DXY_PAGE(hmi_page_id)) { is_video_page = TRUE; phmi_page_info = NULL;  #if defined(HMI_GRAPHIC_RGL) exist_video_page= TRUE; #endif } else /*dxy page,not video page*/ { hmi_object_index = HMI_GET_PAGE_DXY_ID_INDEX(hmi_page_id); if(hmi_object_index < HMI_DXY_PAGES_NUMBER) {  hmi_page_rect.x = hmi_dxy_page_rect[hmi_object_index].x; hmi_page_rect.y = hmi_dxy_page_rect[hmi_object_index].y; hmi_page_rect.w = hmi_dxy_page_rect[hmi_object_index].w; hmi_page_rect.h = hmi_dxy_page_rect[hmi_object_index].h; phmi_page_info = &hmi_dxy_page_table[hmi_object_index]; } }  } else #endif #if HMI_SXY_PAGES_NUMBER > 0U /*Get current static xy page info*/ if(HMI_IS_SXY_PAGE(hmi_page_id))  { dxy_page = FALSE; if(HMI_IS_VIDEO_SXY_PAGE(hmi_page_id)) { is_video_page = TRUE; phmi_page_info = NULL; #if defined(HMI_GRAPHIC_RGL) exist_video_page= TRUE; #endif } else /*sxy page,not video page*/ { hmi_object_index = HMI_GET_PAGE_SXY_ID_INDEX(hmi_page_id); if(hmi_object_index < HMI_SXY_PAGES_NUMBER) { hmi_page_rect.x = hmi_sxy_page_rect[hmi_object_index].x; hmi_page_rect.y = hmi_sxy_page_rect[hmi_object_index].y; hmi_page_rect.w = hmi_sxy_page_rect[hmi_object_index].w; hmi_page_rect.h = hmi_sxy_page_rect[hmi_object_index].h; phmi_page_info = &hmi_sxy_page_table[hmi_object_index]; } }  } else #endif { } if(hmi_page_id != HMI_PAGES_NUMBER) { if((HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_page_id) != 0))  { if((!is_video_page)) {  if(dxy_page) { hmi_page_rect.x = hmi_screen_rect.x;/*dxy page dirty zone is screen zone*/ hmi_page_rect.y = hmi_screen_rect.y; hmi_page_rect.w = hmi_screen_rect.w; hmi_page_rect.h = hmi_screen_rect.h; }  hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_page_rect), (HMI_RECT_STR CONST *)(&hmi_screen_rect), &hmi_insec_rect);/*clip phmi_page_rect width screen zone*/ #if HMI_LAYER_0_HIGHEST_PRIORITY > 1U if(hmi_priority_cnt != 0)/*only pop up window layer need refresh*/ { #if defined(HMI_GRAPHIC_RGL) pop_up_window_layer = get_popup_window_layer();/*RGL not support pop up page*/ #else pop_up_window_layer = 0;/*one layer of GDI*/ #endif hmi_set_dirty_zone_layer((HMI_RECT_STR *)(&hmi_page_rect),pdirty_zone, pop_up_window_layer); } else { hmi_set_dirty_zone_layer((HMI_RECT_STR *)(&hmi_page_rect),pdirty_zone, 0); } #else {  hmi_set_dirty_zone_layer((HMI_RECT_STR *)(&hmi_page_rect),pdirty_zone, HMI_PAGE_ALL_LAYER);/*all layer is dirty*/ }  #endif } } else /*search every element refresh flag and get union element dirty zone*/ { if(!is_video_page) {  hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_screen_rect), (HMI_RECT_STR CONST *)(&hmi_page_rect), &cliped_farther_rect); hmi_engine_check_dynamic_object_changed((HMI_CONTAINER_STR CONST *)(&(phmi_page_info->container)), (HMI_RECT_STR CONST *)(&hmi_page_rect), pdirty_zone, HMI_PAGE_BEGIN_DEPTH/*page node tree depth*/, &cliped_farther_rect); } } }  if((hmi_old_page!=HMI_PAGES_NUMBER) )/*Get old page info*/ {   { #if HMI_DXY_PAGES_NUMBER>0U  if(HMI_IS_DXY_PAGE(hmi_old_page))  { dxy_page = TRUE; if(HMI_IS_VIDEO_DXY_PAGE(hmi_old_page)) { is_video_page = TRUE; old_page_rect.x = 0; old_page_rect.y = 0; old_page_rect.w = 0; old_page_rect.h = 0; } else { is_video_page=FALSE;  hmi_object_index=HMI_GET_PAGE_DXY_ID_INDEX(hmi_old_page); if(hmi_object_index<HMI_DXY_PAGES_NUMBER) { if((HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_old_page)!=0U))/*set ,refresh flag not render*/ { HMI_DYNAMIC_OBJECT_CANCEL_CHANGED_FLAG(hmi_old_page); old_page_rect.x=hmi_screen_rect.x; old_page_rect.y=hmi_screen_rect.y; old_page_rect.w=hmi_screen_rect.w; old_page_rect.h=hmi_screen_rect.h; } else { old_page_rect.x=hmi_dxy_page_rect[hmi_object_index].x; old_page_rect.y=hmi_dxy_page_rect[hmi_object_index].y; old_page_rect.w=hmi_dxy_page_rect[hmi_object_index].w; old_page_rect.h=hmi_dxy_page_rect[hmi_object_index].h; } } } } #endif  #if HMI_SXY_PAGES_NUMBER>0U if(HMI_IS_SXY_PAGE(hmi_old_page))  { dxy_page = FALSE; if(HMI_IS_VIDEO_SXY_PAGE(hmi_old_page)) { is_video_page = TRUE; old_page_rect.x = 0; old_page_rect.y = 0; old_page_rect.w = 0; old_page_rect.h = 0; } else { is_video_page=FALSE; hmi_object_index=HMI_GET_PAGE_SXY_ID_INDEX(hmi_old_page); if(hmi_object_index<HMI_SXY_PAGES_NUMBER) { old_page_rect.x=hmi_sxy_page_rect[hmi_object_index].x; old_page_rect.y=hmi_sxy_page_rect[hmi_object_index].y; old_page_rect.w=hmi_sxy_page_rect[hmi_object_index].w; old_page_rect.h=hmi_sxy_page_rect[hmi_object_index].h; } } } #endif if(old_page_rect.w != 0) { #if HMI_LAYER_0_HIGHEST_PRIORITY > 1U if(hmi_priority_cnt!=0)/*only pop up window layer need refresh*/ { #if defined(HMI_GRAPHIC_RGL) pop_up_window_layer = get_popup_window_layer(); #else pop_up_window_layer = 0;/*0 layer of GDI*/ #endif hmi_set_dirty_zone_layer((HMI_RECT_STR *)(&old_page_rect),pdirty_zone, pop_up_window_layer); } else {  hmi_set_dirty_zone_layer((HMI_RECT_STR *)(&old_page_rect),pdirty_zone, HMI_PAGE_ALL_LAYER);/*all layer is dirty*/ } #else hmi_set_dirty_zone_layer((HMI_RECT_STR *)(&old_page_rect),pdirty_zone, HMI_PAGE_ALL_LAYER);/*all layer is dirty*/ #endif } } }  } } } #if defined(HMI_GRAPHIC_RGL) if(exist_video_page == TRUE) { #if 0 hmi_enable_video_layer(TRUE); #endif } else {  } #endif return(hmi_driver_woking_status_flag); } #endif   #if 0 UINT8 hmi_engine_draw_page(UINT8 cur_step #ifndef HMI_GRAPHIC_TWLIB ,HMI_RECT_STR *pdirty_zone #endif ) {  BOOLEAN is_video_page=FALSE; HMI_RECT_STR CONST *phmi_page_rect=NULL; #if HMI_LAYER_0_HIGHEST_PRIORITY> 1U UINT8 hmi_priority_cnt=0U; UINT8 hmi_layer_highest_active_priority=0U; #endif UINT8 hmi_object_index = 0U; HMI_LAYER_TABLE_STR CONST *phmi_active_layer_info = &hmi_layer_table[0]; #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST))  HMI_RECT_STR hmi_temp_rect={HMI_INVALID_COOR,HMI_INVALID_COOR,0,0}; HMI_RECT_STR hmi_insec_rect ={HMI_INVALID_COOR,HMI_INVALID_COOR,0,0}; HMI_RECT_STR CONST *pold_page_rect=NULL; HMI_RECT_STR hmi_screen_rect={0,0,HMI_MAX_WIDTH,HMI_MAX_HEIGHT}; #else /*tw*/  HMI_ELEMENT_TYPE element_type=HMI_ELEM_TYPE_SPAGE; BOOLEAN bDrawBck=FALSE; #endif //HMI_RECT_STR hmi_screen_rect={0,0,HMI_MAX_WIDTH,HMI_MAX_HEIGHT}; hmi_driver_woking_status_flag = 0U; #ifdef HMI_GRAPHIC_RGL set_first_draw_all(); #endif  #if HMI_LAYER_0_HIGHEST_PRIORITY > 1 { hmi_layer_highest_active_priority = hmi_highest_active_page_priority; } if(hmi_layer_highest_active_priority < HMI_LAYER_0_HIGHEST_PRIORITY) #endif { #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL) ||defined(HMI_GRAPHIC_ST)) /*support multilanguage*/ #if HMI_DYN_LANGUAGE_NUMBER>0 /*language number >1*/ if((cur_step==HMI_GET_DIRTY_ZONE)&& (HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(HMI_LANGUAGE)!=0U)) { //hmi_set_dirty_zone(&hmi_screen_rect,pdirty_zone); hmi_set_dirty_zone_layer(&hmi_screen_rect,pdirty_zone,HMI_PAGE_ALL_LAYER); HMI_DYNAMIC_OBJECT_CANCEL_CHANGED_FLAG(HMI_LANGUAGE); } else #endif  #endif {  #if HMI_LAYER_0_HIGHEST_PRIORITY > 1  /*if get dirty zone ,search all priority page table.*/ if(cur_step==HMI_GET_DIRTY_ZONE) { hmi_layer_highest_active_priority=HMI_LAYER_0_HIGHEST_PRIORITY-1; } for(hmi_priority_cnt=0U; hmi_priority_cnt <= hmi_layer_highest_active_priority; hmi_priority_cnt++) #endif { #if HMI_LAYER_0_HIGHEST_PRIORITY > 1 HMI_PAGE_ID_STR hmi_page_id = hmi_layer_0_active_page_id[hmi_priority_cnt].new_page; HMI_PAGE_ID_STR hmi_old_page = hmi_layer_0_active_page_id[hmi_priority_cnt].old_page; #else HMI_PAGE_ID_STR hmi_page_id = hmi_layer_0_active_page_id[0].new_page; HMI_PAGE_ID_STR hmi_old_page =hmi_layer_0_active_page_id[0].old_page; #endif HMI_PAGE_TABLE_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_page_info = NULL; #if HMI_DXY_PAGES_NUMBER>0U if(HMI_IS_DXY_PAGE(hmi_page_id)) { if(HMI_IS_VIDEO_DXY_PAGE(hmi_page_id)) { is_video_page=TRUE; phmi_page_info=NULL; if(cur_step==HMI_DRAW_PAGE) { hmi_engine_draw_video(); } } else { phmi_page_rect=&hmi_dxy_page_rect[hmi_page_id]; phmi_page_info = &hmi_dxy_page_table[hmi_page_id]; } #ifdef HMI_GRAPHIC_TWLIB element_type=HMI_ELEM_TYPE_DPAGE; #endif } else #endif #if HMI_SXY_PAGES_NUMBER>0U if(HMI_IS_SXY_PAGE(hmi_page_id))  { if(HMI_IS_VIDEO_SXY_PAGE(hmi_page_id)) { is_video_page=TRUE; phmi_page_info=NULL; if(cur_step==HMI_DRAW_PAGE) { hmi_engine_draw_video(); } } else { hmi_object_index=HMI_GET_PAGE_SXY_ID_INDEX(hmi_page_id); phmi_page_rect=&hmi_sxy_page_rect[hmi_object_index]; phmi_page_info = &hmi_sxy_page_table[hmi_object_index]; } #ifdef HMI_GRAPHIC_TWLIB element_type=HMI_ELEM_TYPE_SPAGE; #endif } else #endif { } #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)|| defined(HMI_GRAPHIC_ST)) if(cur_step==HMI_GET_DIRTY_ZONE) { /*old page rect is dirty zone*/ if(hmi_old_page!=HMI_PAGES_NUMBER) { pold_page_rect=NULL;  #if HMI_DXY_PAGES_NUMBER>0U if(hmi_old_page<HMI_DXY_PAGES_NUMBER) { hmi_old_page=HMI_GET_PAGE_DXY_ID_INDEX(hmi_old_page); pold_page_rect=&hmi_dxy_page_rect[hmi_old_page]; } else #endif #if HMI_SXY_PAGES_NUMBER>0U if(hmi_old_page<HMI_PAGE_SXY_MAX_ID) { hmi_old_page=HMI_GET_PAGE_SXY_ID_INDEX(hmi_old_page); pold_page_rect=&hmi_sxy_page_rect[hmi_old_page]; } else #endif { } hmi_get_intersec_rect((HMI_RECT_STR CONST *)pold_page_rect, (HMI_RECT_STR CONST *)&hmi_screen_rect, &hmi_insec_rect); if((hmi_insec_rect.x!=HMI_INVALID_COOR)&&(hmi_insec_rect.y!=HMI_INVALID_COOR) &&(hmi_insec_rect.w!=0)&&(hmi_insec_rect.h!=0))  { if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_old_page)!=0) { //hmi_set_dirty_zone(&hmi_insec_rect,pdirty_zone);  hmi_set_dirty_zone_layer(&hmi_insec_rect,pdirty_zone, HMI_PAGE_ALL_LAYER);/*all layer is dirty*/ HMI_DYNAMIC_OBJECT_CANCEL_CHANGED_FLAG(hmi_old_page);  } } } } #endif if(phmi_page_info!=NULL)/*current page to be display*/ { if(cur_step==HMI_DRAW_PAGE) { if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_page_id)!=0) { HMI_DYNAMIC_OBJECT_CANCEL_CHANGED_FLAG(hmi_page_id); #ifdef HMI_GRAPHIC_TWLIB bDrawBck=TRUE; #endif } #if defined(HMI_GRAPHIC_TWLIB) else { bDrawBck=FALSE; } #endif #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)|| defined(HMI_GRAPHIC_ST)) hmi_get_intersec_rect((HMI_RECT_STR CONST *)phmi_page_rect,(HMI_RECT_STR CONST *)&hmi_screen_rect,&hmi_union_rect); hmi_engine_draw_container(&phmi_page_info->container,(HMI_RECT_STR CONST *)phmi_page_rect,&hmi_union_rect,pdirty_zone); #else /*tw*/  hmi_engine_draw_container(&phmi_page_info->container, (HMI_RECT_STR CONST *)phmi_page_rect, element_type,hmi_page_id,bDrawBck); #endif } #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)|| defined(HMI_GRAPHIC_ST)) else if(cur_step==HMI_GET_DIRTY_ZONE) { /*new page dirty zone*/  hmi_get_intersec_rect((HMI_RECT_STR CONST *)phmi_page_rect, (HMI_RECT_STR CONST *)&hmi_screen_rect, &hmi_insec_rect); if((hmi_insec_rect.x!=HMI_INVALID_COOR)&&(hmi_insec_rect.y!=HMI_INVALID_COOR)&& (hmi_insec_rect.w!=0)&&(hmi_insec_rect.h!=0))  { if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_page_id)!=0) {  #if HMI_DXY_PAGES_NUMBER>0U if(hmi_page_id<HMI_DXY_PAGES_NUMBER) { /*dyn page dirty zone is buffer rect*/ hmi_set_dirty_zone(&hmi_screen_rect,pdirty_zone); } else #endif #if HMI_SXY_PAGES_NUMBER>0U if(hmi_page_id<HMI_PAGE_SXY_MAX_ID) { /*static page dirty zone is page rect*/ hmi_set_dirty_zone(&hmi_insec_rect,pdirty_zone); } else #endif { } } #if HMI_ALL_DYN_OBJECTS_NUMBER > HMI_PAGES_NUMBER #if (HMI_ENGINE_LOW_PRIOR_PAGE_UPDATA == HMI_UPDATE_BUSY) && (HMI_LAYER_0_HIGHEST_PRIORITY > 1) else if(hmi_priority_cnt >= hmi_highest_active_page_priority) #else else #endif { hmi_engine_check_dynamic_object_changed(&phmi_page_info->container,(HMI_RECT_STR CONST *)phmi_page_rect,&hmi_insec_rect,pdirty_zone); } #if (HMI_ENGINE_LOW_PRIOR_PAGE_UPDATA == HMI_UPDATE_BUSY) && (HMI_LAYER_0_HIGHEST_PRIORITY > 1) else { } #endif #endif } } else {} #endif } } } } if((cur_step==HMI_DRAW_PAGE)&&(!is_video_page)) { #if defined(HMI_GRAPHIC_TWLIB)  call_C_hmi_driver_refresh_LCD(bDrawBck); #else call_C_hmi_driver_refresh_LCD(); #endif } return(hmi_driver_woking_status_flag); } #endif  #ifdef HMI_GRAPHIC_RGL void hmi_engine_draw_page_prop(void) { HMI_PAGE_ID_STR hmi_page_id = 0; UINT8 hmi_page_alpha = 0; #if HMI_LAYER_0_HIGHEST_PRIORITY> 1U UINT8 hmi_priority_cnt = 0U; UINT8 hmi_layer_highest_active_priority = 0U; #endif #if HMI_LAYER_0_HIGHEST_PRIORITY > 1 { hmi_layer_highest_active_priority = hmi_highest_active_page_priority; } if(hmi_layer_highest_active_priority < HMI_LAYER_0_HIGHEST_PRIORITY) #endif {  #if HMI_LAYER_0_HIGHEST_PRIORITY > 1  for(hmi_priority_cnt=0U; hmi_priority_cnt <= hmi_layer_highest_active_priority; hmi_priority_cnt++) #endif {  #if HMI_LAYER_0_HIGHEST_PRIORITY > 1  hmi_page_id = hmi_layer_0_active_page_id[hmi_priority_cnt].new_page;  #else hmi_page_id = hmi_layer_0_active_page_id[0].new_page; #endif #if HMI_DXY_PAGES_NUMBER > 0U if(HMI_IS_DXY_PAGE(hmi_page_id)) { hmi_page_alpha = hmi_dxy_page_rect[hmi_page_id].alpha; } else #endif #if HMI_SXY_PAGES_NUMBER > 0U if(HMI_IS_SXY_PAGE(hmi_page_id))  { hmi_page_alpha = hmi_sxy_page_rect[hmi_page_id].alpha; } else #endif { }  if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_page_id) != 0) {  HMI_DYNAMIC_OBJECT_CANCEL_CHANGED_FLAG(hmi_page_id); hmi_driver_set_page_alpha(hmi_page_alpha); hmi_driver_send_cmdlist(); }  }  } } #endif    /* if layer is void,then disable else enable */ #if 0 BOOLEAN hmi_is_empty_layer(HMI_CONTAINER_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_container_info) { BOOLEAN empty = FALSE; UINT layer_cnt = 0; UINT i = 0; HMI_OBJECT_ID_STR hmi_object_id = 0;  HMI_OBJECT_PROP_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_container_object_table = NULL;  if(phmi_container_info != NULL) { layer_cnt = phmi_container_info->container_object_table.object_number; phmi_container_object_table= phmi_container_info->container_object_table.p_object_table; for(i = 0; i < layer_cnt;i++)/*search every layer--container */ { hmi_object_id = (*phmi_container_object_table++); #if HMI_DXY_CONTAINERS_NUMBER > 0 if(HMI_IS_DYN_XY_CONTAINER(hmi_object_id)) {  hmi_object_id = HMI_GET_DYN_XY_CONTAINER_INDEX(hmi_object_id ); if(hmi_object_id< HMI_DXY_CONTAINERS_NUMBER)  { if(!empty) { empty = hmi_is_empty_layer(&hmi_dyn_xy_container_table[hmi_object_id]);  } }  } else #endif  #if HMI_SXY_CONTAINERS_NUMBER>0 if(HMI_IS_CONTAINERS_SXY(hmi_object_id)) { hmi_object_id = HMI_GET_CONTAINERS_SXY_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_SXY_CONTAINERS_NUMBER) { if(!empty) { empty = hmi_is_empty_layer(&hmi_sxy_container_table[hmi_object_id]);  } } } else #endif #if HMI_DYN_CONTAINERS_NUMBER>0 if(HMI_IS_CONTAINERS_SXY(hmi_object_id))//?? { hmi_object_id = HMI_GET_CONTAINERS_SXY_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_SXY_CONTAINERS_NUMBER) { if(!empty) { empty = hmi_is_empty_layer(&hmi_sxy_container_table[hmi_object_id]); } } } else #endif  { empty = TRUE; } } } } } } #endif  UINT8 hmi_engine_draw_page( #ifndef HMI_GRAPHIC_TWLIB HMI_RECT_STR *pdirty_zone #endif ) {  BOOLEAN is_video_page = FALSE; HMI_RECT_STR hmi_page_rect = {0}; #ifdef HMI_GRAPHIC_RGL UINT8 hmi_page_alpha = 0;  BOOLEAN hmi_page_flag = FALSE; #endif HMI_PAGE_ID_STR hmi_page_id = 0; HMI_PAGE_TABLE_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_page_info = NULL; #if HMI_LAYER_0_HIGHEST_PRIORITY> 1U UINT8 hmi_priority_cnt = 0U; UINT8 hmi_layer_highest_active_priority = 0U; #endif UINT8 hmi_object_index = 0U; #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513))  HMI_RECT_STR hmi_screen_rect = {0,0,HMI_MAX_WIDTH,HMI_MAX_HEIGHT};  #else /*tw*/  HMI_ELEMENT_TYPE element_type = HMI_ELEM_TYPE_SPAGE; BOOLEAN bDrawBck = FALSE; BOOLEAN exist_group_a = FALSE; #endif   #if HMI_LAYER_0_HIGHEST_PRIORITY > 1 { hmi_layer_highest_active_priority = hmi_highest_active_page_priority; } if(hmi_layer_highest_active_priority < HMI_LAYER_0_HIGHEST_PRIORITY) #endif {   #if HMI_LAYER_0_HIGHEST_PRIORITY > 1  for(hmi_priority_cnt=0U; hmi_priority_cnt <= hmi_layer_highest_active_priority; hmi_priority_cnt++) #endif {  #if HMI_LAYER_0_HIGHEST_PRIORITY > 1  hmi_page_id = hmi_layer_0_active_page_id[hmi_priority_cnt].new_page;  #else hmi_page_id = hmi_layer_0_active_page_id[0].new_page;  #endif #if HMI_DXY_PAGES_NUMBER>0U if(HMI_IS_DXY_PAGE(hmi_page_id)) { if(HMI_IS_VIDEO_DXY_PAGE(hmi_page_id)) { is_video_page=TRUE; phmi_page_info=NULL;  #ifndef HMI_GRAPHIC_RGL #if HMI_VDXY_PAGES_NUMBER+HMI_VSXY_PAGES_NUMBER > 0 hmi_engine_draw_video(hmi_page_id,TRUE); #endif #endif  } else { phmi_page_info = &hmi_dxy_page_table[hmi_page_id]; hmi_page_rect.x = hmi_dxy_page_rect[hmi_page_id].x; hmi_page_rect.y = hmi_dxy_page_rect[hmi_page_id].y; hmi_page_rect.w = hmi_dxy_page_rect[hmi_page_id].w; hmi_page_rect.h = hmi_dxy_page_rect[hmi_page_id].h; #ifdef HMI_GRAPHIC_RGL hmi_page_alpha = hmi_dxy_page_rect[hmi_page_id].alpha; #endif  hmi_dxy_page_rect_bck[hmi_page_id].x = hmi_page_rect.x; hmi_dxy_page_rect_bck[hmi_page_id].y = hmi_page_rect.y; hmi_dxy_page_rect_bck[hmi_page_id].w = hmi_page_rect.w; hmi_dxy_page_rect_bck[hmi_page_id].h = hmi_page_rect.h; } #ifdef HMI_GRAPHIC_TWLIB element_type=HMI_ELEM_TYPE_DPAGE; #endif } else #endif #if HMI_SXY_PAGES_NUMBER>0U if(HMI_IS_SXY_PAGE(hmi_page_id))  { if(HMI_IS_VIDEO_SXY_PAGE(hmi_page_id)) { is_video_page = TRUE; phmi_page_info = NULL;  #ifndef HMI_GRAPHIC_RGL #if HMI_VDXY_PAGES_NUMBER+HMI_VSXY_PAGES_NUMBER > 0 hmi_engine_draw_video(hmi_page_id,FALSE);  #endif #endif } else { hmi_object_index=HMI_GET_PAGE_SXY_ID_INDEX(hmi_page_id); phmi_page_info = &hmi_sxy_page_table[hmi_object_index]; hmi_page_rect.x = hmi_sxy_page_rect[hmi_object_index].x; hmi_page_rect.y = hmi_sxy_page_rect[hmi_object_index].y; hmi_page_rect.w = hmi_sxy_page_rect[hmi_object_index].w; hmi_page_rect.h = hmi_sxy_page_rect[hmi_object_index].h; #ifdef HMI_GRAPHIC_RGL hmi_page_alpha = hmi_sxy_page_rect[hmi_object_index].alpha; #endif } #ifdef HMI_GRAPHIC_TWLIB element_type=HMI_ELEM_TYPE_SPAGE; #endif } else #endif { }  if(phmi_page_info != NULL)/*current page to be display*/ {  if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_page_id) != 0) { hmi_page_flag = TRUE; #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513))  HMI_DYNAMIC_OBJECT_CANCEL_CHANGED_FLAG(hmi_page_id); #else /*tw8836*/ bDrawBck=TRUE; #if HMI_RENDER_ALL_EXCEPT_BCK==NO if(hmi_is_render_mode()) { HMI_DYNAMIC_OBJECT_CANCEL_CHANGED_FLAG(hmi_page_id); } #endif #endif } #if defined(HMI_GRAPHIC_TWLIB) else { bDrawBck=FALSE; } #endif #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)|| \ defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513))  #ifdef HMI_GRAPHIC_RGL if((HMI_GFX_GET_STATUS(HMI_RGL_PROP_EVENT))|| (hmi_page_flag == TRUE)) { hmi_driver_set_page_alpha(hmi_page_alpha); } #endif  #if 0 hmi_engine_draw_container(&(phmi_page_info->container)/*node list*/, (HMI_RECT_STR CONST *)(&hmi_page_rect)/*father zone*/, /*(HMI_RECT_STR CONST *)phmi_page_rect,*/ pdirty_zone,HMI_PAGE_BEGIN_DEPTH, &hmi_screen_rect #if(defined(HMI_GRAPHIC_RGL)) ,255 #endif ); #endif #if 1 hmi_engine_draw_object(&(phmi_page_info->container.container_object_table.p_object_table[2]),(HMI_RECT_STR CONST *)(&hmi_page_rect), pdirty_zone, 2, &hmi_screen_rect  #if(defined(HMI_GRAPHIC_RGL))  ,255  #endif );    hmi_engine_draw_object(&(phmi_page_info->container.container_object_table.p_object_table[3]),(HMI_RECT_STR CONST *)(&hmi_page_rect),  pdirty_zone, 3,  &hmi_screen_rect  #if(defined(HMI_GRAPHIC_RGL))  ,255  #endif  );  hmi_engine_draw_object(&(phmi_page_info->container.container_object_table.p_object_table[1]),(HMI_RECT_STR CONST *)(&hmi_page_rect),  pdirty_zone,  1,  &hmi_screen_rect  #if(defined(HMI_GRAPHIC_RGL))  ,255  #endif  );   hmi_engine_draw_object(&(phmi_page_info->container.container_object_table.p_object_table[0]),(HMI_RECT_STR CONST *)(&hmi_page_rect),  pdirty_zone,  0,  &hmi_screen_rect  #if(defined(HMI_GRAPHIC_RGL))  ,255  #endif );   #endif  #else /*tw8836*/   #if HMI_RENDER_ALL_EXCEPT_BCK==YES if(bDrawBck)/*draw a page*/ { clear_osdwin_fontwin_status(FALSE/*no off win*/); /*draw new page before,clear window status*/  } else { clear_osdwin_not_include_bck_status(FALSE/*no operation win*/);/*refresh page*/ } HMI_wait_v_blank(1);  hmi_engine_draw_container(&phmi_page_info->container, (HMI_RECT_STR CONST *)(&hmi_page_rect), element_type,hmi_page_id,bDrawBck); hmi_off_all_free_win();/*off free window*/ #else /*only draw set flag element*/ if(hmi_is_render_mode()) { HMI_wait_v_blank(1);  #ifdef HMI_MUL_PALLETE_ENABLE #if HMI_SXY_PAGES_NUMBER>0U if(HMI_IS_SXY_PAGE(hmi_page_id))  { hmi_object_index = HMI_GET_PAGE_SXY_ID_INDEX(hmi_page_id); if((hmi_object_index < HMI_SXY_PAGES_NUMBER)) {  hmi_load_one_page_pallete(&hmi_sxy_page_pallete_table[hmi_object_index]); if(hmi_sxy_page_a_table[hmi_object_index] == HMI_NB_ELEMENTS) { exist_group_a = FALSE; } else { exist_group_a = TRUE; } hmi_set_groupA_mode(exist_group_a); } } #endif #if HMI_DXY_PAGES_NUMBER>0U if(HMI_IS_DXY_PAGE(hmi_page_id))  { hmi_object_index = HMI_GET_PAGE_DXY_ID_INDEX(hmi_page_id); if(hmi_object_index < HMI_DXY_PAGES_NUMBER) { hmi_load_one_page_pallete(&hmi_dxy_page_pallete_table[hmi_object_index]); if(hmi_dxy_page_a_table[hmi_object_index] == HMI_NB_ELEMENTS) { exist_group_a = FALSE; } else { exist_group_a = TRUE; } hmi_set_groupA_mode(exist_group_a); } } #endif  #endif hmi_engine_draw_container(&phmi_page_info->container, (HMI_RECT_STR CONST *)(&hmi_page_rect), element_type,hmi_page_id, TRUE/*bDrawBck*/ #if HMI_RENDER_ALL_EXCEPT_BCK==NO ,HMI_NB_ELEMENTS/*no parent*/ ,!bDrawBck/*draw all element*/ #endif ); } else/*simulate*/ { if(bDrawBck)/*draw a new page*/ { hmi_clear_no_all_win(); } else/*refresh a page.find not used win*/ { hmi_engine_draw_container(&phmi_page_info->container, (HMI_RECT_STR CONST *)(&hmi_page_rect), element_type,hmi_page_id, TRUE/*bDrawBck*/ #if HMI_RENDER_ALL_EXCEPT_BCK==NO ,HMI_NB_ELEMENTS/*no parent*/ ,FALSE/*search all element*/ #endif ); } }  #endif #endif  } else /*no page to be display*/ { #ifdef HMI_GRAPHIC_TWLIB /*close all win*/ #if HMI_RENDER_ALL_EXCEPT_BCK==YES clear_osdwin_fontwin_status(FALSE/*no off win*/); /*draw new page before,clear window status*/ hmi_off_all_free_win();/*off free window*/ #else /**/  #endif #endif } }  } if(!is_video_page) { #if defined(HMI_GRAPHIC_TWLIB)  call_C_hmi_driver_refresh_LCD(bDrawBck); #elif defined(HMI_GRAPHIC_RGL) call_C_hmi_driver_refresh_LCD(pdirty_zone); #else call_C_hmi_driver_refresh_LCD(0); #endif } return(hmi_driver_woking_status_flag); } #endif   #if (HMI_DYN_CONTAINERS_NUMBER > 0) && (HMI_ALL_STATIC_CONTAINERS_NUMBER > 0) static BOOLEAN hmi_engine_get_static_container_id(HMI_OBJECT_ID_STR hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_dyn_contain_id/*dyn container index*/) { BOOLEAN hmi_changed_flag = FALSE; UINT8 loop = 0;  if((*phmi_dyn_contain_id) < HMI_DYN_CONTAINERS_NUMBER) { *phmi_dyn_contain_id = hmi_dyn_container_table[*phmi_dyn_contain_id]; while((HMI_IS_DYN_CONTAINER(*phmi_dyn_contain_id))&& (loop < HMI_DYN_CONTAINER_NESTED_DEPTH)) { *phmi_dyn_contain_id = HMI_GET_DYN_CONTAINERS_ID_INDEX(*phmi_dyn_contain_id); if((*phmi_dyn_contain_id) < HMI_DYN_CONTAINERS_NUMBER) { *phmi_dyn_contain_id = hmi_dyn_container_table[*phmi_dyn_contain_id]; }/*lq 2017.6.12*/ else { loop = HMI_DYN_CONTAINER_NESTED_DEPTH;/*end loop*/ } loop++; } if(loop < HMI_DYN_CONTAINER_NESTED_DEPTH) { hmi_changed_flag = TRUE; } else { *phmi_dyn_contain_id = HMI_NB_ELEMENTS; HMI_GFX_SET_STATUS(HMI_DYN_CONTAINER_NESTED); } }/*lq 2017.6.12*/  return(hmi_changed_flag); } #endif   typedef enum { HMI_OLD_TREE, HMI_OLD_NEW_TREE, HMI_NEW_TREE, /*CNT*/ HMI_SEARCH_TREE_CNT }HMI_SEARCH_DIRTY_MODE;  #if HMI_ALL_DYN_OBJECTS_NUMBER > HMI_PAGES_NUMBER #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513)) static UINT8 hmi_engine_check_dynamic_object_changed( HMI_CONTAINER_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_container_info, HMI_RECT_STR CONST *pfarther_rect,  HMI_RECT_STR *pdirty_rect, U08 depth, HMI_RECT_STR *pcliped_farther_rect ) { UINT8 hmi_number_object = phmi_container_info->container_object_table.object_number; UINT8 hmi_number_object_const = hmi_number_object; UINT8 hmi_page_redrawed_flag = FALSE; UINT8 hmi_object_dirty_flag = FALSE; U08 hmi_depth = depth; //HMI_RECT_STR *pold_dirty = NULL;  HMI_OBJECT_PROP_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_container_object_table = phmi_container_info->container_object_table.p_object_table; HMI_OBJECT_ID_STR hmi_object_id = 0U; HMI_OBJECT_ID_STR hmi_object_index = 0U; HMI_OBJECT_ID_STR hmi_object_index2 = 0U; HMI_OBJECT_ID_STR hmi_check_index = 0U; HMI_RECT_STR hmi_node_screen_rect = {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0};  HMI_RECT_STR hmi_insect_rect = {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0}; HMI_OBJECT_PROP_STR hmi_trail_object[1] = {0}; HMI_CONTAINER_STR hmi_trail_container = {{0,NULL}}; HMI_RECT_STR hmi_rect_temp = {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0}; #if HMI_DXY_BITMAPS_NUMBER > 0 HMI_RECT_STR rotation_rect = {0}; HMI_ROTATION_STR rotation = {0,0}; HMI_ROTATION_STR rotation_old = {0,0}; HMI_RECT_STR hmi_node_screen_rect_old = {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0}; float_32 angle_dt = 0; #endif #ifdef HMI_GRAPHIC_RGL while(hmi_number_object > 0U) #else while((hmi_number_object > 0U) && (hmi_page_redrawed_flag == FALSE)) #endif { if(hmi_depth == HMI_PAGE_BEGIN_DEPTH)/*search tree from page node*/ { depth = (hmi_number_object_const-hmi_number_object);/*node of page NO*/ } hmi_object_id = phmi_container_object_table[hmi_check_index].object_id; #if HMI_DXY_IMAGELIST_NUMBER > 0 if(hmi_object_id < HMI_DYN_IMAGELIST_DXY_MAX_ID) { hmi_object_index = HMI_GET_DYN_IMAGELIST_DXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_DXY_IMAGELIST_NUMBER) { hmi_rect_temp.x = hmi_dxy_imagelist_rect[hmi_object_index].x; hmi_rect_temp.y = hmi_dxy_imagelist_rect[hmi_object_index].y; hmi_rect_temp.w = hmi_dxy_imagelist_rect[hmi_object_index].w; hmi_rect_temp.h = hmi_dxy_imagelist_rect[hmi_object_index].h; HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_rect_temp), (&hmi_node_screen_rect));  } hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_insect_rect);  if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_object_id) != 0) {  hmi_set_dirty_zone_layer(&hmi_insect_rect, pdirty_rect,depth); /*add old dirty */ HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_dxy_imagelist_rect_bck[hmi_object_index]), (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_insect_rect); hmi_set_dirty_zone_layer(&hmi_insect_rect, pdirty_rect,depth);  //hmi_page_redrawed_flag = TRUE; hmi_object_dirty_flag = TRUE; } else { if(hmi_object_index < HMI_DXY_IMAGELIST_NUMBER) { hmi_object_dirty_flag = hmi_engine_check_dynamic_object_changed( &hmi_dxy_imagelist_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect),  pdirty_rect, depth, &hmi_insect_rect);  } } } else #endif #if HMI_SXY_IMAGELIST_NUMBER>0 if(hmi_object_id < HMI_DYN_IMAGELIST_SXY_MAX_ID) { hmi_object_index = HMI_GET_DYN_IMAGELIST_SXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_SXY_IMAGELIST_NUMBER) { hmi_rect_temp.x = hmi_sxy_imagelist_rect[hmi_object_index].x; hmi_rect_temp.y = hmi_sxy_imagelist_rect[hmi_object_index].y; hmi_rect_temp.w = hmi_sxy_imagelist_rect[hmi_object_index].w; hmi_rect_temp.h = hmi_sxy_imagelist_rect[hmi_object_index].h; HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_rect_temp), (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_insect_rect); } if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_object_id) != 0) {  hmi_set_dirty_zone_layer((HMI_RECT_STR *)(&hmi_insect_rect), pdirty_rect,depth); /*hmi_page_redrawed_flag = TRUE;*/ hmi_object_dirty_flag = TRUE; } else {  if(hmi_object_index < HMI_SXY_IMAGELIST_NUMBER) { hmi_object_dirty_flag = hmi_engine_check_dynamic_object_changed( &hmi_sxy_imagelist_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect),  pdirty_rect, depth, &hmi_insect_rect); } } } else #endif #if HMI_DXY_SCROLLBAR_NUMBER>0 if(hmi_object_id < HMI_DYN_SCROLLBAR_DXY_MAX_ID) { hmi_object_index = HMI_GET_DYN_SCROLLBAR_DXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_DXY_SCROLLBAR_NUMBER) { hmi_rect_temp.x = hmi_dxy_scrollbar_rect[hmi_object_index].x; hmi_rect_temp.y = hmi_dxy_scrollbar_rect[hmi_object_index].y; hmi_rect_temp.w = hmi_dxy_scrollbar_rect[hmi_object_index].w; hmi_rect_temp.h = hmi_dxy_scrollbar_rect[hmi_object_index].h; HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_rect_temp), (&hmi_node_screen_rect));  hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect,&hmi_insect_rect); } if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_object_id) != 0) { hmi_set_dirty_zone_layer(&hmi_node_screen_rect, pdirty_rect,depth);  /*add old dirty*/ if(hmi_object_index < HMI_DXY_SCROLLBAR_NUMBER) { HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_dxy_scrollbar_rect_bck[hmi_object_index]), (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_insect_rect); hmi_set_dirty_zone_layer(&hmi_insect_rect, pdirty_rect,depth); }  hmi_object_dirty_flag = TRUE;  //hmi_page_redrawed_flag = TRUE; } else {  if(hmi_object_index < HMI_DXY_SCROLLBAR_NUMBER) { hmi_object_dirty_flag=hmi_engine_check_dynamic_object_changed( &hmi_dxy_scrollbar_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect),  pdirty_rect, depth, &hmi_insect_rect); } } } else #endif #if HMI_SXY_SCROLLBAR_NUMBER>0 if(hmi_object_id < HMI_DYN_SCROLLBAR_SXY_MAX_ID) { hmi_object_index = HMI_GET_DYN_SCROLLBAR_SXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_SXY_SCROLLBAR_NUMBER) { hmi_rect_temp.x = hmi_sxy_scrollbar_rect[hmi_object_index].x; hmi_rect_temp.y = hmi_sxy_scrollbar_rect[hmi_object_index].y; hmi_rect_temp.w = hmi_sxy_scrollbar_rect[hmi_object_index].w; hmi_rect_temp.h = hmi_sxy_scrollbar_rect[hmi_object_index].h; HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_rect_temp), (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect,&hmi_insect_rect); } if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_object_id) != 0) { hmi_set_dirty_zone_layer(&hmi_insect_rect,pdirty_rect,depth);  /*hmi_page_redrawed_flag = TRUE;*/ hmi_object_dirty_flag=TRUE; } else { if(hmi_object_index < HMI_SXY_SCROLLBAR_NUMBER) { hmi_object_dirty_flag=hmi_engine_check_dynamic_object_changed( &hmi_sxy_scrollbar_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect),  pdirty_rect, depth, &hmi_insect_rect); } } } else #endif #if HMI_DXY_BUTTON_NUMBER>0 if(hmi_object_id < HMI_DYN_BUTTON_DXY_MAX_ID) { hmi_object_index = HMI_GET_DYN_BUTTON_DXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_DXY_BUTTON_NUMBER) {  hmi_rect_temp.x = hmi_dxy_button_rect[hmi_object_index].x; hmi_rect_temp.y = hmi_dxy_button_rect[hmi_object_index].y; hmi_rect_temp.w = hmi_dxy_button_rect[hmi_object_index].w; hmi_rect_temp.h = hmi_dxy_button_rect[hmi_object_index].h; HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_rect_temp), (&hmi_node_screen_rect));  hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_insect_rect); } if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_object_id) != 0) { hmi_set_dirty_zone_layer((HMI_RECT_STR *)(&hmi_insect_rect), pdirty_rect,depth); /*add old dirty*/ if(hmi_object_index < HMI_DXY_BUTTON_NUMBER) { HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_dxy_button_rect_bck[hmi_object_index]), (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_insect_rect); hmi_set_dirty_zone_layer(&hmi_insect_rect, pdirty_rect,depth); //hmi_page_redrawed_flag = TRUE; } hmi_object_dirty_flag = TRUE; } else {  if(hmi_object_index < HMI_DXY_BUTTON_NUMBER) { hmi_object_dirty_flag=hmi_engine_check_dynamic_object_changed( &hmi_dxy_button_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect, depth, &hmi_insect_rect);  } } } else #endif #if HMI_SXY_BUTTON_NUMBER>0 if(hmi_object_id < HMI_DYN_BUTTON_SXY_MAX_ID) { hmi_object_index = HMI_GET_DYN_BUTTON_SXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_SXY_BUTTON_NUMBER) { hmi_rect_temp.x = hmi_sxy_button_rect[hmi_object_index].x; hmi_rect_temp.y = hmi_sxy_button_rect[hmi_object_index].y; hmi_rect_temp.w = hmi_sxy_button_rect[hmi_object_index].w; hmi_rect_temp.h = hmi_sxy_button_rect[hmi_object_index].h; HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_rect_temp), (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect,&hmi_insect_rect); } if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_object_id) != 0) { hmi_set_dirty_zone_layer(&hmi_insect_rect,pdirty_rect,depth);  /*hmi_page_redrawed_flag = TRUE;*/ hmi_object_dirty_flag=TRUE; } else { if(hmi_object_index < HMI_SXY_BUTTON_NUMBER) { hmi_object_dirty_flag=hmi_engine_check_dynamic_object_changed( &hmi_sxy_button_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect, depth, &hmi_insect_rect); } } } else #endif #if HMI_DYN_EDIT_TEXTS_NUMBER/*editable text*/ > 0  if(hmi_object_id < HMI_DYN_TEXTS_MAX_ID) {  #if HMI_DYN_XY_EDIT_TEXTS_NUMBER > 0 if(HMI_IS_DYN_TEXT_DXY(hmi_object_id)) { if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_object_id) != 0) { hmi_object_index = HMI_GET_DYN_TEXTS_DXY_POS_INDEX(hmi_object_id); if(hmi_object_index < HMI_DYN_XY_EDIT_TEXTS_NUMBER) {  HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&(hmi_dyn_xy_edit_text_prop_table[hmi_object_index].text_rect)), (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_insect_rect);  hmi_set_dirty_zone_layer((&hmi_insect_rect), pdirty_rect,depth);  /*add old dirty*/ HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_dyn_xy_edit_text_prop_table_bck[hmi_object_index]), (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_insect_rect); hmi_set_dirty_zone_layer((&hmi_insect_rect), pdirty_rect,depth); //hmi_page_redrawed_flag = TRUE;  hmi_object_dirty_flag = TRUE; }  } else { #if HMI_TEXT_MAX_SON_CNT > 0 hmi_object_index = HMI_GET_DYN_TEXTS_DXY_POS_INDEX(hmi_object_id); if(hmi_object_index < HMI_DYN_XY_EDIT_TEXTS_NUMBER) { HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&(hmi_dyn_xy_edit_text_prop_table[hmi_object_index].text_rect)), (&hmi_node_screen_rect));  hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect,&hmi_insect_rect); hmi_object_index = HMI_GET_DYN_TEXTS_INDEX(hmi_object_id);/*all editable text container info at one array*/ if(hmi_object_index < HMI_DYN_EDIT_TEXTS_NUMBER) { hmi_object_dirty_flag=hmi_engine_check_dynamic_object_changed( &hmi_edit_text_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect, depth,&hmi_insect_rect); }  } #else hmi_object_dirty_flag = FALSE; #endif }  } else #endif #if HMI_S_XY_EDIT_TEXTS_NUMBER > 0 if(HMI_IS_DYN_TEXT_SXY(hmi_object_id)) { #if HMI_S_XY_EDIT_TEXTS_NUMBER > 0  hmi_object_index = HMI_GET_DYN_TEXTS_SXY_POS_INDEX(hmi_object_id); if(hmi_object_index < HMI_S_XY_EDIT_TEXTS_NUMBER) { HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&(hmi_static_xy_edit_text_prop_table[hmi_object_index].text_rect)), (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_insect_rect); }  #endif if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_object_id) != 0) { hmi_set_dirty_zone_layer(&hmi_insect_rect, pdirty_rect,depth);  /*hmi_page_redrawed_flag = TRUE;*/ hmi_object_dirty_flag = TRUE; } else { #if HMI_DYN_EDIT_TEXTS_NUMBER > 0  #if HMI_TEXT_MAX_SON_CNT > 0 hmi_object_index = HMI_GET_DYN_TEXTS_INDEX(hmi_object_id);  if(hmi_object_index < HMI_DYN_EDIT_TEXTS_NUMBER) { hmi_object_dirty_flag=hmi_engine_check_dynamic_object_changed( &hmi_edit_text_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect,depth, &hmi_insect_rect); } #else hmi_object_dirty_flag = FALSE; #endif #endif } } else #endif { }  } else #endif #if HMI_DYN_CONTAINERS_NUMBER/*dyn container*/ > 0  if(hmi_object_id < HMI_DYN_CONTAINERS_MAX_ID) { #if HMI_ALL_STATIC_CONTAINERS_NUMBER > 0  if(hmi_engine_check_container_changed(hmi_object_id, (HMI_RECT_STR CONST *)pfarther_rect, pdirty_rect,depth, pcliped_farther_rect) != FALSE) { //hmi_page_redrawed_flag = TRUE; hmi_object_dirty_flag = TRUE; }  #endif } else #endif #if HMI_DYN_FILL_PAGES_NUMBER > 0 if(hmi_object_id < HMI_DYN_NFILL_MAX_ID) { hmi_object_index = HMI_GET_DYN_NFILL_INDEX(hmi_object_id); if(hmi_object_index < HMI_DYN_FILL_PAGES_NUMBER) { hmi_rect_temp.x = hmi_fills_dyn_xy_rect[hmi_object_index].x; hmi_rect_temp.y = hmi_fills_dyn_xy_rect[hmi_object_index].y; hmi_rect_temp.w = hmi_fills_dyn_xy_rect[hmi_object_index].w; hmi_rect_temp.h = hmi_fills_dyn_xy_rect[hmi_object_index].h; HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_rect_temp), (&hmi_node_screen_rect));  hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_insect_rect); } if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_object_id) != 0) { hmi_set_dirty_zone_layer(&hmi_insect_rect, pdirty_rect,depth);  /*add old dirty*/ HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_fills_dyn_xy_rect_bck[hmi_object_index]), (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_insect_rect); hmi_set_dirty_zone_layer(&hmi_insect_rect, pdirty_rect,depth);  //hmi_page_redrawed_flag = TRUE;  hmi_object_dirty_flag = TRUE; } else { if(hmi_object_index < HMI_DYN_FILL_PAGES_NUMBER) { hmi_object_dirty_flag=hmi_engine_check_dynamic_object_changed( &hmi_dyn_fill_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect, depth,&hmi_insect_rect);  } } } else #endif #if HMI_DYN_GFILL_NUMBER > 0 if(hmi_object_id < HMI_DYN_GFILL_MAX_ID) { hmi_object_index = HMI_GET_DYN_GFILL_INDEX(hmi_object_id); if(hmi_object_index < HMI_DYN_GFILL_NUMBER) { hmi_rect_temp.x = hmi_gradient_dxy_fill_rect[hmi_object_index].x; hmi_rect_temp.y = hmi_gradient_dxy_fill_rect[hmi_object_index].y; hmi_rect_temp.w = hmi_gradient_dxy_fill_rect[hmi_object_index].w; hmi_rect_temp.h = hmi_gradient_dxy_fill_rect[hmi_object_index].h; HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_rect_temp), (&hmi_node_screen_rect));  hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect,&hmi_insect_rect); } if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_object_id) != 0) { hmi_set_dirty_zone_layer(&hmi_insect_rect, pdirty_rect,depth);  HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_gradient_dxy_fill_rect_bck[hmi_object_index]), (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_insect_rect); hmi_set_dirty_zone_layer(&hmi_insect_rect, pdirty_rect,depth); //hmi_page_redrawed_flag = TRUE;  hmi_object_dirty_flag = TRUE; } else { if(hmi_object_index < HMI_DYN_GFILL_NUMBER) { hmi_object_dirty_flag=hmi_engine_check_dynamic_object_changed( &hmi_dyn_gfill_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect, depth,&hmi_insect_rect); } } } else #endif #if HMI_DXY_CUBE_NUMBER > 0 if(hmi_object_id < HMI_DYN_CUBE_MAX_ID) { hmi_object_index = HMI_GET_DYN_CUBE_INDEX(hmi_object_id); if(hmi_object_index < HMI_DXY_CUBE_NUMBER) {  HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_cubes_dyn_xy_rect[hmi_object_index].cube_rect), (&hmi_node_screen_rect));  hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect,&hmi_insect_rect); } if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_object_id) != 0)/*if cube rect changed ,should be refresh cube father rect*/ { hmi_set_dirty_zone_layer(pcliped_farther_rect, pdirty_rect,depth); #if 0 /*add old dirty*/ HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_cubes_dyn_xy_rect_bck[hmi_object_index]), (&hmi_node_screen_rect));  hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect,&hmi_insect_rect); hmi_set_dirty_zone_layer(&hmi_insect_rect, pdirty_rect,depth); #endif //hmi_page_redrawed_flag = TRUE;  hmi_object_dirty_flag = TRUE; } else { if(hmi_object_index < HMI_DXY_CUBE_NUMBER) { hmi_object_dirty_flag=hmi_engine_check_dynamic_object_changed( &hmi_cubes_dyn_xy_face[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect, depth,&hmi_insect_rect);  if(hmi_object_dirty_flag == TRUE)/*if cube face changed ,cube should be change*/ { hmi_set_dirty_zone_layer((HMI_RECT_STR *)pcliped_farther_rect, pdirty_rect,depth); } } }  } else  #endif #if HMI_DXY_CONTAINERS_NUMBER > 0U  if(hmi_object_id < HMI_DYN_XY_CONTAINER_MAX_ID) { if(hmi_engine_check_container_changed(hmi_object_id, (HMI_RECT_STR CONST *)pfarther_rect, pdirty_rect,depth, pcliped_farther_rect) != FALSE) { hmi_object_dirty_flag = TRUE; } } else #endif #if HMI_DXY_BITMAPS_NUMBER > 0 if(hmi_object_id < HMI_DYN_XY_BITMAP_MAX_ID) { hmi_object_index = HMI_GET_DYN_XY_BITMAP_INDEX(hmi_object_id); if(hmi_object_index < HMI_DXY_BITMAPS_NUMBER) {  hmi_rect_temp.x = hmi_bmp_dyn_xy_rect[hmi_object_index].x; hmi_rect_temp.y = hmi_bmp_dyn_xy_rect[hmi_object_index].y; hmi_rect_temp.w = hmi_bmp_dyn_xy_rect[hmi_object_index].w; hmi_rect_temp.h = hmi_bmp_dyn_xy_rect[hmi_object_index].h;  HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_rect_temp), (&hmi_node_screen_rect)); angle_dt = fabs(hmi_bmp_dyn_xy_rect[hmi_object_index].angel- hmi_bmp_dyn_angel_bck[hmi_object_index]); if(angle_dt > HMI_FLOAT_TOLERANCE) { hmi_rect_temp.x = hmi_bmp_dyn_xy_rect_bck[hmi_object_index].x; hmi_rect_temp.y = hmi_bmp_dyn_xy_rect_bck[hmi_object_index].y; hmi_rect_temp.w = hmi_bmp_dyn_xy_rect_bck[hmi_object_index].w; hmi_rect_temp.h = hmi_bmp_dyn_xy_rect_bck[hmi_object_index].h;  HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_rect_temp), (&hmi_node_screen_rect_old)); #if HMI_DXY_ROTATION_BITMAPS_NUMBER > 0  if(hmi_object_index >= HMI_DXY_CENTER_BITMAPS_NUMBER)/*rotation user define */ {  hmi_object_index2 = hmi_object_index-HMI_DXY_CENTER_BITMAPS_NUMBER; if(hmi_object_index2 < HMI_DXY_ROTATION_BITMAPS_NUMBER) { HMI_GET_OBJECT_SCREEN_COOR2(pfarther_rect, (&hmi_dxy_bitmap_rotation[hmi_object_index2]), (&rotation)); hmi_get_rotation_pointer_dirty(&hmi_node_screen_rect, &hmi_node_screen_rect_old, &rotation,&rotation, hmi_bmp_dyn_xy_rect[hmi_object_index].angel, hmi_bmp_dyn_angel_bck[hmi_object_index], &rotation_rect, hmi_dxy_bitmap_rotation_trail[hmi_object_index2].trail_en, pcliped_farther_rect); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&rotation_rect), (HMI_RECT_STR CONST *)(pcliped_farther_rect),&hmi_insect_rect); } } else/*rotation center*/ #endif {  rotation.x = hmi_node_screen_rect.x + (hmi_node_screen_rect.w>>1)/*/2*/;  rotation.y = hmi_node_screen_rect.y + (hmi_node_screen_rect.h>>1)/*/2*/;  rotation_old.x = hmi_node_screen_rect_old.x + (hmi_node_screen_rect_old.w>>1); rotation_old.y = hmi_node_screen_rect_old.y + (hmi_node_screen_rect_old.h>>1);  hmi_get_rotation_pointer_dirty(&hmi_node_screen_rect, &hmi_node_screen_rect_old, &rotation,&rotation_old, hmi_bmp_dyn_xy_rect[hmi_object_index].angel, hmi_bmp_dyn_angel_bck[hmi_object_index],&rotation_rect, FALSE, pcliped_farther_rect); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&rotation_rect), (HMI_RECT_STR CONST *)(pcliped_farther_rect),&hmi_insect_rect);  } } else /*old angle == new angle*/ { hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)(pcliped_farther_rect),&hmi_insect_rect); } } if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_object_id) != 0) { if(angle_dt > HMI_FLOAT_TOLERANCE) { #if HMI_DXY_ROTATION_BITMAPS_NUMBER > 0  if(hmi_object_index >= HMI_DXY_CENTER_BITMAPS_NUMBER)/*user define pointer*/ { hmi_object_index2 = hmi_object_index-HMI_DXY_CENTER_BITMAPS_NUMBER; if(hmi_object_index2 < HMI_DXY_ROTATION_BITMAPS_NUMBER) { hmi_trail_object[0].object_id = hmi_dxy_bitmap_rotation_trail[hmi_object_index2].texture; hmi_trail_container.container_object_table.object_number = 1; hmi_trail_container.container_object_table.p_object_table = hmi_trail_object;  hmi_object_dirty_flag = hmi_engine_check_dynamic_object_changed( &hmi_trail_container, (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect, depth, &hmi_insect_rect); if(hmi_object_dirty_flag == TRUE) { hmi_set_dirty_zone_layer((HMI_RECT_STR *)pcliped_farther_rect/*trial image dirty zone is father zone*/, pdirty_rect,depth);   hmi_object_dirty_flag = TRUE;  } else { hmi_set_dirty_zone_layer((HMI_RECT_STR *)&hmi_insect_rect, pdirty_rect,depth);  hmi_page_redrawed_flag = TRUE; } } } else #endif { hmi_set_dirty_zone_layer((HMI_RECT_STR *)&hmi_insect_rect, pdirty_rect,depth); hmi_page_redrawed_flag = TRUE; }  } else /*old angle == new angle*/ { hmi_set_dirty_zone_layer(&hmi_insect_rect, pdirty_rect,depth); /*add old dirty zone*/ hmi_rect_temp.x = hmi_bmp_dyn_xy_rect_bck[hmi_object_index].x; hmi_rect_temp.y = hmi_bmp_dyn_xy_rect_bck[hmi_object_index].y; hmi_rect_temp.w = hmi_bmp_dyn_xy_rect_bck[hmi_object_index].w; hmi_rect_temp.h = hmi_bmp_dyn_xy_rect_bck[hmi_object_index].h;  HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_rect_temp), (&hmi_node_screen_rect));  hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)(pcliped_farther_rect),&hmi_insect_rect); hmi_set_dirty_zone_layer(&hmi_insect_rect, pdirty_rect,depth); //hmi_page_redrawed_flag = TRUE; hmi_object_dirty_flag = TRUE; } //hmi_object_dirty_flag = TRUE; } else/*no set flag*/ {  if(hmi_object_index < HMI_DXY_BITMAPS_NUMBER) {  hmi_object_dirty_flag = hmi_engine_check_dynamic_object_changed( &hmi_dxy_bitmap_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect, depth,&hmi_insect_rect);  /*trail*/  if(hmi_object_index >= HMI_DXY_CENTER_BITMAPS_NUMBER)/*rotation center*/ {  #if HMI_DXY_ROTATION_BITMAPS_NUMBER > 0  hmi_object_index2 = hmi_object_index-HMI_DXY_CENTER_BITMAPS_NUMBER; if(hmi_object_index2 < HMI_DXY_ROTATION_BITMAPS_NUMBER) { if(hmi_dxy_bitmap_rotation_trail[hmi_object_index2].trail_en ==TRUE) { hmi_trail_object[0].object_id = hmi_dxy_bitmap_rotation_trail[hmi_object_index2].texture; hmi_trail_container.container_object_table.object_number = 1; hmi_trail_container.container_object_table.p_object_table = hmi_trail_object;  hmi_object_dirty_flag = hmi_engine_check_dynamic_object_changed( &hmi_trail_container, (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect, depth, &hmi_insect_rect); if(hmi_object_dirty_flag == TRUE) { hmi_set_dirty_zone_layer((HMI_RECT_STR *)pcliped_farther_rect/*trial image dirty zone is father zone*/, pdirty_rect,depth);   //hmi_page_redrawed_flag = TRUE;  hmi_object_dirty_flag = TRUE;  } } } #endif }  } } } else #endif #if HMI_STATIC_TEXTS_NUMBER > 0  if(hmi_object_id < HMI_STATIC_TEXTS_MAX_ID/*unedit text*/) { #if HMI_UNEDIT_TEXTS_DYN_XY_NUMBER>0 if(HMI_IS_UNEDIT_TEXT_DYN_XY(hmi_object_id)) { hmi_object_index = HMI_GET_UNEDIT_INDEX(hmi_object_id); if(hmi_object_index < HMI_UNEDIT_TEXTS_DYN_XY_NUMBER) {  HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&(hmi_dyn_xy_unedit_text_prop_table[hmi_object_index].text_rect)), (&hmi_node_screen_rect));  hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_insect_rect); } if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_object_id) != 0) { hmi_set_dirty_zone_layer(&hmi_insect_rect, pdirty_rect,depth);  if(hmi_object_index < HMI_UNEDIT_TEXTS_DYN_XY_NUMBER) { HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&(hmi_dyn_xy_unedit_text_prop_table_bck[hmi_object_index])), (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_insect_rect); hmi_set_dirty_zone_layer(&hmi_insect_rect, pdirty_rect,depth); //hmi_page_redrawed_flag = TRUE;  hmi_object_dirty_flag = TRUE; } } else { hmi_object_index = HMI_GET_UNEDIT_INDEX(hmi_object_id);/*all uneditable text contain at one array*/ if(hmi_object_index < HMI_UNEDIT_TEXTS_DYN_XY_NUMBER) { #if HMI_TEXT_MAX_SON_CNT > 0 hmi_object_dirty_flag = hmi_engine_check_dynamic_object_changed( &hmi_static_text_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect, depth,&hmi_insect_rect);  #else hmi_object_dirty_flag = FALSE; #endif } } } else #endif #if HMI_UNEDIT_TEXTS_STATIC_XY_NUMBER > 0 if(HMI_IS_UNEDIT_TEXT_STATIC_XY(hmi_object_id)) { hmi_object_index = HMI_GET_S_XY_UNEDIT_POS_COLOR_INDEX(hmi_object_id); if(hmi_object_index < HMI_UNEDIT_TEXTS_STATIC_XY_NUMBER) { HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_static_xy_unedit_text_prop_table[hmi_object_index].text_rect), (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_insect_rect); } if(HMI_IS_UNEDIT_TEXT_STATIC_XY_DYN_FONT(hmi_object_id)) { if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_object_id) != 0) { hmi_set_dirty_zone_layer(&hmi_insect_rect/*dfont image dirty zone is self zone*/, pdirty_rect,depth);  /*hmi_page_redrawed_flag = TRUE;*/ hmi_object_dirty_flag = TRUE; } else { hmi_object_index = HMI_GET_UNEDIT_INDEX(hmi_object_id);/*all uneditable text contain at one array*/ if(hmi_object_index < HMI_STATIC_TEXTS_NUMBER) { #if HMI_TEXT_MAX_SON_CNT > 0 hmi_object_dirty_flag=hmi_engine_check_dynamic_object_changed( &hmi_static_text_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect, depth,&hmi_insect_rect);  #else hmi_object_dirty_flag = FALSE; #endif } } } else { hmi_object_index = HMI_GET_UNEDIT_INDEX(hmi_object_id);/*all uneditable text contain at one array*/ if(hmi_object_index < HMI_STATIC_TEXTS_NUMBER) { #if HMI_TEXT_MAX_SON_CNT > 0 hmi_object_dirty_flag=hmi_engine_check_dynamic_object_changed( &hmi_static_text_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect, depth,&hmi_insect_rect);  #else hmi_object_dirty_flag = FALSE; #endif } } } else #endif { }  } else  #endif #if HMI_STATIC_FILL_PAGES_NUMBER > 0 if(HMI_IS_SXY_FILL_PAGES(hmi_object_id)) { hmi_object_index = HMI_GET_SXY_FILL_PAGES_ID_INDEX(hmi_object_id ); if(hmi_object_index < HMI_STATIC_FILL_PAGES_NUMBER) { hmi_rect_temp.x = hmi_fills_static_xy_rect[hmi_object_index].x; hmi_rect_temp.y = hmi_fills_static_xy_rect[hmi_object_index].y; hmi_rect_temp.w = hmi_fills_static_xy_rect[hmi_object_index].w; hmi_rect_temp.h = hmi_fills_static_xy_rect[hmi_object_index].h; HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_rect_temp), (&hmi_node_screen_rect)); } hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect,&hmi_insect_rect); if(hmi_object_index < HMI_STATIC_FILL_PAGES_NUMBER) { hmi_object_dirty_flag = hmi_engine_check_dynamic_object_changed( &hmi_static_fill_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect, depth,&hmi_insect_rect);  } } else #endif #if HMI_STATIC_GFILL_NUMBER> 0 if(HMI_IS_SXY_GFILL_PAGES(hmi_object_id)) { hmi_object_index = HMI_GET_SXY_GFILL_PAGES_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_STATIC_GFILL_NUMBER) { hmi_rect_temp.x = hmi_gradient_sxy_fill_rect[hmi_object_index].x; hmi_rect_temp.y = hmi_gradient_sxy_fill_rect[hmi_object_index].y; hmi_rect_temp.w = hmi_gradient_sxy_fill_rect[hmi_object_index].w; hmi_rect_temp.h = hmi_gradient_sxy_fill_rect[hmi_object_index].h; HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_rect_temp), (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_insect_rect); hmi_object_dirty_flag = hmi_engine_check_dynamic_object_changed( &hmi_static_gfill_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect, depth,&hmi_insect_rect);  } } else #endif #if HMI_SXY_CUBE_NUMBER> 0 if(HMI_IS_SXY_CUBE(hmi_object_id)) { hmi_object_index = HMI_GET_SXY_CUBE_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_SXY_CUBE_NUMBER) { HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_cubes_static_xy_rect[hmi_object_index].cube_rect), (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_insect_rect); hmi_object_dirty_flag = hmi_engine_check_dynamic_object_changed( &hmi_cubes_static_xy_face[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect, depth,&hmi_insect_rect);  if(hmi_object_dirty_flag == TRUE)/*if cube face texture changed ,cube should be change*/ { hmi_set_dirty_zone_layer(&pcliped_farther_rect, pdirty_rect,depth); } } } else #endif #if HMI_SXY_BITMAPS_NUMBER> 0 if(HMI_IS_S_XY_BITMAP(hmi_object_id)) { hmi_object_index = HMI_GET_SXY_BITMAPS_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_SXY_BITMAPS_NUMBER) { hmi_rect_temp.x = hmi_bmp_static_xy_rect[hmi_object_index].x; hmi_rect_temp.y = hmi_bmp_static_xy_rect[hmi_object_index].y; hmi_rect_temp.w = hmi_bmp_static_xy_rect[hmi_object_index].w; hmi_rect_temp.h = hmi_bmp_static_xy_rect[hmi_object_index].h; HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_rect_temp), (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_insect_rect); hmi_object_dirty_flag = hmi_engine_check_dynamic_object_changed( &hmi_sxy_bitmap_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect, depth,&hmi_insect_rect);  } } else #endif #if HMI_SXY_CONTAINERS_NUMBER > 0 if(HMI_IS_CONTAINERS_SXY(hmi_object_id)) { if(hmi_engine_check_container_changed(hmi_object_id, (HMI_RECT_STR CONST *)pfarther_rect, pdirty_rect,depth,pcliped_farther_rect) != FALSE) { hmi_object_dirty_flag = TRUE; } } else #endif  { } hmi_number_object--;  hmi_check_index++; }  return hmi_object_dirty_flag; }  #endif #endif  #if HMI_ALL_STATIC_CONTAINERS_NUMBER> 0 #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513)) static void hmi_get_dyn_dirty(HMI_OBJECT_ID_STR hmi_object_id,HMI_RECT_STR CONST *pfarther_rect, HMI_RECT_STR *pdirty_rect,UINT8 depth,HMI_RECT_STR hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml pcliped_farther_rect,BOOLEAN old_tree) {  HMI_RECT_STR hmi_insect_rect = {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0}; HMI_RECT_STR hmi_node_screen_rect = {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0}; HMI_RECT_STR CONST *phmi_container_rect = NULL;   //hmi_object_id = HMI_GET_DYN_CONTAINERS_ID_INDEX(hmi_object_id);  #if HMI_SXY_CONTAINERS_NUMBER >0 if(HMI_IS_CONTAINERS_SXY(hmi_object_id)) { hmi_object_id = HMI_GET_CONTAINERS_SXY_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_SXY_CONTAINERS_NUMBER) { phmi_container_rect=&hmi_static_container_rect[hmi_object_id]; hmi_get_object_screen_coor((HMI_RECT_STR CONST *)pfarther_rect, phmi_container_rect,&hmi_node_screen_rect); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect , &hmi_insect_rect ); hmi_set_dirty_zone_layer((HMI_RECT_STR *)(&hmi_insect_rect), pdirty_rect,depth); }  } else #endif #if HMI_DXY_CONTAINERS_NUMBER >0 if(HMI_IS_DYN_XY_CONTAINER(hmi_object_id)) {  hmi_object_id = HMI_GET_DYN_XY_CONTAINER_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_CONTAINERS_NUMBER) { if(old_tree == TRUE) { phmi_container_rect = &hmi_dyn_xy_container_rect_bck[hmi_object_id]; } else { phmi_container_rect = &hmi_dyn_xy_container_rect[hmi_object_id]; } HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect,phmi_container_rect, (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_insect_rect); hmi_set_dirty_zone_layer(&hmi_insect_rect, pdirty_rect,depth); }  } else #endif { }  } #if 1 //20170822 gpx modify support static BOOLEAN hmi_engine_check_container_changed(HMI_OBJECT_ID_STR hmi_object_id,HMI_RECT_STR CONST *pfarther_rect, HMI_RECT_STR *pdirty_rect,UINT8 depth,HMI_RECT_STR hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml pcliped_farther_rect) {  BOOLEAN hmi_container_changed_flag = FALSE;  HMI_RECT_STR CONST *phmi_container_rect = NULL;  HMI_RECT_STR hmi_node_screen_rect= {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0}; HMI_RECT_STR hmi_insect_rect = {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0}; HMI_OBJECT_ID_STR hmi_object_id_bck = 0; #if HMI_DXY_CONTAINERS_NUMBER >0 if(HMI_IS_DYN_XY_CONTAINER(hmi_object_id)) { if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_object_id) != 0) {  hmi_object_id = HMI_GET_DYN_XY_CONTAINER_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_CONTAINERS_NUMBER) { phmi_container_rect = &hmi_dyn_xy_container_rect[hmi_object_id]; HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect,phmi_container_rect, (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_insect_rect); hmi_set_dirty_zone_layer(&hmi_insect_rect, pdirty_rect,depth); /*add old dirty*/ HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_dyn_xy_container_rect_bck[hmi_object_id]), (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_insect_rect); hmi_set_dirty_zone_layer(&hmi_insect_rect, pdirty_rect,depth); } hmi_container_changed_flag = TRUE; } else { hmi_object_id = HMI_GET_DYN_XY_CONTAINER_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_CONTAINERS_NUMBER) {  phmi_container_rect = &hmi_dyn_xy_container_rect[hmi_object_id]; HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect,phmi_container_rect, (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_insect_rect); hmi_container_changed_flag |= hmi_engine_check_dynamic_object_changed( &hmi_dyn_xy_container_table[hmi_object_id], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect, depth,&hmi_insect_rect); } } } else  #endif #if HMI_SXY_CONTAINERS_NUMBER >0 if(HMI_IS_CONTAINERS_SXY(hmi_object_id)) { hmi_object_id = HMI_GET_CONTAINERS_SXY_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_SXY_CONTAINERS_NUMBER) { phmi_container_rect=&hmi_static_container_rect[hmi_object_id]; hmi_get_object_screen_coor((HMI_RECT_STR CONST *)pfarther_rect, phmi_container_rect,&hmi_node_screen_rect); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect , &hmi_insect_rect ); hmi_container_changed_flag |= hmi_engine_check_dynamic_object_changed( &hmi_sxy_container_table[hmi_object_id], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect, depth,&hmi_insect_rect); }  } else #endif #if (HMI_DYN_CONTAINERS_NUMBER > 0) if(HMI_IS_DYN_CONTAINER(hmi_object_id)) {  if((HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_object_id) != 0)) {  /*search old and new tree for dirty zone*/ hmi_object_id = HMI_GET_DYN_CONTAINERS_ID_INDEX(hmi_object_id); hmi_object_id_bck = hmi_dyn_container_table_bck[hmi_object_id]; if(HMI_IS_DYN_CONTAINER(hmi_object_id_bck)) { hmi_object_id_bck = HMI_GET_DYN_CONTAINERS_ID_INDEX(hmi_object_id_bck); hmi_engine_get_bck_static_container_id(&hmi_object_id_bck); } hmi_engine_get_static_container_id(&hmi_object_id); if(hmi_object_id != hmi_object_id_bck) { /*set old tree dirty*/ hmi_get_dyn_dirty(hmi_object_id_bck,pfarther_rect, pdirty_rect,depth,pcliped_farther_rect,TRUE); /*set new tree dirty*/ hmi_get_dyn_dirty(hmi_object_id,pfarther_rect, pdirty_rect,depth,pcliped_farther_rect,FALSE); hmi_container_changed_flag = TRUE;  } } else {  hmi_object_id = HMI_GET_DYN_CONTAINERS_ID_INDEX(hmi_object_id); hmi_engine_get_static_container_id(&hmi_object_id); hmi_container_changed_flag |= hmi_engine_check_container_changed(hmi_object_id, pfarther_rect,pdirty_rect,depth, pcliped_farther_rect);  }  } else #endif { }  return(hmi_container_changed_flag); } #else static BOOLEAN hmi_engine_check_container_changed(HMI_OBJECT_ID_STR hmi_object_id,HMI_RECT_STR CONST *pfarther_rect, HMI_RECT_STR *pdirty_rect,UINT8 depth,HMI_RECT_STR hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml pcliped_farther_rect) {  BOOLEAN hmi_container_changed_flag = FALSE;  HMI_RECT_STR CONST *phmi_container_rect = NULL;  HMI_RECT_STR hmi_node_screen_rect= {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0}; HMI_RECT_STR hmi_insect_rect = {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0}; HMI_OBJECT_ID_STR hmi_object_id_bck = 0;  #if HMI_DXY_CONTAINERS_NUMBER >0 if(HMI_IS_DYN_XY_CONTAINER(hmi_object_id)) { if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_object_id) != 0) {  hmi_object_id = HMI_GET_DYN_XY_CONTAINER_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_CONTAINERS_NUMBER) { phmi_container_rect = &hmi_dyn_xy_container_rect[hmi_object_id]; HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect,phmi_container_rect, (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_insect_rect); hmi_set_dirty_zone_layer(&hmi_insect_rect, pdirty_rect,depth); }  hmi_container_changed_flag = TRUE; } else { hmi_object_id = HMI_GET_DYN_XY_CONTAINER_INDEX(hmi_object_id); if(hmi_object_id < HMI_DXY_CONTAINERS_NUMBER) {  phmi_container_rect = &hmi_dyn_xy_container_rect[hmi_object_id];  HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect,phmi_container_rect, (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_insect_rect); hmi_container_changed_flag |= hmi_engine_check_dynamic_object_changed( &hmi_dyn_xy_container_table[hmi_object_id], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect, depth,&hmi_insect_rect); } } } else  #endif #if HMI_SXY_CONTAINERS_NUMBER >0 if(HMI_IS_CONTAINERS_SXY(hmi_object_id)) { hmi_object_id = HMI_GET_CONTAINERS_SXY_ID_INDEX(hmi_object_id); if(hmi_object_id < HMI_SXY_CONTAINERS_NUMBER) { phmi_container_rect=&hmi_static_container_rect[hmi_object_id]; hmi_get_object_screen_coor((HMI_RECT_STR CONST *)pfarther_rect, phmi_container_rect,&hmi_node_screen_rect); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect , &hmi_insect_rect ); hmi_container_changed_flag |= hmi_engine_check_dynamic_object_changed( &hmi_sxy_container_table[hmi_object_id], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect, depth,&hmi_insect_rect); }  } else #endif #if (HMI_DYN_CONTAINERS_NUMBER > 0) if(HMI_IS_DYN_CONTAINER(hmi_object_id)) {  if((HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_object_id) != 0)) {  /*search old and new tree for dirty zone*/ hmi_object_id = HMI_GET_DYN_CONTAINERS_ID_INDEX(hmi_object_id); hmi_object_id_bck = hmi_dyn_container_table_bck[hmi_object_id]; if(HMI_IS_DYN_CONTAINER(hmi_object_id_bck)) { hmi_object_id_bck = HMI_GET_DYN_CONTAINERS_ID_INDEX(hmi_object_id_bck); hmi_engine_get_bck_static_container_id(&hmi_object_id_bck); } hmi_engine_get_static_container_id(&hmi_object_id);  if(hmi_object_id != hmi_object_id_bck) { /*set old tree dirty*/ hmi_get_dyn_dirty(hmi_object_id_bck,pfarther_rect, pdirty_rect,depth,pcliped_farther_rect,TRUE); /*set new tree dirty*/ hmi_get_dyn_dirty(hmi_object_id,pfarther_rect, pdirty_rect,depth,pcliped_farther_rect,FALSE); hmi_container_changed_flag = TRUE;  } } else {  hmi_object_id = HMI_GET_DYN_CONTAINERS_ID_INDEX(hmi_object_id); hmi_engine_get_static_container_id(&hmi_object_id); hmi_container_changed_flag |= hmi_engine_check_container_changed(hmi_object_id, pfarther_rect,pdirty_rect,depth, pcliped_farther_rect);  }  } else #endif { }  return(hmi_container_changed_flag); } #endif #endif #endif    #if defined(HMI_GRAPHIC_TWLIB) BOOLEAN hmi_get_is_merge(HMI_ELEMENT_TYPE parent_type,HMI_ELEMENT_TYPE child_type) { BOOLEAN bmerge=FALSE;  switch(parent_type) { case HMI_ELEM_TYPE_SFILL : if(child_type==HMI_ELEM_TYPE_SFILL ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DFILL ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SIMAGE ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DIMAGE ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SIMGLIST ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DIMGLIST ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SBTN ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DBTN ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SPAGE ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DPAGE ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_SSCROLLBAR ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DSCROLLBAR ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DYN_CONTAINER ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_DXY_CONTINER ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SXY_CONTAINER ) { bmerge=TRUE; } else { bmerge=TRUE; } break; case HMI_ELEM_TYPE_DFILL : bmerge=FALSE; break; case HMI_ELEM_TYPE_SIMAGE : if(child_type==HMI_ELEM_TYPE_SFILL ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DFILL ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SIMAGE ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DIMAGE ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SIMGLIST ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DIMGLIST ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SBTN ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DBTN ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SPAGE ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DPAGE ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_SSCROLLBAR ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DSCROLLBAR ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DYN_CONTAINER ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_DXY_CONTINER ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SXY_CONTAINER ) { bmerge=TRUE; } else { bmerge=TRUE; } break; case HMI_ELEM_TYPE_DIMAGE : if(child_type==HMI_ELEM_TYPE_SFILL ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DFILL ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SIMAGE ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DIMAGE ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SIMGLIST ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DIMGLIST ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SBTN ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DBTN ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SPAGE ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DPAGE ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_SSCROLLBAR ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DSCROLLBAR ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DYN_CONTAINER ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_DXY_CONTINER ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SXY_CONTAINER ) { bmerge=TRUE; } else { bmerge=TRUE; } break; case HMI_ELEM_TYPE_SIMGLIST : if(child_type==HMI_ELEM_TYPE_SFILL ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DFILL ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SIMAGE ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DIMAGE ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SIMGLIST ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DIMGLIST ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SBTN ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DBTN ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SPAGE ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DPAGE ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_SSCROLLBAR ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DSCROLLBAR ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DYN_CONTAINER ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_DXY_CONTINER ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SXY_CONTAINER ) { bmerge=TRUE; } else { bmerge=TRUE; } break; case HMI_ELEM_TYPE_DIMGLIST : if(child_type==HMI_ELEM_TYPE_SFILL ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DFILL ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SIMAGE ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DIMAGE ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SIMGLIST ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DIMGLIST ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SBTN ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DBTN ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SPAGE ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DPAGE ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_SSCROLLBAR ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DSCROLLBAR ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DYN_CONTAINER ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_DXY_CONTINER ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SXY_CONTAINER ) { bmerge=TRUE; } else { bmerge=TRUE; } break; case HMI_ELEM_TYPE_SBTN : if(child_type==HMI_ELEM_TYPE_SFILL ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DFILL ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SIMAGE ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DIMAGE ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SIMGLIST ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DIMGLIST ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SBTN ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DBTN ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SPAGE ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DPAGE ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_SSCROLLBAR ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DSCROLLBAR ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DYN_CONTAINER ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_DXY_CONTINER ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SXY_CONTAINER ) { bmerge=TRUE; } else { bmerge=TRUE; } break; case HMI_ELEM_TYPE_DBTN : if(child_type==HMI_ELEM_TYPE_SFILL ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DFILL ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SIMAGE ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DIMAGE ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SIMGLIST ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DIMGLIST ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SBTN ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DBTN ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SPAGE ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DPAGE ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_SSCROLLBAR ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DSCROLLBAR ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DYN_CONTAINER ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_DXY_CONTINER ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SXY_CONTAINER ) { bmerge=TRUE; } else { bmerge=TRUE; } break; case HMI_ELEM_TYPE_SPAGE : if(child_type==HMI_ELEM_TYPE_SFILL ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DFILL ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SIMAGE ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DIMAGE ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SIMGLIST ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DIMGLIST ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SBTN ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DBTN ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SPAGE ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DPAGE ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_SSCROLLBAR ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DSCROLLBAR ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DYN_CONTAINER ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_DXY_CONTINER ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SXY_CONTAINER ) { bmerge=TRUE; } else { bmerge=TRUE; } break; case HMI_ELEM_TYPE_DPAGE : if(child_type==HMI_ELEM_TYPE_SFILL ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DFILL ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SIMAGE ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DIMAGE ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SIMGLIST ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DIMGLIST ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SBTN ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DBTN ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SPAGE ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DPAGE ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_SSCROLLBAR ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DSCROLLBAR ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DYN_CONTAINER ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_DXY_CONTINER ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SXY_CONTAINER ) { bmerge=TRUE; } else { bmerge=TRUE; } break; case HMI_ELEM_TYPE_SXY_CONTAINER: if(child_type==HMI_ELEM_TYPE_SFILL ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DFILL ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SIMAGE ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DIMAGE ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SIMGLIST ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DIMGLIST ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SBTN ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DBTN ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SPAGE ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_DPAGE ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SSCROLLBAR ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_DSCROLLBAR ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_DYN_CONTAINER ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_DXY_CONTINER ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SXY_CONTAINER ) { bmerge=TRUE; } else { bmerge=TRUE; } break; case HMI_ELEM_TYPE_DXY_CONTINER: if(child_type==HMI_ELEM_TYPE_SFILL ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DFILL ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SIMAGE ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DIMAGE ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SIMGLIST ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DIMGLIST ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SBTN ) { bmerge=TRUE; } else if(child_type==HMI_ELEM_TYPE_DBTN ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SPAGE ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_DPAGE ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SSCROLLBAR ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_DSCROLLBAR ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_DYN_CONTAINER ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_DXY_CONTINER ) { bmerge=FALSE; } else if(child_type==HMI_ELEM_TYPE_SXY_CONTAINER ) { bmerge=TRUE; } else { bmerge=TRUE; } break;  case HMI_ELEM_TYPE_SSCROLLBAR : bmerge=TRUE;/*tw not support scrollbar*/ break; case HMI_ELEM_TYPE_DSCROLLBAR : bmerge=TRUE;/*tw not support scrollbar*/ break; default: ; } return bmerge; } #endif  #if 0 #if HMI_SXY_BITMAPS_NUMBER > 0 need cut off static void hmi_engine_draw_static_xy_image(HMI_OBJECT_PROP_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_image_prop_info,HMI_RECT_STR CONST *pfarther_rect, #ifdef HMI_GRAPHIC_AGG||HMI_GRAPHIC_RGL||HMI_GRAPHIC_ST HMI_RECT_STR hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml pvalue_rect, HMI_RECT_STR *pdirty_rect #else HMI_ELEMENT_TYPE parent_type #endif ) { HMI_OBJECT_ID_STR hmi_object_id = HMI_GET_SXY_BITMAPS_ID_INDEX(phmi_image_prop_info->object_id); HMI_RECT_STR hmi_temp_rect={HMI_INVALID_COOR,HMI_INVALID_COOR,0,0}; #ifdef HMI_GRAPHIC_AGG||HMI_GRAPHIC_RGL||HMI_GRAPHIC_ST HMI_RECT_STR hmi_union_rect={HMI_INVALID_COOR,HMI_INVALID_COOR,0,0}; HMI_RECT_STR hmi_draw_rect={HMI_INVALID_COOR,HMI_INVALID_COOR,0,0}; #else /*tw*/ BOOLEAN bDrawBck=FALSE; #endif if(hmi_object_id < HMI_SXY_BITMAPS_NUMBER) { HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect,(&hmi_bmp_static_xy_rect[hmi_object_id]),(&hmi_temp_rect)); #ifdef HMI_GRAPHIC_AGG||HMI_GRAPHIC_RGL||HMI_GRAPHIC_ST hmi_get_intersec_rect((HMI_RECT_STR CONST *)&hmi_temp_rect,(HMI_RECT_STR CONST *)pvalue_rect,&hmi_union_rect); hmi_get_intersec_rect((HMI_RECT_STR CONST *)&hmi_union_rect,(HMI_RECT_STR CONST *)pdirty_rect,&hmi_draw_rect); #endif #ifdef HMI_GRAPHIC_AGG call_C_hmi_driver_draw_image(&hmi_temp_rect, hmi_bigbitmap_table[0],hmi_bigbitmap_table[1],&hmi_bmp_static_xy_prop_table[hmi_object_id],&hmi_draw_rect); #endif #ifdef HMI_GRAPHIC_RGL call_C_hmi_driver_draw_image(&hmi_temp_rect, hmi_bigbitmap_table[0],hmi_bigbitmap_table[1],&hmi_bmp_static_xy_prop_table[hmi_object_id],&hmi_draw_rect); #endif #ifdef HMI_GRAPHIC_TWLIB call_C_hmi_driver_draw_image(); #endif  #ifdef HMI_GRAPHIC_AGG||HMI_GRAPHIC_RGL||HMI_GRAPHIC_ST hmi_engine_draw_container(&hmi_sxy_bitmap_container_table[hmi_object_id], (HMI_RECT_STR CONST *)&hmi_temp_rect, &hmi_union_rect,pdirty_rect); #else /*tw*/ bDrawBck=hmi_get_is_merge(parent_type,HMI_SIMAGE); hmi_engine_draw_container(&hmi_sxy_bitmap_container_table[hmi_object_id], (HMI_RECT_STR CONST *)&hmi_temp_rect, HMI_DIMAGE ,bDrawBck); #endif  } } #endif #endif  #if 0 #if HMI_DXY_BITMAPS_NUMBER > 0  static void hmi_engine_draw_dyn_xy_image(HMI_OBJECT_PROP_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_image_prop_info,HMI_RECT_STR CONST *pfarther_rect,HMI_RECT_STR hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml pvalue_rect,HMI_RECT_STR *pdirty_rect) { HMI_OBJECT_ID_STR hmi_object_id = HMI_GET_DYN_XY_BITMAP_INDEX(phmi_image_prop_info->object_id); HMI_RECT_STR hmi_screen_target={HMI_INVALID_COOR,HMI_INVALID_COOR,0,0}; HMI_RECT_STR hmi_union_rect={HMI_INVALID_COOR,HMI_INVALID_COOR,0,0}; HMI_RECT_STR hmi_draw_rect={HMI_INVALID_COOR,HMI_INVALID_COOR,0,0};  if(hmi_object_id < HMI_DXY_BITMAPS_NUMBER) { HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect,(&hmi_bmp_dyn_xy_rect[hmi_object_id]),(&hmi_screen_target)); #ifdef HMI_GRAPHIC_AGG||HMI_GRAPHIC_RGL||HMI_GRAPHIC_ST hmi_get_intersec_rect((HMI_RECT_STR CONST *)&hmi_screen_target,(HMI_RECT_STR CONST *)pvalue_rect,&hmi_union_rect); hmi_get_intersec_rect((HMI_RECT_STR CONST *)&hmi_union_rect,(HMI_RECT_STR CONST *)pdirty_rect,&hmi_draw_rect); #endif  #ifdef HMI_GRAPHIC_AGG call_C_hmi_driver_draw_image(&hmi_screen_target, hmi_bigbitmap_table[0],hmi_bigbitmap_table[1], &hmi_bmp_dyn_xy_prop_table[hmi_object_id],&hmi_draw_rect); #endif #ifdef HMI_GRAPHIC_RGL call_C_hmi_driver_draw_image(&hmi_screen_target, &hmi_bmp_dyn_xy_rect[hmi_object_id], &hmi_bmp_dyn_xy_prop_table[hmi_object_id],&hmi_draw_rect); #endif #ifdef HMI_GRAPHIC_TWLIB call_C_hmi_driver_draw_image(&hmi_screen_target, &hmi_dxy_bitmap_attr_table[hmi_object_id], &hmi_bmp_dyn_xy_prop_table[hmi_object_id],&hmi_draw_rect); #endif hmi_engine_draw_container(&hmi_dxy_bitmap_container_table[hmi_object_id],(HMI_RECT_STR CONST *)&hmi_screen_target,&hmi_union_rect,pdirty_rect); } } #endif #endif   #if 0 void hmi_engine_draw_container_bck(HMI_OBJECT_ID_STR elemID) { } #endif  #ifdef HMI_GRAPHIC_RGL #if((HMI_DXY_CONTAINERS_NUMBER+HMI_SXY_CONTAINERS_NUMBER) > 0)  static void hmi_cube_get_id_prop(HMI_OBJECT_ID_STR hmi_object_id, HMI_CUBE_TEXTURE_PROP *pcube_texture, SPOINT_TP *pfather_point)  { HMI_OBJECT_ID_STR hmi_object_index = 0; if(pcube_texture !=NULL) { pcube_texture->tex_rect.x=0; pcube_texture->tex_rect.y=0; pcube_texture->tex_rect.w=0; pcube_texture->tex_rect.h=0; pcube_texture->tex_rect.angel=0; pcube_texture->tex_rect.alpha=0; pcube_texture->tex_prop.w=0; pcube_texture->tex_prop.h=0; pcube_texture->tex_prop.data_len=0; pcube_texture->tex_prop.pbitmap_data=NULL; pcube_texture->tex_attr.image_attr=0; pcube_texture->tex_id=HMI_ALL_OBJECT;  if(hmi_object_id >= HMI_PAGE_SXY_MAX_ID)/*not a page*/ {  #if HMI_DXY_IMAGELIST_NUMBER>0 if(HMI_IS_DYN_IMAGELIST_DXY(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_IMAGELIST_DXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_DXY_IMAGELIST_NUMBER) { if(pfather_point !=NULL) { pfather_point->x+=hmi_dxy_imagelist_rect[hmi_object_index].x; pfather_point->y+=hmi_dxy_imagelist_rect[hmi_object_index].y; } pcube_texture->tex_rect.x=hmi_dxy_imagelist_rect[hmi_object_index].x; pcube_texture->tex_rect.y=hmi_dxy_imagelist_rect[hmi_object_index].y; pcube_texture->tex_rect.w=hmi_dxy_imagelist_rect[hmi_object_index].w; pcube_texture->tex_rect.h=hmi_dxy_imagelist_rect[hmi_object_index].h; pcube_texture->tex_rect.angel=0; pcube_texture->tex_rect.alpha=hmi_dxy_imagelist_rect[hmi_object_index].alpha; pcube_texture->tex_prop.w=hmi_dxy_imagelist_table[hmi_object_index].file.w; pcube_texture->tex_prop.h=hmi_dxy_imagelist_table[hmi_object_index].file.h; pcube_texture->tex_prop.data_len=hmi_dxy_imagelist_table[hmi_object_index].file.data_len; pcube_texture->tex_prop.pbitmap_data=hmi_dxy_imagelist_table[hmi_object_index].file.pbitmap_data; pcube_texture->tex_attr.image_attr=hmi_dxy_imglist_attr_table[hmi_object_index].image_attr; pcube_texture->tex_id=hmi_object_id; } }  else #endif #if HMI_SXY_IMAGELIST_NUMBER>0 if(HMI_IS_DYN_IMAGELIST_SXY(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_IMAGELIST_SXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_SXY_IMAGELIST_NUMBER) {  if(pfather_point !=NULL) { pfather_point->x+=hmi_sxy_imagelist_rect[hmi_object_index].x; pfather_point->y+=hmi_sxy_imagelist_rect[hmi_object_index].y; } pcube_texture->tex_rect.x = hmi_sxy_imagelist_rect[hmi_object_index].x; pcube_texture->tex_rect.y = hmi_sxy_imagelist_rect[hmi_object_index].y; pcube_texture->tex_rect.w = hmi_sxy_imagelist_rect[hmi_object_index].w; pcube_texture->tex_rect.h = hmi_sxy_imagelist_rect[hmi_object_index].h; pcube_texture->tex_rect.angel= 0; pcube_texture->tex_rect.alpha= hmi_sxy_imagelist_rect[hmi_object_index].alpha; pcube_texture->tex_prop.w = hmi_sxy_imagelist_table[hmi_object_index].file.w; pcube_texture->tex_prop.h = hmi_sxy_imagelist_table[hmi_object_index].file.h; pcube_texture->tex_prop.data_len = hmi_sxy_imagelist_table[hmi_object_index].file.data_len; pcube_texture->tex_prop.pbitmap_data= hmi_sxy_imagelist_table[hmi_object_index].file.pbitmap_data; pcube_texture->tex_attr.image_attr = hmi_sxy_imglist_attr_table[hmi_object_index].image_attr; pcube_texture->tex_id = hmi_object_id; } } else #endif #if HMI_DYN_CONTAINERS_NUMBER > 0 if(HMI_IS_DYN_CONTAINER(hmi_object_id)) {  #if HMI_ALL_STATIC_CONTAINERS_NUMBER > 0  hmi_object_id = HMI_GET_DYN_CONTAINERS_ID_INDEX(hmi_object_id); hmi_engine_get_static_container_id(&hmi_object_id);/*get static container ID*/  #if HMI_DXY_CONTAINERS_NUMBER>0U if(HMI_IS_DYN_XY_CONTAINER(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_XY_CONTAINER_INDEX(hmi_object_id ); if(hmi_object_index < HMI_DXY_CONTAINERS_NUMBER) { if(pfather_point !=NULL) { pfather_point->x+=hmi_dyn_xy_container_rect[hmi_object_index].x; pfather_point->y+=hmi_dyn_xy_container_rect[hmi_object_index].y; } hmi_cube_get_id_prop(hmi_object_id,pcube_texture,pfather_point); } } else #endif { } #if HMI_SXY_CONTAINERS_NUMBER>0 if(HMI_IS_CONTAINERS_SXY(hmi_object_id)) { hmi_object_index = HMI_GET_CONTAINERS_SXY_ID_INDEX(hmi_object_id ); if(hmi_object_index < HMI_SXY_CONTAINERS_NUMBER) { if(pfather_point !=NULL) { pfather_point->x+=hmi_static_container_rect[hmi_object_index].x; pfather_point->y+=hmi_static_container_rect[hmi_object_index].y; } hmi_cube_get_id_prop(hmi_object_id,pcube_texture,pfather_point);  } } else #endif { }  #endif } else #endif #if HMI_DXY_CONTAINERS_NUMBER > 0U  if(HMI_IS_DYN_XY_CONTAINER(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_XY_CONTAINER_INDEX(hmi_object_id ); if(hmi_object_index < HMI_DXY_CONTAINERS_NUMBER) { if(pfather_point !=NULL) { pfather_point->x+=hmi_dyn_xy_container_rect[hmi_object_index].x; pfather_point->y+=hmi_dyn_xy_container_rect[hmi_object_index].y; } hmi_object_index = hmi_dyn_xy_container_table[hmi_object_index].container_object_table.p_object_table->object_id;/*get container first child to disp*/ hmi_cube_get_id_prop(hmi_object_index,pcube_texture,pfather_point); } } else #endif  #if HMI_DXY_BITMAPS_NUMBER> 0  if(HMI_IS_DYN_XY_BITMAP(hmi_object_id)) {  hmi_object_index = HMI_GET_DYN_XY_BITMAP_INDEX(hmi_object_id ); if(hmi_object_index < HMI_DXY_BITMAPS_NUMBER) {  if(pfather_point !=NULL) { pfather_point->x+=hmi_bmp_dyn_xy_rect[hmi_object_index].x; pfather_point->y+=hmi_bmp_dyn_xy_rect[hmi_object_index].y; } pcube_texture->tex_rect.x = hmi_bmp_dyn_xy_rect[hmi_object_index].x; pcube_texture->tex_rect.y = hmi_bmp_dyn_xy_rect[hmi_object_index].y; pcube_texture->tex_rect.w = hmi_bmp_dyn_xy_rect[hmi_object_index].w; pcube_texture->tex_rect.h = hmi_bmp_dyn_xy_rect[hmi_object_index].h; pcube_texture->tex_rect.angel= hmi_bmp_dyn_xy_rect[hmi_object_index].angel; pcube_texture->tex_rect.alpha= hmi_bmp_dyn_xy_rect[hmi_object_index].alpha; pcube_texture->tex_prop.w = hmi_bmp_dyn_xy_prop_table[hmi_object_index].w; pcube_texture->tex_prop.h = hmi_bmp_dyn_xy_prop_table[hmi_object_index].h; pcube_texture->tex_prop.data_len=hmi_bmp_dyn_xy_prop_table[hmi_object_index].data_len; pcube_texture->tex_prop.pbitmap_data=hmi_bmp_dyn_xy_prop_table[hmi_object_index].pbitmap_data; pcube_texture->tex_attr.image_attr=hmi_dxy_bitmap_attr_table[hmi_object_index].image_attr; pcube_texture->tex_id = hmi_object_id; } } else #endif #if HMI_SXY_BITMAPS_NUMBER> 0 if(HMI_IS_S_XY_BITMAP(hmi_object_id)) {  hmi_object_index = HMI_GET_SXY_BITMAPS_ID_INDEX(hmi_object_id);  if(hmi_object_index < HMI_SXY_BITMAPS_NUMBER) { if(pfather_point !=NULL) { pfather_point->x+=hmi_bmp_static_xy_rect[hmi_object_index].x; pfather_point->y+=hmi_bmp_static_xy_rect[hmi_object_index].y; } pcube_texture->tex_rect.x = hmi_bmp_static_xy_rect[hmi_object_index].x; pcube_texture->tex_rect.y = hmi_bmp_static_xy_rect[hmi_object_index].y; pcube_texture->tex_rect.w = hmi_bmp_static_xy_rect[hmi_object_index].w; pcube_texture->tex_rect.h = hmi_bmp_static_xy_rect[hmi_object_index].h; pcube_texture->tex_rect.angel= 0; pcube_texture->tex_rect.alpha= hmi_bmp_static_xy_rect[hmi_object_index].alpha; pcube_texture->tex_prop.w = hmi_bmp_static_xy_prop_table[hmi_object_index].w; pcube_texture->tex_prop.h = hmi_bmp_static_xy_prop_table[hmi_object_index].h; pcube_texture->tex_prop.data_len= hmi_bmp_static_xy_prop_table[hmi_object_index].data_len; pcube_texture->tex_prop.pbitmap_data= hmi_bmp_static_xy_prop_table[hmi_object_index].pbitmap_data; pcube_texture->tex_attr.image_attr = hmi_sxy_bitmap_attr_table[hmi_object_index].image_attr; pcube_texture->tex_id = hmi_object_id; } } else #endif  #if HMI_SXY_CONTAINERS_NUMBER > 0  if(HMI_IS_CONTAINERS_SXY(hmi_object_id)) { hmi_object_index = HMI_GET_CONTAINERS_SXY_ID_INDEX(hmi_object_id ); if(hmi_object_index < HMI_SXY_CONTAINERS_NUMBER) { if(pfather_point !=NULL) { pfather_point->x+=hmi_static_container_rect[hmi_object_index].x; pfather_point->y+=hmi_static_container_rect[hmi_object_index].y; } hmi_object_index = hmi_sxy_container_table[hmi_object_index].container_object_table.p_object_table->object_id;/*get container first child to disp*/ hmi_cube_get_id_prop(hmi_object_index,pcube_texture,pfather_point); } } else #endif  { ; }  } } } #endif /* Get element x,y(not include container) */ static void hmi_cube_get_id_point(HMI_OBJECT_ID_STR hmi_object_id, S3POINT_TP *ppoint)  { HMI_OBJECT_ID_STR hmi_object_index = 0;  if(ppoint != NULL) {  #if HMI_DXY_PAGES_NUMBER > 0  if(HMI_IS_DXY_PAGE(hmi_object_id)) { hmi_object_index = HMI_GET_PAGE_DXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_DXY_PAGES_NUMBER) { ppoint->x = hmi_dxy_page_rect[hmi_object_index].x; ppoint->y = hmi_dxy_page_rect[hmi_object_index].y; ppoint->z = 0;  } } else #endif  #if HMI_SXY_PAGES_NUMBER > 0  if(HMI_IS_SXY_PAGE(hmi_object_id)) { hmi_object_index = HMI_GET_PAGE_SXY_ID_INDEX(hmi_object_id); #if HMI_DXY_PAGES_NUMBER>0 if(hmi_object_index < HMI_DXY_PAGES_NUMBER) { ppoint->x = hmi_sxy_page_rect[hmi_object_index].x; ppoint->y = hmi_sxy_page_rect[hmi_object_index].y; ppoint->z = 0;  } #endif } else #endif  #if HMI_DYN_EDIT_TEXTS_NUMBER/*editable text*/ > 0  if(HMI_IS_DYN_TEXTS(hmi_object_id)) {  #if HMI_DYN_XY_EDIT_TEXTS_NUMBER > 0 if(HMI_IS_DYN_TEXT_DXY(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_TEXTS_DXY_POS_INDEX(hmi_object_id); if(hmi_object_index < HMI_DYN_XY_EDIT_TEXTS_NUMBER) { ppoint->x = hmi_dyn_xy_edit_text_prop_table[hmi_object_index].text_rect.x; ppoint->y = hmi_dyn_xy_edit_text_prop_table[hmi_object_index].text_rect.y; ppoint->z = 0;  }  } else #endif  #if HMI_S_XY_EDIT_TEXTS_NUMBER > 0 if(HMI_IS_DYN_TEXT_SXY(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_TEXTS_SXY_POS_INDEX(hmi_object_id); if(hmi_object_index < HMI_S_XY_EDIT_TEXTS_NUMBER) { ppoint->x = hmi_static_xy_edit_text_prop_table[hmi_object_index].text_rect.x; ppoint->y = hmi_static_xy_edit_text_prop_table[hmi_object_index].text_rect.y; ppoint->z = 0;  }  } else #endif { } } else #endif   #if HMI_STATIC_TEXTS_NUMBER/*uneditable text*/ > 0  if(HMI_IS_STATIC_TEXTS(hmi_object_id))  {  #if HMI_UNEDIT_TEXTS_DYN_XY_NUMBER > 0 if(HMI_IS_UNEDIT_TEXT_DYN_XY(hmi_object_id)) {  hmi_object_index = HMI_GET_DYN_XY_UNEDIT_POS_COLOR_INDEX(hmi_object_id); if(hmi_object_index < HMI_UNEDIT_TEXTS_DYN_XY_NUMBER) { ppoint->x = hmi_dyn_xy_unedit_text_prop_table[hmi_object_index].text_rect.x; ppoint->y = hmi_dyn_xy_unedit_text_prop_table[hmi_object_index].text_rect.y; ppoint->z = 0;  }  } else  #endif { #if HMI_UNEDIT_TEXTS_STATIC_XY_NUMBER > 0  if(HMI_IS_UNEDIT_TEXT_STATIC_XY(hmi_object_id)) { hmi_object_index = HMI_GET_S_XY_UNEDIT_POS_COLOR_INDEX(hmi_object_id); if(hmi_object_index < HMI_UNEDIT_TEXTS_STATIC_XY_NUMBER) { ppoint->x = hmi_static_xy_unedit_text_prop_table[hmi_object_index].text_rect.x; ppoint->y = hmi_static_xy_unedit_text_prop_table[hmi_object_index].text_rect.y; ppoint->z = 0;  }  } #endif } }  else #endif   #if HMI_DXY_SCROLLBAR_NUMBER>0 if(HMI_IS_DYN_SCROLLBAR_DXY(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_SCROLLBAR_DXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_DXY_SCROLLBAR_NUMBER) { ppoint->x = hmi_dxy_scrollbar_rect[hmi_object_index].x; ppoint->y = hmi_dxy_scrollbar_rect[hmi_object_index].y; ppoint->z = 0;  }  } else  #endif  #if HMI_SXY_SCROLLBAR_NUMBER>0 if(HMI_IS_DYN_SCROLLBAR_SXY(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_SCROLLBAR_SXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_SXY_SCROLLBAR_NUMBER) { ppoint->x = hmi_sxy_scrollbar_rect[hmi_object_index].x; ppoint->y = hmi_sxy_scrollbar_rect[hmi_object_index].y; ppoint->z = 0;  }  } else #endif   #if HMI_SXY_BUTTON_NUMBER>0  if(HMI_IS_DYN_BUTTON_SXY(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_BUTTON_SXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_SXY_BUTTON_NUMBER) { ppoint->x = hmi_sxy_button_rect[hmi_object_index].x; ppoint->y = hmi_sxy_button_rect[hmi_object_index].y; ppoint->z = 0;  }  }  else  #endif  #if HMI_DXY_BUTTON_NUMBER > 0  if(HMI_IS_DYN_BUTTON_DXY(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_BUTTON_DXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_DXY_BUTTON_NUMBER) { ppoint->x = hmi_dxy_button_rect[hmi_object_index].x; ppoint->y = hmi_dxy_button_rect[hmi_object_index].y; ppoint->z = 0;  }  }  else #endif  #if HMI_SXY_IMAGELIST_NUMBER>0 if(HMI_IS_DYN_IMAGELIST_SXY(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_IMAGELIST_SXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_SXY_IMAGELIST_NUMBER) {  ppoint->x = hmi_sxy_imagelist_rect[hmi_object_index].x; ppoint->y = hmi_sxy_imagelist_rect[hmi_object_index].y;  ppoint->z = 0; } } else #endif   #if HMI_DXY_IMAGELIST_NUMBER > 0 if(HMI_IS_DYN_IMAGELIST_DXY(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_IMAGELIST_DXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_DXY_IMAGELIST_NUMBER) { ppoint->x = hmi_dxy_imagelist_rect[hmi_object_index].x; ppoint->y = hmi_dxy_imagelist_rect[hmi_object_index].y; ppoint->z = 0; } }  else #endif  #if HMI_STATIC_FILL_PAGES_NUMBER > 0  if(HMI_IS_SXY_FILL_PAGES(hmi_object_id)) { hmi_object_index = HMI_GET_SXY_FILL_PAGES_ID_INDEX(hmi_object_id ); if(hmi_object_index < HMI_STATIC_FILL_PAGES_NUMBER) { ppoint->x = hmi_fills_static_xy_rect[hmi_object_index].x; ppoint->y = hmi_fills_static_xy_rect[hmi_object_index].y; ppoint->z = hmi_fills_static_xy_rect[hmi_object_index].z;  }  } else #endif  #if HMI_DYN_FILL_PAGES_NUMBER > 0 if(HMI_IS_DYN_NFILL(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_NFILL_INDEX(hmi_object_id ); if(hmi_object_index < HMI_DYN_FILL_PAGES_NUMBER) { ppoint->x = hmi_fills_dyn_xy_rect[hmi_object_index].x; ppoint->y = hmi_fills_dyn_xy_rect[hmi_object_index].y;  ppoint->z = hmi_fills_dyn_xy_rect[hmi_object_index].z;  }  } else #endif  #if HMI_DXY_BITMAPS_NUMBER> 0  if(HMI_IS_DYN_XY_BITMAP(hmi_object_id)) {  hmi_object_index = HMI_GET_DYN_XY_BITMAP_INDEX(hmi_object_id ); if(hmi_object_index < HMI_DXY_BITMAPS_NUMBER) {  ppoint->x = hmi_bmp_dyn_xy_rect[hmi_object_index].x; ppoint->y = hmi_bmp_dyn_xy_rect[hmi_object_index].y;  } } else #endif #if HMI_SXY_BITMAPS_NUMBER> 0 if(HMI_IS_S_XY_BITMAP(hmi_object_id)) {  hmi_object_index = HMI_GET_SXY_BITMAPS_ID_INDEX(hmi_object_id);  if(hmi_object_index < HMI_SXY_BITMAPS_NUMBER) { ppoint->x = hmi_bmp_static_xy_rect[hmi_object_index].x; ppoint->y = hmi_bmp_static_xy_rect[hmi_object_index].y;  } } else #endif  { ; }  } }  void hmi_get_axis(S3POINT_TP *paxis,HMI_CUBE_AXIS_PROP CONST *pelem_axis,HMI_RECT_STR CONST *pfarther_rect) { if((paxis != NULL)&&(pelem_axis != NULL)&&(pfarther_rect != NULL)) { hmi_cube_get_container_point(pelem_axis->private_axis,&paxis[HMI_ROTATION_PRIVATE_AXIS]); hmi_cube_get_container_point(pelem_axis->public_axis1,&paxis[HMI_ROTATION_PUBLIC_AXIS1]); hmi_cube_get_container_point(pelem_axis->public_axis2,&paxis[HMI_ROTATION_PUBLIC_AXIS2]);   HMI_GET_OBJECT_SCREEN_COOR2(pfarther_rect, (&paxis[HMI_ROTATION_PUBLIC_AXIS1]), (&paxis[HMI_ROTATION_PUBLIC_AXIS1]));  HMI_GET_OBJECT_SCREEN_COOR2(pfarther_rect, (&paxis[HMI_ROTATION_PUBLIC_AXIS2]), (&paxis[HMI_ROTATION_PUBLIC_AXIS2])); } }  #if HMI_DXY_ROTATION_BITMAPS_NUMBER > 0 static BOOLEAN hmi_get_container_child_id(HMI_OBJECT_ID_STR *phmi_object_id) { HMI_OBJECT_ID_STR hmi_object_index = 0; BOOLEAN hmi_changed_flag = FALSE; if((*phmi_object_id) >= HMI_PAGE_SXY_MAX_ID)/*not a page*/ {  #if HMI_DYN_CONTAINERS_NUMBER > 0 if(HMI_IS_DYN_CONTAINER((*phmi_object_id))) {  #if HMI_ALL_STATIC_CONTAINERS_NUMBER > 0  (*phmi_object_id) = HMI_GET_DYN_CONTAINERS_ID_INDEX((*phmi_object_id)); hmi_engine_get_static_container_id(phmi_object_id);/*get static container ID*/ hmi_changed_flag = hmi_get_container_child_id(phmi_object_id);  #endif } else #endif #if HMI_DXY_CONTAINERS_NUMBER > 0  if(HMI_IS_DYN_XY_CONTAINER((*phmi_object_id))) { hmi_object_index = HMI_GET_DYN_XY_CONTAINER_INDEX((*phmi_object_id)); if(hmi_object_index < HMI_DXY_CONTAINERS_NUMBER) { (*phmi_object_id) = hmi_dyn_xy_container_table[hmi_object_index].container_object_table.p_object_table[0].object_id;/*get container first child to disp*/ hmi_changed_flag = hmi_get_container_child_id(phmi_object_id); } } else #endif  #if HMI_DXY_BITMAPS_NUMBER > 0  if(HMI_IS_DYN_XY_BITMAP((*phmi_object_id))) {  hmi_changed_flag = TRUE; } else #endif #if HMI_SXY_BITMAPS_NUMBER > 0 if(HMI_IS_S_XY_BITMAP((*phmi_object_id))) {  hmi_changed_flag = TRUE; } else #endif  #if HMI_SXY_CONTAINERS_NUMBER > 0  if(HMI_IS_CONTAINERS_SXY((*phmi_object_id))) { hmi_object_index = HMI_GET_CONTAINERS_SXY_ID_INDEX((*phmi_object_id) ); if(hmi_object_index < HMI_SXY_CONTAINERS_NUMBER) { (*phmi_object_id) = hmi_sxy_container_table[hmi_object_index].container_object_table.p_object_table[0].object_id;/*get container first child to disp*/ hmi_changed_flag = hmi_get_container_child_id(phmi_object_id); } } else #endif  { hmi_changed_flag=FALSE; }  } return hmi_changed_flag; }  static void hmi_cube_get_container_wh(HMI_OBJECT_ID_STR hmi_object_id, HMI_WIDTH_STR *pwidth, HMI_HEIGHT_STR *pheight)  { HMI_OBJECT_ID_STR hmi_object_index = 0; if(hmi_object_id >= HMI_PAGE_SXY_MAX_ID)/*not a page*/ {  #if HMI_DYN_CONTAINERS_NUMBER > 0 if(HMI_IS_DYN_CONTAINER(hmi_object_id)) {  #if HMI_ALL_STATIC_CONTAINERS_NUMBER > 0  hmi_object_id = HMI_GET_DYN_CONTAINERS_ID_INDEX(hmi_object_id); hmi_engine_get_static_container_id(&hmi_object_id);/*get static container ID*/  #if HMI_DXY_CONTAINERS_NUMBER > 0 if(HMI_IS_DYN_XY_CONTAINER(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_XY_CONTAINER_INDEX(hmi_object_id ); if(hmi_object_index < HMI_DXY_CONTAINERS_NUMBER) { *pwidth = hmi_dyn_xy_container_rect[hmi_object_index].w; *pheight= hmi_dyn_xy_container_rect[hmi_object_index].h;  } } else #endif { } #if HMI_SXY_CONTAINERS_NUMBER > 0 if(HMI_IS_CONTAINERS_SXY(hmi_object_id)) { hmi_object_index = HMI_GET_CONTAINERS_SXY_ID_INDEX(hmi_object_id ); if(hmi_object_index < HMI_SXY_CONTAINERS_NUMBER) { *pwidth = hmi_static_container_rect[hmi_object_index].w; *pheight= hmi_static_container_rect[hmi_object_index].h;  } } else #endif { }  #endif } else #endif #if HMI_DXY_CONTAINERS_NUMBER > 0  if(HMI_IS_DYN_XY_CONTAINER(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_XY_CONTAINER_INDEX(hmi_object_id ); if(hmi_object_index < HMI_DXY_CONTAINERS_NUMBER) { *pwidth = hmi_dyn_xy_container_rect[hmi_object_index].w; *pheight= hmi_dyn_xy_container_rect[hmi_object_index].h;  } } else #endif  #if HMI_DXY_BITMAPS_NUMBER > 0  if(HMI_IS_DYN_XY_BITMAP(hmi_object_id)) {  hmi_object_index = HMI_GET_DYN_XY_BITMAP_INDEX(hmi_object_id ); if(hmi_object_index < HMI_DXY_BITMAPS_NUMBER) {  *pwidth = hmi_bmp_dyn_xy_rect[hmi_object_index].w; *pheight= hmi_bmp_dyn_xy_rect[hmi_object_index].h;  } } else #endif #if HMI_SXY_BITMAPS_NUMBER > 0 if(HMI_IS_S_XY_BITMAP(hmi_object_id)) {  hmi_object_index = HMI_GET_SXY_BITMAPS_ID_INDEX(hmi_object_id);  if(hmi_object_index < HMI_SXY_BITMAPS_NUMBER) { *pwidth = hmi_bmp_static_xy_rect[hmi_object_index].w; *pheight= hmi_bmp_static_xy_rect[hmi_object_index].h;  } } else #endif  #if HMI_SXY_CONTAINERS_NUMBER > 0  if(HMI_IS_CONTAINERS_SXY(hmi_object_id)) { hmi_object_index = HMI_GET_CONTAINERS_SXY_ID_INDEX(hmi_object_id ); if(hmi_object_index < HMI_SXY_CONTAINERS_NUMBER) { *pwidth = hmi_static_container_rect[hmi_object_index].w; *pheight= hmi_static_container_rect[hmi_object_index].h; } } else #endif  { ; }  } } #endif  #if((HMI_SXY_CUBE_NUMBER+HMI_DXY_CUBE_NUMBER+HMI_DXY_ROTATION_BITMAPS_NUMBER)> 0) static void hmi_cube_get_container_prop(HMI_OBJECT_ID_STR hmi_object_id, HMI_CUBE_TEXTURE_PROP *pcube_texture, HMI_CUBE_TEXTURE_PROP *pbump_texture, SPOINT_TP *pfather_point)  { #if ((HMI_DYN_CONTAINERS_NUMBER > 0)|| \ (HMI_DXY_CONTAINERS_NUMBER > 0)|| \ (HMI_SXY_CONTAINERS_NUMBER > 0)) HMI_OBJECT_ID_STR hmi_object_index = 0;  #endif if(hmi_object_id >= HMI_PAGE_SXY_MAX_ID)/*not a page*/ {  #if HMI_DYN_CONTAINERS_NUMBER > 0 if(HMI_IS_DYN_CONTAINER(hmi_object_id)) {  #if HMI_ALL_STATIC_CONTAINERS_NUMBER > 0  hmi_object_id = HMI_GET_DYN_CONTAINERS_ID_INDEX(hmi_object_id); hmi_engine_get_static_container_id(&hmi_object_id);/*get static container ID*/  #if HMI_DXY_CONTAINERS_NUMBER>0U if(HMI_IS_DYN_XY_CONTAINER(hmi_object_id)) { hmi_object_index= HMI_GET_DYN_XY_CONTAINER_INDEX(hmi_object_id ); if(hmi_object_index< HMI_DXY_CONTAINERS_NUMBER) { if(pfather_point != NULL) { pfather_point->x += hmi_dyn_xy_container_rect[hmi_object_index].x; pfather_point->y += hmi_dyn_xy_container_rect[hmi_object_index].y; } hmi_cube_get_container_prop(hmi_object_id,pcube_texture,pbump_texture,pfather_point); } } else #endif { } #if HMI_SXY_CONTAINERS_NUMBER>0 if(HMI_IS_CONTAINERS_SXY(hmi_object_id)) { hmi_object_index= HMI_GET_CONTAINERS_SXY_ID_INDEX(hmi_object_id ); if(hmi_object_index< HMI_SXY_CONTAINERS_NUMBER) { if(pfather_point != NULL) { pfather_point->x += hmi_static_container_rect[hmi_object_index].x; pfather_point->y += hmi_static_container_rect[hmi_object_index].y; } hmi_cube_get_container_prop(hmi_object_id,pcube_texture,pbump_texture,pfather_point);  } } else #endif { }  #endif } else #endif #if HMI_DXY_CONTAINERS_NUMBER > 0U  if(HMI_IS_DYN_XY_CONTAINER(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_XY_CONTAINER_INDEX(hmi_object_id ); if(hmi_object_index < HMI_DXY_CONTAINERS_NUMBER) { if(pfather_point != NULL) { pfather_point->x += hmi_dyn_xy_container_rect[hmi_object_index].x; pfather_point->y += hmi_dyn_xy_container_rect[hmi_object_index].y; }  if(hmi_dyn_xy_container_table[hmi_object_index].container_object_table.object_number > 0) { hmi_object_id=hmi_dyn_xy_container_table[hmi_object_index].container_object_table.p_object_table[0].object_id;/*get container first child to disp*/ hmi_cube_get_id_prop(hmi_object_id,pcube_texture,pfather_point); } if(hmi_dyn_xy_container_table[hmi_object_index].container_object_table.object_number > 1) { hmi_object_id=hmi_dyn_xy_container_table[hmi_object_index].container_object_table.p_object_table[1].object_id;/*get container first child to disp*/ hmi_cube_get_id_prop(hmi_object_id,pbump_texture,pfather_point); } } } else #endif  #if HMI_SXY_CONTAINERS_NUMBER > 0  if(HMI_IS_CONTAINERS_SXY(hmi_object_id)) { hmi_object_index = HMI_GET_CONTAINERS_SXY_ID_INDEX(hmi_object_id ); if(hmi_object_index<HMI_SXY_CONTAINERS_NUMBER) { if(pfather_point != NULL) { pfather_point->x += hmi_static_container_rect[hmi_object_index].x; pfather_point->y += hmi_static_container_rect[hmi_object_index].y; } if(hmi_sxy_container_table[hmi_object_index].container_object_table.object_number > 0) { hmi_object_id=hmi_sxy_container_table[hmi_object_index].container_object_table.p_object_table[0].object_id;/*get container first child to disp*/ hmi_cube_get_id_prop(hmi_object_id,pcube_texture,pfather_point); } if(hmi_sxy_container_table[hmi_object_index].container_object_table.object_number > 1) { hmi_object_id=hmi_sxy_container_table[hmi_object_index].container_object_table.p_object_table[1].object_id;/*get container first child to disp*/ hmi_cube_get_id_prop(hmi_object_id,pbump_texture,pfather_point); }  } } else #endif  { hmi_cube_get_id_prop(hmi_object_id,pcube_texture,pfather_point); }  } } #endif  static void hmi_cube_get_container_point(HMI_OBJECT_ID_STR hmi_object_id,  S3POINT_TP *ppoint)  { #if ((HMI_DYN_CONTAINERS_NUMBER > 0)|| \ (HMI_DXY_CONTAINERS_NUMBER > 0)|| \ (HMI_SXY_CONTAINERS_NUMBER > 0)) HMI_OBJECT_ID_STR hmi_object_index = 0;  #endif if((ppoint != NULL)&&(hmi_object_id != HMI_NB_ELEMENTS)) {  #if HMI_DYN_CONTAINERS_NUMBER > 0 if(HMI_IS_DYN_CONTAINER(hmi_object_id)) {  #if HMI_ALL_STATIC_CONTAINERS_NUMBER > 0  hmi_object_id = HMI_GET_DYN_CONTAINERS_ID_INDEX(hmi_object_id); hmi_engine_get_static_container_id(&hmi_object_id);/*get static container ID*/  #if HMI_DXY_CONTAINERS_NUMBER>0U if(HMI_IS_DYN_XY_CONTAINER(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_XY_CONTAINER_INDEX(hmi_object_id ); if(hmi_object_index < HMI_DXY_CONTAINERS_NUMBER) { hmi_cube_get_container_point(hmi_object_id,ppoint); } } else #endif { } #if HMI_SXY_CONTAINERS_NUMBER>0 if(HMI_IS_CONTAINERS_SXY(hmi_object_id)) { hmi_object_index = HMI_GET_CONTAINERS_SXY_ID_INDEX(hmi_object_id ); if(hmi_object_index < HMI_SXY_CONTAINERS_NUMBER) { hmi_cube_get_container_point(hmi_object_id,ppoint);  } } else #endif { }  #endif } else #endif #if HMI_DXY_CONTAINERS_NUMBER > 0U  if(HMI_IS_DYN_XY_CONTAINER(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_XY_CONTAINER_INDEX(hmi_object_id ); if(hmi_object_index < HMI_DXY_CONTAINERS_NUMBER) { if(hmi_dyn_xy_container_table[hmi_object_index].container_object_table.object_number >= 1) { hmi_object_id = hmi_dyn_xy_container_table[hmi_object_index].container_object_table.p_object_table[0].object_id;/*get container first child to disp*/ hmi_cube_get_container_point(hmi_object_id,ppoint);  } } } else #endif  #if HMI_SXY_CONTAINERS_NUMBER > 0  if(HMI_IS_CONTAINERS_SXY(hmi_object_id)) { hmi_object_index = HMI_GET_CONTAINERS_SXY_ID_INDEX(hmi_object_id ); if(hmi_object_index < HMI_SXY_CONTAINERS_NUMBER) { if(hmi_sxy_container_table[hmi_object_index].container_object_table.object_number >= 1) { hmi_object_id = hmi_sxy_container_table[hmi_object_index].container_object_table.p_object_table[0].object_id;/*get container first child to disp*/ hmi_cube_get_container_point(hmi_object_id,ppoint);  } } } else /*image,imagelist,page,fill,scroll bar,text,button*/ #endif  { hmi_cube_get_id_point(hmi_object_id,ppoint); }  } }   #endif static void hmi_engine_draw_container(HMI_CONTAINER_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_container_info,HMI_RECT_STR CONST *pfarther_rect, #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513)) HMI_RECT_STR *pdirty_rect, U08 depth,/*node of page NO*/ HMI_RECT_STR *pcliped_farther_rect #ifdef HMI_GRAPHIC_RGL ,UINT8 father_alpha #endif #elif defined(HMI_GRAPHIC_TWLIB)  HMI_ELEMENT_TYPE parent_object_id_type, HMI_OBJECT_ID_STR hmi_object_id, BOOLEAN bDrawBck #if HMI_RENDER_ALL_EXCEPT_BCK==NO ,HMI_OBJECT_ID_STR parent_object_id ,BOOLEAN only_draw_flag #endif #else  #endif ) REENTRANT  { UINT8 hmi_number_object = phmi_container_info->container_object_table.object_number; HMI_OBJECT_PROP_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_container_object_table= phmi_container_info->container_object_table.p_object_table; #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513)) UINT8 hmi_number_object_const = hmi_number_object; U08 hmi_depth=depth; #endif #if defined(HMI_GRAPHIC_TWLIB) BYTE value_index = 0; BYTE value_beg_bits = 0; BYTE value_imglist = 0; BOOLEAN bRlc = FALSE; HMI_OBJECT_ID_STR hmi_object_id_const=hmi_object_id; #endif   #if defined(HMI_GRAPHIC_TWLIB) /*Draw element background*/ if((!only_draw_flag) #if HMI_RENDER_ALL_EXCEPT_BCK==NO ||(!hmi_is_render_mode()) #endif ) { #if HMI_DXY_PAGES_NUMBER>0 if(HMI_IS_DXY_PAGE(hmi_object_id)) { hmi_object_id=HMI_GET_PAGE_DXY_ID_INDEX(hmi_object_id); if(hmi_object_id<HMI_DXY_PAGES_NUMBER) {  if(bDrawBck) { call_C_hmi_driver_draw_image(pfarther_rect,hmi_dxy_page_table_rlc[hmi_object_id], NULL,&hmi_dxy_page_table_bck[hmi_object_id]/*, TRUE dxy*/,FALSE/*merge*/ #if HMI_RENDER_ALL_EXCEPT_BCK==NO ,parent_object_id ,hmi_object_id_const #endif ); } } } #endif #if HMI_SXY_PAGES_NUMBER>0 if(HMI_IS_SXY_PAGE(hmi_object_id)) { hmi_object_id=HMI_GET_PAGE_SXY_ID_INDEX(hmi_object_id); if(hmi_object_id<HMI_SXY_PAGES_NUMBER) {  if(bDrawBck) { call_C_hmi_driver_draw_image(pfarther_rect,hmi_sxy_page_table_rlc[hmi_object_id], NULL,&hmi_sxy_page_table_bck[hmi_object_id]/*, FALSE dxy*/,FALSE/*merge*/ #if HMI_RENDER_ALL_EXCEPT_BCK==NO ,parent_object_id ,hmi_object_id_const #endif ); } } } #endif  #if HMI_DXY_CONTAINERS_NUMBER>0 if(HMI_IS_DYN_XY_CONTAINER(hmi_object_id)) { hmi_object_id=HMI_GET_DYN_XY_CONTAINER_INDEX(hmi_object_id); if(hmi_object_id<HMI_DXY_CONTAINERS_NUMBER) {  if(bDrawBck) { value_index=(hmi_object_id*HMI_TW_CONTAINER_COMPRESS_MAX_STATUS_BIT_LEN)/8; value_beg_bits=(hmi_object_id*HMI_TW_CONTAINER_COMPRESS_MAX_STATUS_BIT_LEN)%8; value_imglist=hmi_dyn_xy_container_compress[value_index]; value_imglist=value_imglist<<(8-(value_beg_bits+HMI_TW_CONTAINER_COMPRESS_MAX_STATUS_BIT_LEN)); value_imglist=value_imglist>>(8-HMI_TW_CONTAINER_COMPRESS_MAX_STATUS_BIT_LEN); bRlc=value_imglist; call_C_hmi_driver_draw_image(pfarther_rect,bRlc/*rlc*/,NULL, (HMI_BITMAP_STR*)(&hmi_dyn_xy_container_table_bck[hmi_object_id])/*, TRUE*/,FALSE #if HMI_RENDER_ALL_EXCEPT_BCK==NO ,parent_object_id ,hmi_object_id_const #endif ); } } } #endif  #if HMI_SXY_CONTAINERS_NUMBER>0 if(HMI_IS_CONTAINERS_SXY(hmi_object_id)) { hmi_object_id=HMI_GET_CONTAINERS_SXY_ID_INDEX(hmi_object_id); if(hmi_object_id<HMI_SXY_CONTAINERS_NUMBER) { if(bDrawBck) { value_index=(hmi_object_id*HMI_TW_CONTAINER_COMPRESS_MAX_STATUS_BIT_LEN)/8; value_beg_bits=(hmi_object_id*HMI_TW_CONTAINER_COMPRESS_MAX_STATUS_BIT_LEN)%8; value_imglist=hmi_static_container_compress[value_index]; value_imglist=value_imglist<<(8-(value_beg_bits+HMI_TW_CONTAINER_COMPRESS_MAX_STATUS_BIT_LEN)); value_imglist=value_imglist>>(8-HMI_TW_CONTAINER_COMPRESS_MAX_STATUS_BIT_LEN); bRlc=value_imglist; call_C_hmi_driver_draw_image(pfarther_rect,bRlc/*rlc*/,NULL, &hmi_sxy_container_table_bck[hmi_object_id]/*, FALSE*/,FALSE #if HMI_RENDER_ALL_EXCEPT_BCK==NO ,parent_object_id ,hmi_object_id_const #endif ); } } } #endif  }  else /*refresh page*/ { #if HMI_DXY_PAGES_NUMBER>0 if(HMI_IS_DXY_PAGE(hmi_object_id)) {  } #endif #if HMI_SXY_PAGES_NUMBER>0 if(HMI_IS_SXY_PAGE(hmi_object_id)) {  } #endif  } #endif /*HMI_GRAPHIC_TWLIB*/ /*draw element*/ while(hmi_number_object > 0)  { #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513)) if(hmi_depth == HMI_PAGE_BEGIN_DEPTH)/*search tree from page node*/ { depth = (hmi_number_object_const-hmi_number_object);/*node of page no*/ } hmi_engine_draw_object(phmi_container_object_table++, (HMI_RECT_STR CONST *)pfarther_rect, pdirty_rect, depth, pcliped_farther_rect #ifdef HMI_GRAPHIC_RGL ,father_alpha #endif ); #else /*tw*/ hmi_engine_draw_object(phmi_container_object_table++, (HMI_RECT_STR CONST *)pfarther_rect,parent_object_id_type #if HMI_RENDER_ALL_EXCEPT_BCK==NO  ,hmi_object_id_const ,only_draw_flag #endif ); #endif hmi_number_object--; } }   static void hmi_engine_draw_object(HMI_OBJECT_PROP_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_object_prop_table,HMI_RECT_STR CONST *pfarther_rect, #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513)) HMI_RECT_STR *pdirty_rect, U08 depth, HMI_RECT_STR *pcliped_farther_rect #ifdef HMI_GRAPHIC_RGL ,UINT8 father_alpha #endif #else /*tw*/ HMI_ELEMENT_TYPE parent_object_id_type #if HMI_RENDER_ALL_EXCEPT_BCK==NO  ,HMI_OBJECT_ID_STR parent_object_id ,BOOLEAN only_draw_flag #endif #endif ) REENTRANT { HMI_OBJECT_ID_STR hmi_object_id = phmi_object_prop_table->object_id; HMI_OBJECT_ID_STR hmi_object_index = 0; #if HMI_DXY_ROTATION_BITMAPS_NUMBER > 0 HMI_OBJECT_ID_STR hmi_object_index2 = 0; HMI_ROTATION_TRAIL_STR trail_info = {0}; BOOLEAN hmi_trail_get_id_flag = FALSE; HMI_ROTATION_STR rotation = {0,0}; #endif HMI_RECT_STR hmi_rect_temp = {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0}; #if ((HMI_DXY_IMAGELIST_NUMBER > 0U) \ ||(HMI_SXY_IMAGELIST_NUMBER > 0U) \ ||(HMI_DXY_SCROLLBAR_NUMBER > 0U) \ ||(HMI_SXY_SCROLLBAR_NUMBER > 0U) \ ||(HMI_DXY_BUTTON_NUMBER > 0U) \ ||(HMI_SXY_BUTTON_NUMBER > 0U)) BYTE value_index = 0; BYTE value_beg_bits = 0; BYTE value_imglist = 0; #endif #if ((HMI_DYN_EDIT_TEXTS_NUMBER > 0U) || (HMI_STATIC_TEXTS_NUMBER > 0U)) HMI_TEXT_RECT_STR text_prop = {{HMI_INVALID_COOR,HMI_INVALID_COOR,0,0},0}; U08 font_id = HMI_INVALIATE_FONT_ID; #endif HMI_RECT_STR hmi_screen_rect = {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0}; HMI_RECT_STR hmi_clip_rect = {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0};/*clip zone*/  #if (HMI_STATIC_TEXTS_NUMBER > 0U) HMI_TEXT_PROP_STR text_info = {0,0,0,NULL}; HMI_CHAR_STR **pp_str_list = NULL; #endif #if ((HMI_STATIC_GFILL_NUMBER + HMI_DYN_GFILL_NUMBER+ \ HMI_STATIC_FILL_PAGES_NUMBER + HMI_DYN_FILL_PAGES_NUMBER+ \ HMI_DYN_EDIT_TEXTS_NUMBER) > 0)  UINT8 hmi_alpha = 0; #endif #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513))  HMI_RECT_STR new_cliped_farther_rect= {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0};  #else /*tw*/ BOOLEAN bMerge = FALSE;  BOOLEAN flag = FALSE;  HMI_OBJECT_ID_STR hmi_object_id_const = hmi_object_id; #endif #if defined(HMI_GRAPHIC_RGL) #if ((HMI_DXY_CUBE_NUMBER+HMI_SXY_CUBE_NUMBER) > 0) HMI_CUBE_FACE_STR hmi_cube_textrue = {0}; HMI_CUBE_FACE_STR hmi_bump_textrue = {0};  #endif  #if HMI_DXY_ROTATION_BITMAPS_NUMBER > 0  HMI_CUBE_TEXTURE_PROP image_trail_texture = {0}; HMI_CUBE_TEXTURE_PROP image_trail_bump_texture= {0}; HMI_OBJECT_ID_STR hmi_trail_id =HMI_NB_ELEMENTS; SPOINT_TP trail_point ={0}; HMI_RECT_STR trail_rect ={0};  #endif #if ((HMI_DXY_CUBE_NUMBER+HMI_SXY_CUBE_NUMBER) > 0) S3POINT_TP axis[HMI_ROTATION_AXIS_CNT] = {{0,0,0},{0,0,0},{0,0,0}}; #endif #endif  if(hmi_object_id >= HMI_PAGE_SXY_MAX_ID)/*not a page*/ {  #if HMI_ALL_DYN_OBJECTS_NUMBER > 0U if(hmi_object_id < HMI_ALL_DYN_OBJECTS_NUMBER) {  #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513)) HMI_DYNAMIC_OBJECT_CANCEL_CHANGED_FLAG(hmi_object_id );/*clear refresh flag*/ #else /*tw8836*/ flag = HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_object_id); #if HMI_RENDER_ALL_EXCEPT_BCK==NO if(hmi_is_render_mode())/*only render ,clear the flag*/ { HMI_DYNAMIC_OBJECT_CANCEL_CHANGED_FLAG(hmi_object_id );/*clear refresh flag*/ } #endif #endif } #endif #if HMI_DXY_IMAGELIST_NUMBER>0 if(hmi_object_id < HMI_DYN_IMAGELIST_DXY_MAX_ID) { hmi_object_index = HMI_GET_DYN_IMAGELIST_DXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_DXY_IMAGELIST_NUMBER) { hmi_rect_temp.x = hmi_dxy_imagelist_rect[hmi_object_index].x; hmi_rect_temp.y = hmi_dxy_imagelist_rect[hmi_object_index].y; hmi_rect_temp.w = hmi_dxy_imagelist_rect[hmi_object_index].w; hmi_rect_temp.h = hmi_dxy_imagelist_rect[hmi_object_index].h;  HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_rect_temp), (&(hmi_screen_rect))); #if (defined(HMI_GRAPHIC_RGL)) /*element draw rect backups*/ hmi_dxy_imagelist_rect_bck[hmi_object_index].x = hmi_rect_temp.x; hmi_dxy_imagelist_rect_bck[hmi_object_index].y = hmi_rect_temp.y; hmi_dxy_imagelist_rect_bck[hmi_object_index].w = hmi_rect_temp.w; hmi_dxy_imagelist_rect_bck[hmi_object_index].h = hmi_rect_temp.h; #endif } #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513)) hmi_get_intersec_rect((HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_screen_rect, &(new_cliped_farther_rect )); hmi_get_intersec_rect_depth((HMI_RECT_STR CONST *)(&(new_cliped_farther_rect)), depth,(HMI_RECT_STR *)pdirty_rect,&hmi_clip_rect);  #endif  #ifdef HMI_GRAPHIC_AGG call_C_hmi_driver_draw_imagelist(&(hmi_screen_rect), hmi_dxy_imglist_attr_table[hmi_object_index], &hmi_dxy_imagelist_table[hmi_object_index], hmi_dxy_imagelist_index[hmi_object_index], &hmi_clip_rect); /*Container*/ #endif  #ifdef HMI_GRAPHIC_RGL if(hmi_object_index < HMI_DXY_IMAGELIST_NUMBER) { if((hmi_clip_rect.x != HMI_INVALID_COOR)|| (hmi_clip_rect.y != HMI_INVALID_COOR)) { value_index = (hmi_object_index*HMI_IMGLIST_MAX_STATUS_BIT_LEN)>>3/*/8*/; value_beg_bits = (hmi_object_index*HMI_IMGLIST_MAX_STATUS_BIT_LEN)&0x07/*%8*/; value_imglist = hmi_dxy_imagelist_index[value_index]; value_imglist = value_imglist<<(8-(value_beg_bits+HMI_IMGLIST_MAX_STATUS_BIT_LEN)); value_imglist = value_imglist>>(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN);  call_C_hmi_driver_draw_imagelist(&(hmi_screen_rect)/*node screen position*/,  hmi_dxy_imglist_attr_table[hmi_object_index]/*compress fmt*/, &hmi_dxy_imagelist_rect[hmi_object_index]/*alpha*/, &hmi_dxy_imagelist_table[hmi_object_index], value_imglist, &hmi_clip_rect, pdirty_rect, depth, hmi_object_id, father_alpha); if(father_alpha > hmi_dxy_imagelist_rect[hmi_object_index].alpha) { father_alpha = hmi_dxy_imagelist_rect[hmi_object_index].alpha; } hmi_engine_draw_container(&hmi_dxy_imagelist_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&(hmi_screen_rect)), pdirty_rect, depth, &new_cliped_farther_rect/*all father insection zone*/ ,father_alpha ); } } #endif #ifdef HMI_GRAPHIC_ST7513 if(hmi_object_index < HMI_DXY_IMAGELIST_NUMBER) { value_index = (hmi_object_index*HMI_IMGLIST_MAX_STATUS_BIT_LEN)>>3/*/8*/; value_beg_bits = (hmi_object_index*HMI_IMGLIST_MAX_STATUS_BIT_LEN)&0x07/*%8*/; value_imglist = hmi_dxy_imagelist_index[value_index]; value_imglist = value_imglist<<(8-(value_beg_bits+HMI_IMGLIST_MAX_STATUS_BIT_LEN)); value_imglist = value_imglist>>(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN);  call_C_hmi_driver_draw_imagelist((HMI_RECT_STR CONST *)(&(hmi_screen_rect))/*node screen position*/,  (HMI_IMAGE_LIST_STR CONST *)(&hmi_dxy_imagelist_table[hmi_object_index]), value_imglist, &hmi_clip_rect); hmi_engine_draw_container(&hmi_dxy_imagelist_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&((hmi_screen_rect))/*new parent zone*/), pdirty_rect, depth, &new_cliped_farther_rect/*all father insection zone*/); } #endif #ifdef HMI_GRAPHIC_TWLIB  bMerge = hmi_get_is_merge(parent_object_id_type,HMI_ELEM_TYPE_DIMGLIST);  value_index = (hmi_object_index*HMI_IMGLIST_MAX_STATUS_BIT_LEN)/8; value_beg_bits = (hmi_object_index*HMI_IMGLIST_MAX_STATUS_BIT_LEN)%8; value_imglist = hmi_dxy_imagelist_index[value_index]; value_imglist = value_imglist<<(8-(value_beg_bits+HMI_IMGLIST_MAX_STATUS_BIT_LEN)); value_imglist = value_imglist>>(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN);  #if HMI_RENDER_ALL_EXCEPT_BCK==NO if(((!only_draw_flag)||!hmi_is_render_mode())||/*simulate*/ (only_draw_flag&&(flag))) #endif { call_C_hmi_driver_draw_imagelist(&(hmi_screen_rect), (HMI_RECT_ALPHA_STR *)(&hmi_dxy_imagelist_rect[hmi_object_index]), &hmi_dxy_imagelist_table[hmi_object_index], value_imglist/*, TRUE dxy*/,bMerge,FALSE/*Button*/ #if HMI_RENDER_ALL_EXCEPT_BCK==NO ,parent_object_id ,hmi_object_id_const #endif );  } if(hmi_dxy_imagelist_container_table[hmi_object_index].container_object_table.object_number>0) { hmi_engine_draw_container(&(hmi_dxy_imagelist_container_table[hmi_object_index]), (HMI_RECT_STR CONST *)(&(hmi_screen_rect)), HMI_ELEM_TYPE_DIMGLIST, hmi_object_id_const, FALSE #if HMI_RENDER_ALL_EXCEPT_BCK==NO ,phmi_object_prop_table->object_id  ,only_draw_flag&&(!flag) #endif ); } #endif  }  else #endif #if HMI_SXY_IMAGELIST_NUMBER > 0 if(hmi_object_id < HMI_DYN_IMAGELIST_SXY_MAX_ID) { hmi_object_index = HMI_GET_DYN_IMAGELIST_SXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_SXY_IMAGELIST_NUMBER) { hmi_rect_temp.x = hmi_sxy_imagelist_rect[hmi_object_index].x; hmi_rect_temp.y = hmi_sxy_imagelist_rect[hmi_object_index].y; hmi_rect_temp.w = hmi_sxy_imagelist_rect[hmi_object_index].w; hmi_rect_temp.h = hmi_sxy_imagelist_rect[hmi_object_index].h; HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_rect_temp), (&hmi_screen_rect));  } #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513))  hmi_get_intersec_rect((HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_screen_rect, &(new_cliped_farther_rect ));  hmi_get_intersec_rect_depth((HMI_RECT_STR CONST *)(&(new_cliped_farther_rect)), depth,(HMI_RECT_STR *)pdirty_rect,&hmi_clip_rect);  #endif #ifdef HMI_GRAPHIC_AGG call_C_hmi_driver_draw_imagelist(&(hmi_screen_rect), hmi_bigbitmap_table[0],hmi_bigbitmap_table[1], &hmi_sxy_imagelist_table[hmi_object_index], hmi_sxy_imagelist_index[hmi_object_index], &hmi_clip_rect); hmi_engine_draw_container(&hmi_sxy_imagelist_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&(hmi_screen_rect)), pdirty_rect,depth,&new_cliped_farther_rect/*all father insection zone*/); #endif  #ifdef HMI_GRAPHIC_RGL if(hmi_object_index < HMI_SXY_IMAGELIST_NUMBER) { if((hmi_clip_rect.x != HMI_INVALID_COOR)|| (hmi_clip_rect.y != HMI_INVALID_COOR)) { value_index = (hmi_object_index*HMI_IMGLIST_MAX_STATUS_BIT_LEN)>>3/*/8*/; value_beg_bits = (hmi_object_index*HMI_IMGLIST_MAX_STATUS_BIT_LEN)&0x07/*%8*/; value_imglist = hmi_sxy_imagelist_index[value_index]; value_imglist = value_imglist<<(8-(value_beg_bits+HMI_IMGLIST_MAX_STATUS_BIT_LEN)); value_imglist = value_imglist>>(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN);  call_C_hmi_driver_draw_imagelist(&(hmi_screen_rect)/*node screen position*/, hmi_sxy_imglist_attr_table[hmi_object_index], (HMI_RECT_ALPHA_STR *)(&hmi_sxy_imagelist_rect[hmi_object_index]), &hmi_sxy_imagelist_table[hmi_object_index], value_imglist, &hmi_clip_rect, pdirty_rect, depth, hmi_object_id, father_alpha); if(father_alpha>hmi_sxy_imagelist_rect[hmi_object_index].alpha) { father_alpha=hmi_sxy_imagelist_rect[hmi_object_index].alpha; } hmi_engine_draw_container(&hmi_sxy_imagelist_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&(hmi_screen_rect)), pdirty_rect,depth, &new_cliped_farther_rect/*all father insection zone*/ ,father_alpha);  } } #endif #ifdef HMI_GRAPHIC_ST7513 if(hmi_object_index < HMI_SXY_IMAGELIST_NUMBER) { value_index = (hmi_object_index*HMI_IMGLIST_MAX_STATUS_BIT_LEN)>>3/*/8*/; value_beg_bits = (hmi_object_index*HMI_IMGLIST_MAX_STATUS_BIT_LEN)&0x07/*%8*/; value_imglist = hmi_sxy_imagelist_index[value_index]; value_imglist = value_imglist<<(8-(value_beg_bits+HMI_IMGLIST_MAX_STATUS_BIT_LEN)); value_imglist = value_imglist>>(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN);  call_C_hmi_driver_draw_imagelist(&(hmi_screen_rect)/*node screen position*/,  &hmi_sxy_imagelist_table[hmi_object_index], value_imglist, &hmi_clip_rect); hmi_engine_draw_container(&(hmi_sxy_imagelist_container_table[hmi_object_index]), (HMI_RECT_STR CONST *)(&(hmi_screen_rect)), pdirty_rect,depth,&new_cliped_farther_rect/*all father insection zone*/); } #endif  #ifdef HMI_GRAPHIC_TWLIB  if(hmi_object_index < HMI_SXY_IMAGELIST_NUMBER) { bMerge = hmi_get_is_merge(parent_object_id_type,HMI_ELEM_TYPE_SIMGLIST); value_index = (hmi_object_index*HMI_IMGLIST_MAX_STATUS_BIT_LEN)>>3/*/8*/; value_beg_bits = (hmi_object_index*HMI_IMGLIST_MAX_STATUS_BIT_LEN)&0x07/*%8*/; value_imglist = hmi_sxy_imagelist_index[value_index]; value_imglist = value_imglist<<(8-(value_beg_bits+HMI_IMGLIST_MAX_STATUS_BIT_LEN)); value_imglist = value_imglist>>(8-HMI_IMGLIST_MAX_STATUS_BIT_LEN); #if HMI_RENDER_ALL_EXCEPT_BCK==NO if(((!only_draw_flag)||!hmi_is_render_mode())||/*simulate*/ (only_draw_flag&&(flag))) #endif { call_C_hmi_driver_draw_imagelist(&(hmi_screen_rect),(HMI_RECT_ALPHA_STR *)(&hmi_sxy_imagelist_rect[hmi_object_index]), &hmi_sxy_imagelist_table[hmi_object_index], value_imglist/*, FALSE dxy*/,bMerge,FALSE/*Button*/ #if HMI_RENDER_ALL_EXCEPT_BCK==NO ,parent_object_id ,hmi_object_id_const #endif );  } if(hmi_sxy_imagelist_container_table[hmi_object_index].container_object_table.object_number>0) { hmi_engine_draw_container(&(hmi_sxy_imagelist_container_table[hmi_object_index]), (HMI_RECT_STR CONST *)(&(hmi_screen_rect)), HMI_ELEM_TYPE_SIMGLIST, hmi_object_id_const, FALSE #if HMI_RENDER_ALL_EXCEPT_BCK==NO ,phmi_object_prop_table->object_id  ,only_draw_flag&&(!flag) #endif );  } } #endif  } else #endif  #if HMI_DXY_SCROLLBAR_NUMBER>0 if(hmi_object_id < HMI_DYN_SCROLLBAR_DXY_MAX_ID) { hmi_object_index = HMI_GET_DYN_SCROLLBAR_DXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_DXY_SCROLLBAR_NUMBER) { hmi_rect_temp.x = hmi_dxy_scrollbar_rect[hmi_object_index].x; hmi_rect_temp.y = hmi_dxy_scrollbar_rect[hmi_object_index].y; hmi_rect_temp.w = hmi_dxy_scrollbar_rect[hmi_object_index].w; hmi_rect_temp.h = hmi_dxy_scrollbar_rect[hmi_object_index].h; HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_rect_temp), (&(hmi_screen_rect))); #if (defined(HMI_GRAPHIC_RGL)) /*element draw rect backups*/ hmi_dxy_scrollbar_rect_bck[hmi_object_index].x = hmi_rect_temp.x; hmi_dxy_scrollbar_rect_bck[hmi_object_index].y = hmi_rect_temp.y; hmi_dxy_scrollbar_rect_bck[hmi_object_index].w = hmi_rect_temp.w; hmi_dxy_scrollbar_rect_bck[hmi_object_index].h = hmi_rect_temp.h; #endif } #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513)) hmi_get_intersec_rect((HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_screen_rect, &(new_cliped_farther_rect ));  hmi_get_intersec_rect_depth((HMI_RECT_STR CONST *)(&(new_cliped_farther_rect)), depth,(HMI_RECT_STR *)pdirty_rect,&hmi_clip_rect);  #endif #ifdef HMI_GRAPHIC_AGG call_C_hmi_driver_draw_scrollbar(&(hmi_screen_rect), hmi_bigbitmap_table[0],hmi_bigbitmap_table[1], &hmi_dxy_scrollbar_table[hmi_object_index], hmi_dxy_scrollbar_cur_range[hmi_object_index], &hmi_clip_rect); hmi_engine_draw_container(&hmi_dxy_scrollbar_container_table[hmi_object_index], (HMI_RECT_STR CONST *)&(hmi_screen_rect ), pdirty_rect,depth, &new_cliped_farther_rect/*all father insection zone*/); #endif  #ifdef HMI_GRAPHIC_RGL #if HMI_SCROLLBAR_MAX_STATUS >= 0 if((hmi_clip_rect.x != HMI_INVALID_COOR)|| (hmi_clip_rect.y != HMI_INVALID_COOR)) { value_index = (hmi_object_index*HMI_SCROLLBAR_MAX_STATUS_BIT_LEN)>>3/*/8*/; value_beg_bits = (hmi_object_index*HMI_SCROLLBAR_MAX_STATUS_BIT_LEN)&0x07/*%8*/; value_imglist = hmi_dxy_scrollbar_cur_range[value_index]; value_imglist = value_imglist<<(8-(value_beg_bits+HMI_SCROLLBAR_MAX_STATUS_BIT_LEN)); value_imglist = value_imglist>>(8-HMI_SCROLLBAR_MAX_STATUS_BIT_LEN); if(hmi_object_index < HMI_DXY_SCROLLBAR_NUMBER) { call_C_hmi_driver_draw_scrollbar(&(hmi_screen_rect)/*node screen position*/, hmi_dxy_scrollbar_attr_table[hmi_object_index]/*image format*/,  value_imglist/*current value*/, &hmi_clip_rect, pdirty_rect/*clip zone*/, (HMI_SCROLL_BAR_STR *)&hmi_dxy_scrollbar_table[hmi_object_index]/*scrollbar info*/, depth/*gdi layer*/, hmi_object_id, father_alpha); hmi_engine_draw_container(&hmi_dxy_scrollbar_container_table[hmi_object_index], (HMI_RECT_STR CONST *)&(hmi_screen_rect ),pdirty_rect,depth, &new_cliped_farther_rect/*all father insection zone*/ ,father_alpha); } }  #endif #endif  #ifdef HMI_GRAPHIC_ST7513 #if HMI_SCROLLBAR_MAX_STATUS >= 0 value_index = (hmi_object_index*HMI_SCROLLBAR_MAX_STATUS_BIT_LEN)>>3/*/8*/; value_beg_bits = (hmi_object_index*HMI_SCROLLBAR_MAX_STATUS_BIT_LEN)&0x07/*%8*/; value_imglist = hmi_dxy_scrollbar_cur_range[value_index]; value_imglist = value_imglist<<(8-(value_beg_bits+HMI_SCROLLBAR_MAX_STATUS_BIT_LEN)); value_imglist = value_imglist>>(8-HMI_SCROLLBAR_MAX_STATUS_BIT_LEN); if(hmi_object_index < HMI_DXY_SCROLLBAR_NUMBER) { call_C_hmi_driver_draw_scrollbar( (HMI_RECT_STR CONST *)(&(hmi_screen_rect))/*node screen position*/,  value_imglist/*current value*/, &hmi_clip_rect/*clip zone*/, (HMI_SCROLL_BAR_STR *)(&hmi_dxy_scrollbar_table[hmi_object_index])/*scrollbar info*/) ;  hmi_engine_draw_container(&hmi_sxy_scrollbar_container_table[hmi_object_index], (HMI_RECT_STR CONST *)&(hmi_screen_rect),pdirty_rect,depth, &new_cliped_farther_rect/*all father insection zone*/); } #endif #endif #ifdef HMI_GRAPHIC_TWLIB /*tw not support scrollbar*/ #endif  } else  #endif #if HMI_SXY_SCROLLBAR_NUMBER>0 if(hmi_object_id < HMI_DYN_SCROLLBAR_SXY_MAX_ID) { hmi_object_index = HMI_GET_DYN_SCROLLBAR_SXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_SXY_SCROLLBAR_NUMBER) { hmi_rect_temp.x = hmi_sxy_scrollbar_rect[hmi_object_index].x; hmi_rect_temp.y = hmi_sxy_scrollbar_rect[hmi_object_index].y; hmi_rect_temp.w = hmi_sxy_scrollbar_rect[hmi_object_index].w; hmi_rect_temp.h = hmi_sxy_scrollbar_rect[hmi_object_index].h; HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_rect_temp), (&(hmi_screen_rect)));  } #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513)) hmi_get_intersec_rect((HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_screen_rect, &(new_cliped_farther_rect )); hmi_get_intersec_rect_depth((HMI_RECT_STR CONST *)(&(new_cliped_farther_rect)), depth,(HMI_RECT_STR *)pdirty_rect,&hmi_clip_rect);  #endif #ifdef HMI_GRAPHIC_AGG call_C_hmi_driver_draw_scrollbar(&(hmi_screen_rect), hmi_bigbitmap_table[0],hmi_bigbitmap_table[1], &hmi_sxy_scrollbar_table[hmi_object_index], hmi_sxy_scrollbar_cur_range[hmi_object_index], &hmi_clip_rect); hmi_engine_draw_container(&hmi_sxy_scrollbar_container_table[hmi_object_index], (HMI_RECT_STR CONST *)&(hmi_screen_rect), pdirty_rect); #endif  #ifdef HMI_GRAPHIC_RGL #if HMI_SCROLLBAR_MAX_STATUS >= 0 if((hmi_clip_rect.x != HMI_INVALID_COOR)|| (hmi_clip_rect.y != HMI_INVALID_COOR)) { value_index = (hmi_object_index*HMI_SCROLLBAR_MAX_STATUS_BIT_LEN)>>3/*/8*/; value_beg_bits = (hmi_object_index*HMI_SCROLLBAR_MAX_STATUS_BIT_LEN)&0x07/*%8*/; value_imglist = hmi_sxy_scrollbar_cur_range[value_index]; value_imglist = value_imglist<<(8-(value_beg_bits+HMI_SCROLLBAR_MAX_STATUS_BIT_LEN)); value_imglist = value_imglist>>(8-HMI_SCROLLBAR_MAX_STATUS_BIT_LEN);  if(hmi_object_index < HMI_SXY_SCROLLBAR_NUMBER) { call_C_hmi_driver_draw_scrollbar(&(hmi_screen_rect)/*node screen position*/, hmi_sxy_scrollbar_attr_table[hmi_object_index]/*image format*/,  value_imglist/*current value*/, &hmi_clip_rect, pdirty_rect/*clip zone*/, (HMI_SCROLL_BAR_STR *)(&hmi_sxy_scrollbar_table[hmi_object_index])/*scrollbar info*/, depth/*gdi layer*/, hmi_object_id, father_alpha); hmi_engine_draw_container(&hmi_sxy_scrollbar_container_table[hmi_object_index], (HMI_RECT_STR CONST *)&(hmi_screen_rect ),pdirty_rect,depth, &new_cliped_farther_rect/*all father insection zone*/, father_alpha); } } #endif #endif  #ifdef HMI_GRAPHIC_ST7513 #if HMI_SCROLLBAR_MAX_STATUS >= 0 value_index = (hmi_object_index*HMI_SCROLLBAR_MAX_STATUS_BIT_LEN)>>3/*/8*/; value_beg_bits = (hmi_object_index*HMI_SCROLLBAR_MAX_STATUS_BIT_LEN)&0x07/*%8*/; value_imglist = hmi_sxy_scrollbar_cur_range[value_index]; value_imglist = value_imglist<<(8-(value_beg_bits+HMI_SCROLLBAR_MAX_STATUS_BIT_LEN)); value_imglist = value_imglist>>(8-HMI_SCROLLBAR_MAX_STATUS_BIT_LEN); if(hmi_object_index < HMI_SXY_SCROLLBAR_NUMBER) { call_C_hmi_driver_draw_scrollbar((HMI_RECT_STR CONST *)(&(hmi_screen_rect))/*node screen position*/,  value_imglist/*current value*/, &hmi_clip_rect/*clip zone*/, (HMI_SCROLL_BAR_STR *)(&hmi_sxy_scrollbar_table[hmi_object_index])/*scrollbar info*/);  hmi_engine_draw_container((HMI_CONTAINER_STR CONST *)(&hmi_sxy_scrollbar_container_table[hmi_object_index]), (HMI_RECT_STR CONST *)(&(hmi_screen_rect )),pdirty_rect,depth, &new_cliped_farther_rect/*all father insection zone*/); } #endif #endif  #ifdef HMI_GRAPHIC_TWLIB /* call_C_hmi_driver_draw_scrollbar(&(text_prop.text_rect),hmi_bigbitmap_table[0],hmi_bigbitmap_table[1],&hmi_sxy_scrollbar_table[hmi_object_id],hmi_sxy_scrollbar_cur_range[hmi_object_id],&hmi_draw_rect); hmi_engine_draw_container(&hmi_sxy_scrollbar_container_table[hmi_object_id],(HMI_RECT_STR CONST *)&(text_prop.text_rect),HMI_SSCROLLBAR ,pdirty_rect); HMI_Data/ HMI_Source/ HMI_Tool/ /*tw not support scrollbar*/ #endif  } else #endif #if HMI_DXY_BUTTON_NUMBER > 0  if(hmi_object_id < HMI_DYN_BUTTON_DXY_MAX_ID) { hmi_object_index = HMI_GET_DYN_BUTTON_DXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_DXY_BUTTON_NUMBER) { hmi_rect_temp.x = hmi_dxy_button_rect[hmi_object_index].x; hmi_rect_temp.y = hmi_dxy_button_rect[hmi_object_index].y; hmi_rect_temp.w = hmi_dxy_button_rect[hmi_object_index].w; hmi_rect_temp.h = hmi_dxy_button_rect[hmi_object_index].h; HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_rect_temp), (&(hmi_screen_rect))); #if (defined(HMI_GRAPHIC_RGL)) /*element draw rect backups*/ hmi_dxy_button_rect_bck[hmi_object_index].x = hmi_rect_temp.x; hmi_dxy_button_rect_bck[hmi_object_index].y = hmi_rect_temp.y; hmi_dxy_button_rect_bck[hmi_object_index].w = hmi_rect_temp.w; hmi_dxy_button_rect_bck[hmi_object_index].h = hmi_rect_temp.h; #endif } #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513)) hmi_get_intersec_rect((HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_screen_rect, &(new_cliped_farther_rect )); hmi_get_intersec_rect_depth((HMI_RECT_STR CONST *)(&(new_cliped_farther_rect)), depth,(HMI_RECT_STR *)pdirty_rect,&hmi_clip_rect);  #endif #ifdef HMI_GRAPHIC_AGG call_C_hmi_driver_draw_imagelist(&(hmi_screen_rect), hmi_bigbitmap_table[0],hmi_bigbitmap_table[1], &hmi_dxy_button_table[hmi_object_index].button_image, hmi_dxy_button_press_status[hmi_object_index], &hmi_clip_rect);  hmi_engine_draw_container(&hmi_dxy_button_container_table[hmi_object_index], (HMI_RECT_STR CONST *)&(hmi_screen_rect ), ,pdirty_rect,depth,&new_cliped_farther_rect/*all father insection zone*/); #endif   #ifdef HMI_GRAPHIC_RGL  if(hmi_object_index < HMI_DXY_BUTTON_NUMBER) { #if HMI_BTN_MAX_STATUS > 0 if((hmi_clip_rect.x != HMI_INVALID_COOR)|| (hmi_clip_rect.y != HMI_INVALID_COOR)) { value_index = (hmi_object_index*HMI_BTN_MAX_STATUS_BIT_LEN)>>3/*/8*/; value_beg_bits = (hmi_object_index*HMI_BTN_MAX_STATUS_BIT_LEN)&0x07/*%8*/; value_imglist = hmi_dxy_button_press_status[value_index];  value_imglist = value_imglist<<(8-(value_beg_bits+HMI_BTN_MAX_STATUS_BIT_LEN)); value_imglist = value_imglist>>(8-HMI_BTN_MAX_STATUS_BIT_LEN); call_C_hmi_driver_draw_imagelist(&(hmi_screen_rect), hmi_dxy_button_attr_table[hmi_object_index], (HMI_RECT_ALPHA_STR *)(&hmi_dxy_button_rect[hmi_object_index]), &(hmi_dxy_button_table[hmi_object_index].button_image), value_imglist, &hmi_clip_rect, pdirty_rect, depth, hmi_object_id, father_alpha); if(father_alpha > hmi_dxy_button_rect[hmi_object_index].alpha) { father_alpha = hmi_dxy_button_rect[hmi_object_index].alpha; } hmi_engine_draw_container(&(hmi_dxy_button_container_table[hmi_object_index]), (HMI_RECT_STR CONST *)(&(hmi_screen_rect )), pdirty_rect, depth,&new_cliped_farther_rect/*all father insection zone*/ ,father_alpha); } #endif } #endif  #ifdef HMI_GRAPHIC_ST7513  if(hmi_object_index < HMI_DXY_BUTTON_NUMBER) { #if HMI_BTN_MAX_STATUS > 0 value_index = (hmi_object_index*HMI_BTN_MAX_STATUS_BIT_LEN)>>3/*/8*/; value_beg_bits = (hmi_object_index*HMI_BTN_MAX_STATUS_BIT_LEN)&0x07/*%8*/; value_imglist = hmi_dxy_button_press_status[value_index];  value_imglist = value_imglist<<(8-(value_beg_bits+HMI_BTN_MAX_STATUS_BIT_LEN)); value_imglist = value_imglist>>(8-HMI_BTN_MAX_STATUS_BIT_LEN); call_C_hmi_driver_draw_imagelist(&(hmi_screen_rect),  &(hmi_dxy_button_table[hmi_object_index].button_image), value_imglist, &hmi_clip_rect);  hmi_engine_draw_container(&(hmi_dxy_button_container_table[hmi_object_index]), (HMI_RECT_STR CONST *)(&(hmi_screen_rect )), pdirty_rect, depth,&new_cliped_farther_rect/*all father insection zone*/); #endif } #endif  #ifdef HMI_GRAPHIC_TWLIB  if(hmi_object_index < HMI_DXY_BUTTON_NUMBER) { #if HMI_BTN_MAX_STATUS > 0 bMerge = hmi_get_is_merge(parent_object_id_type,HMI_ELEM_TYPE_DBTN); value_index = (hmi_object_index*HMI_BTN_MAX_STATUS_BIT_LEN)/8; value_beg_bits = (hmi_object_index*HMI_BTN_MAX_STATUS_BIT_LEN)%8; value_imglist = hmi_dxy_button_press_status[value_index]; value_imglist = value_imglist<<(8-(value_beg_bits+HMI_BTN_MAX_STATUS_BIT_LEN)); value_imglist = value_imglist>>(8-HMI_BTN_MAX_STATUS_BIT_LEN); #if HMI_RENDER_ALL_EXCEPT_BCK==NO if(((!only_draw_flag)||!hmi_is_render_mode())||/*simulate*/ (only_draw_flag&&(flag))) #endif { call_C_hmi_driver_draw_imagelist(&(hmi_screen_rect),(HMI_RECT_ALPHA_STR *)(&hmi_dxy_button_rect[hmi_object_index]), &(hmi_dxy_button_table[hmi_object_index].button_image), value_imglist/*, TRUE dxy*/,bMerge, TRUE/*Button*/ #if HMI_RENDER_ALL_EXCEPT_BCK==NO ,parent_object_id ,hmi_object_id_const #endif );  } if(hmi_dxy_button_container_table[hmi_object_index].container_object_table.object_number>0) { hmi_engine_draw_container(&(hmi_dxy_button_container_table[hmi_object_index]), (HMI_RECT_STR CONST *)(&(hmi_screen_rect)), HMI_ELEM_TYPE_DBTN, hmi_object_id_const, FALSE #if HMI_RENDER_ALL_EXCEPT_BCK==NO ,phmi_object_prop_table->object_id  ,only_draw_flag&&(!flag) #endif ); } #endif } #endif }  else #endif  #if HMI_SXY_BUTTON_NUMBER>0  if(hmi_object_id < HMI_DYN_BUTTON_SXY_MAX_ID) { hmi_object_index = HMI_GET_DYN_BUTTON_SXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_SXY_BUTTON_NUMBER) { hmi_rect_temp.x = hmi_sxy_button_rect[hmi_object_index].x; hmi_rect_temp.y = hmi_sxy_button_rect[hmi_object_index].y; hmi_rect_temp.w = hmi_sxy_button_rect[hmi_object_index].w; hmi_rect_temp.h = hmi_sxy_button_rect[hmi_object_index].h; HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_rect_temp), (&(hmi_screen_rect)));  }  #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513)) hmi_get_intersec_rect((HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_screen_rect, &(new_cliped_farther_rect )); hmi_get_intersec_rect_depth((HMI_RECT_STR CONST *)(&(new_cliped_farther_rect)), depth,(HMI_RECT_STR *)pdirty_rect,&hmi_clip_rect); #endif #ifdef HMI_GRAPHIC_AGG call_C_hmi_driver_draw_imagelist(&(hmi_screen_rect), hmi_bigbitmap_table[0], hmi_bigbitmap_table[1], &hmi_sxy_button_table[hmi_object_index].button_image, hmi_sxy_button_press_status[hmi_object_index], &hmi_clip_rect);  #endif  #ifdef HMI_GRAPHIC_RGL #if HMI_BTN_MAX_STATUS > 0 if((hmi_clip_rect.x != HMI_INVALID_COOR)|| (hmi_clip_rect.y != HMI_INVALID_COOR)) { value_index = (hmi_object_index*HMI_BTN_MAX_STATUS_BIT_LEN)>>3/*/8*/; value_beg_bits = (hmi_object_index*HMI_BTN_MAX_STATUS_BIT_LEN)&0x07/*%8*/; value_imglist = hmi_sxy_button_press_status[value_index]; value_imglist = value_imglist<<(8-(value_beg_bits+HMI_BTN_MAX_STATUS_BIT_LEN)); value_imglist = value_imglist>>(8-HMI_BTN_MAX_STATUS_BIT_LEN); if(hmi_object_index < HMI_SXY_BUTTON_NUMBER) { call_C_hmi_driver_draw_imagelist(&(hmi_screen_rect), hmi_sxy_button_attr_table[hmi_object_index], (HMI_RECT_ALPHA_STR *)(&hmi_sxy_button_rect[hmi_object_index]), &(hmi_sxy_button_table[hmi_object_index].button_image), value_imglist, &hmi_clip_rect, pdirty_rect, depth, hmi_object_id, father_alpha); if(father_alpha > hmi_sxy_button_rect[hmi_object_index].alpha) { father_alpha = hmi_sxy_button_rect[hmi_object_index].alpha; } hmi_engine_draw_container(&(hmi_sxy_button_container_table[hmi_object_index]), (HMI_RECT_STR CONST *)(&(hmi_screen_rect )), pdirty_rect, depth,&new_cliped_farther_rect/*all father insection zone*/ ,father_alpha); } } #endif #endif  #ifdef HMI_GRAPHIC_ST7513 #if HMI_BTN_MAX_STATUS > 0 value_index = (hmi_object_index*HMI_BTN_MAX_STATUS_BIT_LEN)>>3/*/8*/; value_beg_bits = (hmi_object_index*HMI_BTN_MAX_STATUS_BIT_LEN)&0x07/*%8*/; value_imglist = hmi_sxy_button_press_status[value_index]; value_imglist = value_imglist<<(8-(value_beg_bits+HMI_BTN_MAX_STATUS_BIT_LEN)); value_imglist = value_imglist>>(8-HMI_BTN_MAX_STATUS_BIT_LEN); if(hmi_object_index < HMI_SXY_BUTTON_NUMBER) { call_C_hmi_driver_draw_imagelist(&(hmi_screen_rect),  &(hmi_sxy_button_table[hmi_object_index].button_image), value_imglist, &hmi_clip_rect);  hmi_engine_draw_container(&(hmi_sxy_button_container_table[hmi_object_index]), (HMI_RECT_STR CONST *)(&(hmi_screen_rect)), pdirty_rect, depth,&new_cliped_farther_rect/*all father insection zone*/); } #endif #endif  #ifdef HMI_GRAPHIC_TWLIB #if HMI_BTN_MAX_STATUS > 0 bMerge = hmi_get_is_merge(parent_object_id_type,HMI_ELEM_TYPE_SBTN); value_index = (hmi_object_index*HMI_BTN_MAX_STATUS_BIT_LEN)>>3/*/8*/; value_beg_bits = (hmi_object_index*HMI_BTN_MAX_STATUS_BIT_LEN)&0x07/*%8*/; value_imglist = hmi_sxy_button_press_status[value_index]; value_imglist = value_imglist<<(8-(value_beg_bits+HMI_BTN_MAX_STATUS_BIT_LEN)); value_imglist = value_imglist>>(8-HMI_BTN_MAX_STATUS_BIT_LEN); #if HMI_RENDER_ALL_EXCEPT_BCK==NO if(((!only_draw_flag)||!hmi_is_render_mode())||/*simulate*/ (only_draw_flag&&(flag))) #endif { if(hmi_object_index < HMI_SXY_BUTTON_NUMBER) { call_C_hmi_driver_draw_imagelist(&(hmi_screen_rect),(HMI_RECT_ALPHA_STR *)(&hmi_sxy_button_rect[hmi_object_index]), &(hmi_sxy_button_table[hmi_object_index].button_image), value_imglist/*, FALSE sxy*/,bMerge, TRUE/*Button*/ #if HMI_RENDER_ALL_EXCEPT_BCK==NO ,parent_object_id ,hmi_object_id_const #endif );  } } if(hmi_object_index < HMI_SXY_BUTTON_NUMBER) { if(hmi_sxy_button_container_table[hmi_object_index].container_object_table.object_number>0) { hmi_engine_draw_container(&(hmi_sxy_button_container_table[hmi_object_index]), (HMI_RECT_STR CONST *)(&(hmi_screen_rect)), HMI_ELEM_TYPE_SBTN, hmi_object_id_const, FALSE #if HMI_RENDER_ALL_EXCEPT_BCK==NO ,phmi_object_prop_table->object_id  ,only_draw_flag&&(!flag) #endif ); } } #endif #endif  }  else  #endif #if HMI_DYN_EDIT_TEXTS_NUMBER/*editable text*/ > 0  if(hmi_object_id < HMI_DYN_TEXTS_MAX_ID) {  #if HMI_DYN_XY_EDIT_TEXTS_NUMBER > 0 if(HMI_IS_DYN_TEXT_DXY(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_TEXTS_DXY_POS_INDEX(hmi_object_id); if(hmi_object_index < HMI_DYN_XY_EDIT_TEXTS_NUMBER) { hmi_get_object_screen_coor((HMI_RECT_STR CONST *)pfarther_rect, &hmi_dyn_xy_edit_text_prop_table[hmi_object_index].text_rect, &(hmi_screen_rect)); #if (defined(HMI_GRAPHIC_RGL)) /*element draw rect backups*/ hmi_dyn_xy_edit_text_prop_table_bck[hmi_object_index].x = hmi_dyn_xy_edit_text_prop_table[hmi_object_index].text_rect.x; hmi_dyn_xy_edit_text_prop_table_bck[hmi_object_index].y = hmi_dyn_xy_edit_text_prop_table[hmi_object_index].text_rect.y; hmi_dyn_xy_edit_text_prop_table_bck[hmi_object_index].w = hmi_dyn_xy_edit_text_prop_table[hmi_object_index].text_rect.w; hmi_dyn_xy_edit_text_prop_table_bck[hmi_object_index].h = hmi_dyn_xy_edit_text_prop_table[hmi_object_index].text_rect.h; #endif }  #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513))  hmi_get_intersec_rect((HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_screen_rect, &(new_cliped_farther_rect )); hmi_get_intersec_rect_depth((HMI_RECT_STR CONST *)(&(new_cliped_farther_rect)), depth,(HMI_RECT_STR *)pdirty_rect,&hmi_clip_rect);  #endif text_prop.text_rect.x = hmi_screen_rect.x; text_prop.text_rect.y = hmi_screen_rect.y; text_prop.text_rect.w = hmi_screen_rect.w; text_prop.text_rect.h = hmi_screen_rect.h; if(hmi_object_index < HMI_DYN_XY_EDIT_TEXTS_NUMBER) { text_prop.color = hmi_dyn_xy_edit_text_prop_table[hmi_object_index].color; } #if HMI_EDIT_TEXT_DXY_DYN_FONT_NUM > 0 if(HMI_IS_DYN_TEXT_DXY_DYN_FONT(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_TEXTS_DXY_DYN_FONT_POS_INDEX(hmi_object_id); if(hmi_object_index < HMI_EDIT_TEXT_DXY_DYN_FONT_NUM) { font_id = hmi_edit_text_dxy_dyn_font_table[hmi_object_index]; } } #endif  #ifdef HMI_GRAPHIC_AGG call_C_hmi_driver_draw_text( &text_prop, &hmi_edit_text_table[hmi_object_index], &hmi_clip_rect #ifdef HMI_CLIP_TEXT  ,hmi_clip_text #endif ); #if HMI_TEXT_MAX_SON_CNT > 0 hmi_engine_draw_container(&hmi_edit_text_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&(hmi_screen_rect)),  pdirty_rect, depth,&new_cliped_farther_rect/*all father insection zone*/);  #endif #endif   #ifdef HMI_GRAPHIC_RGL if((hmi_clip_rect.x != HMI_INVALID_COOR)|| (hmi_clip_rect.y != HMI_INVALID_COOR)) { hmi_object_index = HMI_GET_DYN_TEXTS_INDEX(hmi_object_id); if(hmi_object_index < HMI_DYN_EDIT_TEXTS_NUMBER) { #if HMI_ALL_FONT_NUMBER > 0 call_C_hmi_driver_draw_text( &text_prop, &hmi_edit_text_table[hmi_object_index], &hmi_clip_rect, pdirty_rect, font_id, depth #ifdef HMI_CLIP_TEXT  ,hmi_clip_text #endif ,father_alpha ); #endif hmi_alpha = HMI_RGL_ALLPHA(text_prop.color); if(father_alpha > hmi_alpha) { father_alpha = hmi_alpha; } #if HMI_TEXT_MAX_SON_CNT > 0 hmi_engine_draw_container(&hmi_edit_text_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&(hmi_screen_rect )), pdirty_rect, depth,&new_cliped_farther_rect/*all father insection zone*/ ,father_alpha); #endif } } #endif   #ifdef HMI_GRAPHIC_ST7513 hmi_object_index = HMI_GET_DYN_TEXTS_INDEX(hmi_object_id); if(hmi_object_index < HMI_DYN_EDIT_TEXTS_NUMBER) { call_C_hmi_driver_draw_text( &text_prop, &hmi_edit_text_table[hmi_object_index], &hmi_clip_rect, font_id #ifdef HMI_CLIP_TEXT  ,hmi_clip_text #endif ); #if HMI_TEXT_MAX_SON_CNT > 0 hmi_engine_draw_container(&hmi_edit_text_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&(hmi_screen_rect )), pdirty_rect, depth,&new_cliped_farther_rect/*all father insection zone*/); #endif } #endif   #ifdef HMI_GRAPHIC_TWLIB  hmi_object_index = HMI_GET_DYN_TEXTS_INDEX(hmi_object_id); if(hmi_object_index < HMI_DYN_EDIT_TEXTS_NUMBER) { #if HMI_RENDER_ALL_EXCEPT_BCK==NO if(((!only_draw_flag)||!hmi_is_render_mode())||/*simulate*/ (only_draw_flag&&(flag))) #endif { call_C_hmi_driver_draw_text( &text_prop, &hmi_edit_text_table[hmi_object_index] #if HMI_RENDER_ALL_EXCEPT_BCK==NO ,parent_object_id ,hmi_object_id_const #endif );  } } #endif  } else #endif  #if HMI_S_XY_EDIT_TEXTS_NUMBER > 0 if(HMI_IS_DYN_TEXT_SXY(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_TEXTS_SXY_POS_INDEX(hmi_object_id); if(hmi_object_index < HMI_S_XY_EDIT_TEXTS_NUMBER) { hmi_get_object_screen_coor((HMI_RECT_STR CONST *)pfarther_rect, &hmi_static_xy_edit_text_prop_table[hmi_object_index].text_rect, &(hmi_screen_rect));  } #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513)) hmi_get_intersec_rect((HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_screen_rect, &(new_cliped_farther_rect )); hmi_get_intersec_rect_depth((HMI_RECT_STR CONST *)(&(new_cliped_farther_rect)), depth,(HMI_RECT_STR *)pdirty_rect,&hmi_clip_rect);  #endif text_prop.text_rect.x = hmi_screen_rect.x; text_prop.text_rect.y = hmi_screen_rect.y; text_prop.text_rect.w = hmi_screen_rect.w; text_prop.text_rect.h = hmi_screen_rect.h; if(hmi_object_index < HMI_S_XY_EDIT_TEXTS_NUMBER) { text_prop.color = hmi_static_xy_edit_text_prop_table[hmi_object_index].color; }  #if HMI_EDIT_TEXT_SXY_DYN_FONT_NUM > 0 if(HMI_IS_DYN_TEXT_SXY_DYN_FONT(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_TEXTS_SXY_DYN_FONT_POS_INDEX(hmi_object_id); if(hmi_object_index < HMI_EDIT_TEXT_SXY_DYN_FONT_NUM) { font_id = hmi_edit_text_sxy_dyn_font_table[hmi_object_index]; } } #endif  #ifdef HMI_GRAPHIC_AGG hmi_object_index = HMI_GET_DYN_TEXTS_INDEX(hmi_object_id); if(hmi_object_index < HMI_DYN_EDIT_TEXTS_NUMBER) { call_C_hmi_driver_draw_text(&text_prop, &hmi_edit_text_table[hmi_object_index], &hmi_clip_rect #ifdef HMI_CLIP_TEXT  ,hmi_clip_text #endif ); #if HMI_TEXT_MAX_SON_CNT > 0 hmi_engine_draw_container(&hmi_edit_text_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&(hmi_screen_rect )), pdirty_rect, depth,&new_cliped_farther_rect/*all father insection zone*/); #endif } #endif   #ifdef HMI_GRAPHIC_RGL if((hmi_clip_rect.x != HMI_INVALID_COOR)|| (hmi_clip_rect.y != HMI_INVALID_COOR)) { hmi_object_index = HMI_GET_DYN_TEXTS_INDEX(hmi_object_id); if(hmi_object_index < HMI_DYN_EDIT_TEXTS_NUMBER) { #if HMI_ALL_FONT_NUMBER > 0 call_C_hmi_driver_draw_text(&text_prop, &hmi_edit_text_table[hmi_object_index], &hmi_clip_rect, pdirty_rect, font_id, depth #ifdef HMI_CLIP_TEXT  ,hmi_clip_text #endif ,father_alpha ); #endif hmi_alpha = HMI_RGL_ALLPHA(text_prop.color); if(father_alpha > hmi_alpha) { father_alpha = hmi_alpha; } #if HMI_TEXT_MAX_SON_CNT > 0 hmi_engine_draw_container(&hmi_edit_text_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&(hmi_screen_rect )),  pdirty_rect, depth,&new_cliped_farther_rect/*all father insection zone*/, father_alpha); #endif } } #endif   #ifdef HMI_GRAPHIC_ST7513 hmi_object_index = HMI_GET_DYN_TEXTS_INDEX(hmi_object_id); if(hmi_object_index < HMI_DYN_EDIT_TEXTS_NUMBER) { call_C_hmi_driver_draw_text(&text_prop, &hmi_edit_text_table[hmi_object_index], &hmi_clip_rect, font_id #ifdef HMI_CLIP_TEXT  ,hmi_clip_text #endif ); #if HMI_TEXT_MAX_SON_CNT > 0 hmi_engine_draw_container(&hmi_edit_text_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&(hmi_screen_rect)),  pdirty_rect, depth,&new_cliped_farther_rect/*all father insection zone*/); #endif } #endif   #ifdef HMI_GRAPHIC_TWLIB  hmi_object_index = HMI_GET_DYN_TEXTS_INDEX(hmi_object_id); if(hmi_object_index < HMI_DYN_EDIT_TEXTS_NUMBER) { #if HMI_RENDER_ALL_EXCEPT_BCK==NO if(((!only_draw_flag)||!hmi_is_render_mode())||/*simulate*/ (only_draw_flag&&(flag))) #endif { call_C_hmi_driver_draw_text(&text_prop, &hmi_edit_text_table[hmi_object_index]  #if HMI_RENDER_ALL_EXCEPT_BCK==NO ,parent_object_id ,hmi_object_id_const #endif ); } #if 0 #if HMI_TEXT_MAX_SON_CNT > 0 hmi_engine_draw_container(&hmi_edit_text_container_table[hmi_object_id], (HMI_RECT_STR CONST *)&(text_prop.text_rect), &hmi_union_rect, pdirty_rect); #endif #endif /*tw not support */ } #endif  } else #endif { } } else #endif  #if HMI_DYN_CONTAINERS_NUMBER > 0 if(hmi_object_id < HMI_DYN_CONTAINERS_MAX_ID) {  #if HMI_ALL_STATIC_CONTAINERS_NUMBER > 0  hmi_object_id = HMI_GET_DYN_CONTAINERS_ID_INDEX(hmi_object_id); #if (defined(HMI_GRAPHIC_RGL)) /*dyn container id backups*/ hmi_dyn_container_table_bck[hmi_object_id] = hmi_dyn_container_table[hmi_object_id]; #endif hmi_engine_get_static_container_id(&hmi_object_id);/*get static container ID*/  #ifdef HMI_GRAPHIC_TWLIB /*tw*/ hmi_object_id_const = hmi_object_id; #endif  #if HMI_DXY_CONTAINERS_NUMBER>0U if(HMI_IS_DYN_XY_CONTAINER(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_XY_CONTAINER_INDEX(hmi_object_id ); if(hmi_object_id< HMI_DXY_CONTAINERS_NUMBER) { hmi_get_object_screen_coor((HMI_RECT_STR CONST *)pfarther_rect, &hmi_dyn_xy_container_rect[hmi_object_id], &(hmi_screen_rect));  #if (defined(HMI_GRAPHIC_RGL)) /*element draw rect backups*/ hmi_dyn_xy_container_rect_bck[hmi_object_id].x = hmi_dyn_xy_container_rect[hmi_object_id].x; hmi_dyn_xy_container_rect_bck[hmi_object_id].y = hmi_dyn_xy_container_rect[hmi_object_id].y; hmi_dyn_xy_container_rect_bck[hmi_object_id].w = hmi_dyn_xy_container_rect[hmi_object_id].w; hmi_dyn_xy_container_rect_bck[hmi_object_id].h = hmi_dyn_xy_container_rect[hmi_object_id].h; #endif } #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513)) hmi_get_intersec_rect((HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_screen_rect, &(new_cliped_farther_rect )); hmi_get_intersec_rect_depth((HMI_RECT_STR CONST *)(&(new_cliped_farther_rect)), depth,(HMI_RECT_STR *)pdirty_rect,&hmi_clip_rect);  #endif  #ifdef HMI_GRAPHIC_AGG hmi_engine_draw_container(&hmi_dyn_xy_container_table[hmi_object_id], (HMI_RECT_STR CONST *)&(hmi_screen_rect), pdirty_rect,depth,&new_cliped_farther_rect/*all father insection zone*/); #endif  #ifdef HMI_GRAPHIC_RGL if((hmi_clip_rect.x != HMI_INVALID_COOR)|| (hmi_clip_rect.y != HMI_INVALID_COOR)) { if(hmi_dxy_container_video_fmt[hmi_object_id].video_fmt_channel&HMI_VIDEO_WINDOW) { hmi_display_video(&hmi_dxy_container_video_fmt[hmi_object_id], &hmi_dyn_xy_container_rect[hmi_object_id], &hmi_dxy_container_video_status[hmi_object_id], depth); }/*2016.9.7. for support video capture in*/ hmi_engine_draw_container(&hmi_dyn_xy_container_table[hmi_object_id], (HMI_RECT_STR CONST *)&(hmi_screen_rect ), pdirty_rect,depth,&new_cliped_farther_rect/*all father insection zone*/,father_alpha); } #endif  #ifdef HMI_GRAPHIC_ST7513 hmi_engine_draw_container(&hmi_dyn_xy_container_table[hmi_object_id], (HMI_RECT_STR CONST *)&(hmi_screen_rect), pdirty_rect,depth,&new_cliped_farther_rect/*all father insection zone*/); #endif  #ifdef HMI_GRAPHIC_TWLIB /*tw*/ parent_object_id_type = HMI_ELEM_TYPE_DYN_CONTAINER; bMerge = hmi_get_is_merge(HMI_ELEM_TYPE_DYN_CONTAINER/*parent_object_id_type*/,HMI_ELEM_TYPE_DXY_CONTINER); #if HMI_RENDER_ALL_EXCEPT_BCK==NO //if(((!only_draw_flag)||!hmi_is_render_mode())|| //(only_draw_flag&&(flag))) #endif  { if(hmi_dyn_xy_container_table[hmi_object_id].container_object_table.object_number>0) { hmi_engine_draw_container(&(hmi_dyn_xy_container_table[hmi_object_id]), (HMI_RECT_STR CONST *)(&(hmi_screen_rect )), /*HMI_ELEM_TYPE_DYN_CONTAINER*/HMI_ELEM_TYPE_DXY_CONTINER, hmi_object_id_const, !bMerge #if HMI_RENDER_ALL_EXCEPT_BCK==NO ,phmi_object_prop_table->object_id ,only_draw_flag&&(!flag) #endif ); } } #endif } else #endif { } #if HMI_SXY_CONTAINERS_NUMBER>0 if(HMI_IS_CONTAINERS_SXY(hmi_object_id)) { hmi_object_id = HMI_GET_CONTAINERS_SXY_ID_INDEX(hmi_object_id ); if(hmi_object_id< HMI_SXY_CONTAINERS_NUMBER) { hmi_get_object_screen_coor((HMI_RECT_STR CONST *)pfarther_rect, &hmi_static_container_rect[hmi_object_id],&(hmi_screen_rect));  } #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513)) hmi_get_intersec_rect((HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_screen_rect, &(new_cliped_farther_rect )); #if 0 //lq hmi_get_intersec_rect_depth((HMI_RECT_STR CONST *)(&(new_cliped_farther_rect)), depth,(HMI_RECT_STR *)(&pdirty_rect[depth]),&hmi_clip_rect); #endif hmi_get_intersec_rect_depth((HMI_RECT_STR CONST *)(&(new_cliped_farther_rect)), depth,(HMI_RECT_STR *)(pdirty_rect),&hmi_clip_rect); #endif  #ifdef HMI_GRAPHIC_AGG if(hmi_object_id< HMI_SXY_CONTAINERS_NUMBER) { hmi_engine_draw_container(&hmi_sxy_container_table[hmi_object_id], (HMI_RECT_STR CONST *)&(hmi_screen_rect ), pdirty_rect,depth,&new_cliped_farther_rect/*all father insection zone*/); } #endif  #ifdef HMI_GRAPHIC_RGL if(hmi_object_id< HMI_SXY_CONTAINERS_NUMBER) { if((hmi_clip_rect.x != HMI_INVALID_COOR)&&/*||*/ (hmi_clip_rect.y != HMI_INVALID_COOR)) { hmi_engine_draw_container(&hmi_sxy_container_table[hmi_object_id], (HMI_RECT_STR CONST *)(&(hmi_screen_rect )), pdirty_rect,depth,&new_cliped_farther_rect/*all father insection zone*/,father_alpha); } } #endif  #ifdef HMI_GRAPHIC_ST7513 if(hmi_object_id< HMI_SXY_CONTAINERS_NUMBER) { hmi_engine_draw_container(&hmi_sxy_container_table[hmi_object_id], (HMI_RECT_STR CONST *)(&(hmi_screen_rect )), pdirty_rect,depth,&new_cliped_farther_rect/*all father insection zone*/); } #endif  #ifdef HMI_GRAPHIC_TWLIB /*tw*/ bMerge=hmi_get_is_merge(HMI_ELEM_TYPE_DYN_CONTAINER/*parent_object_id_type*/,HMI_ELEM_TYPE_SXY_CONTAINER); #if HMI_RENDER_ALL_EXCEPT_BCK==NO //if(((!only_draw_flag)||!hmi_is_render_mode())|| //(only_draw_flag&&(flag))) #endif { if(hmi_sxy_container_table[hmi_object_id].container_object_table.object_number>0) { hmi_engine_draw_container(&(hmi_sxy_container_table[hmi_object_id]), (HMI_RECT_STR CONST *)(&(hmi_screen_rect )), HMI_ELEM_TYPE_SXY_CONTAINER, hmi_object_id_const, !bMerge #if HMI_RENDER_ALL_EXCEPT_BCK==NO ,phmi_object_prop_table->object_id  ,only_draw_flag&&(!flag) #endif );  } } #endif } else #endif { }  #endif  } else #endif #if HMI_DYN_FILL_PAGES_NUMBER > 0 if(hmi_object_id < HMI_DYN_NFILL_MAX_ID) { hmi_object_index = HMI_GET_DYN_NFILL_INDEX(hmi_object_id ); if(hmi_object_index< HMI_DYN_FILL_PAGES_NUMBER) { hmi_rect_temp.x = hmi_fills_dyn_xy_rect[hmi_object_index].x; hmi_rect_temp.y = hmi_fills_dyn_xy_rect[hmi_object_index].y; hmi_rect_temp.w = hmi_fills_dyn_xy_rect[hmi_object_index].w; hmi_rect_temp.h = hmi_fills_dyn_xy_rect[hmi_object_index].h; HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_rect_temp) ,(&(hmi_screen_rect))); #if (defined(HMI_GRAPHIC_RGL)) /*element draw rect backups*/ hmi_fills_dyn_xy_rect_bck[hmi_object_index].x = hmi_fills_dyn_xy_rect[hmi_object_index].x; hmi_fills_dyn_xy_rect_bck[hmi_object_index].y = hmi_fills_dyn_xy_rect[hmi_object_index].y; hmi_fills_dyn_xy_rect_bck[hmi_object_index].w = hmi_fills_dyn_xy_rect[hmi_object_index].w; hmi_fills_dyn_xy_rect_bck[hmi_object_index].h = hmi_fills_dyn_xy_rect[hmi_object_index].h; #endif } #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513)) hmi_get_intersec_rect((HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_screen_rect, &(new_cliped_farther_rect )); hmi_get_intersec_rect_depth((HMI_RECT_STR CONST *)(&(new_cliped_farther_rect)), depth,(HMI_RECT_STR *)pdirty_rect,&hmi_clip_rect);  #endif  #ifdef HMI_GRAPHIC_AGG if(hmi_object_index< HMI_DYN_FILL_PAGES_NUMBER) { call_C_hmi_driver_draw_fill_page(&hmi_screen_rect, &hmi_fills_dyn_prop_table[hmi_object_index], &hmi_clip_rect); hmi_engine_draw_container(&hmi_dyn_fill_container_table[hmi_object_index], (HMI_RECT_STR CONST *)&(hmi_screen_rect), pdirty_rect,depth,&new_cliped_farther_rect/*all father insection zone*/); } #endif  #ifdef HMI_GRAPHIC_RGL if(hmi_object_index< HMI_DYN_FILL_PAGES_NUMBER) { if((hmi_clip_rect.x!=HMI_INVALID_COOR)|| (hmi_clip_rect.y!=HMI_INVALID_COOR)) { call_C_hmi_driver_draw_fill_page(&hmi_fills_dyn_prop_table[hmi_object_index ], &hmi_clip_rect, pdirty_rect, depth, father_alpha); hmi_alpha=HMI_RGL_ALLPHA(hmi_fills_dyn_prop_table[hmi_object_index ].color); if(father_alpha>hmi_alpha) { father_alpha=hmi_alpha; } hmi_engine_draw_container(&(hmi_dyn_fill_container_table[hmi_object_index]), (HMI_RECT_STR CONST *)(&(hmi_screen_rect)), pdirty_rect, depth,&new_cliped_farther_rect/*all father insection zone*/, father_alpha);  } } #endif  #ifdef HMI_GRAPHIC_ST7513 if(hmi_object_index< HMI_DYN_FILL_PAGES_NUMBER) { call_C_hmi_driver_draw_fill_page((HMI_RECT_STR CONST *)(&(hmi_screen_rect)), (HMI_FILL_PAGE_STR CONST *)(&hmi_fills_dyn_prop_table[hmi_object_index]), (HMI_RECT_STR *)(&hmi_clip_rect));  hmi_engine_draw_container(&(hmi_dyn_fill_container_table[hmi_object_index]), (HMI_RECT_STR CONST *)(&(hmi_screen_rect )), pdirty_rect, depth,&new_cliped_farther_rect/*all father insection zone*/);  } #endif  #ifdef HMI_GRAPHIC_TWLIB bMerge=hmi_get_is_merge(parent_object_id_type,HMI_ELEM_TYPE_DFILL); #if HMI_RENDER_ALL_EXCEPT_BCK==NO if(((!only_draw_flag)||!hmi_is_render_mode())||/*simulate*/ (only_draw_flag&&(flag))) #endif { call_C_hmi_driver_draw_fill_page(&hmi_fills_dyn_prop_table[hmi_object_index ], (HMI_RECT_STR CONST *)(&(hmi_screen_rect)), bMerge #if HMI_RENDER_ALL_EXCEPT_BCK==NO ,parent_object_id ,hmi_object_id_const #endif );  } if(hmi_dyn_fill_container_table[hmi_object_index].container_object_table.object_number>0) { hmi_engine_draw_container(&(hmi_dyn_fill_container_table[hmi_object_index]), (HMI_RECT_STR CONST *)(&(hmi_screen_rect )), HMI_ELEM_TYPE_DFILL, hmi_object_id_const, FALSE #if HMI_RENDER_ALL_EXCEPT_BCK==NO ,phmi_object_prop_table->object_id  ,only_draw_flag&&(!flag) #endif ); } #endif  } else #endif  #if HMI_DYN_GFILL_NUMBER > 0 if(hmi_object_id < HMI_DYN_GFILL_MAX_ID) { hmi_object_index = HMI_GET_DYN_GFILL_INDEX(hmi_object_id ); if(hmi_object_index < HMI_DYN_GFILL_NUMBER) { hmi_get_object_screen_coor((HMI_RECT_STR CONST *)pfarther_rect, &hmi_gradient_dxy_fill_rect[hmi_object_index],&(hmi_screen_rect)); #if (defined(HMI_GRAPHIC_RGL)) /*element draw rect backups*/ hmi_gradient_dxy_fill_rect_bck[hmi_object_index].x = hmi_gradient_dxy_fill_rect[hmi_object_index].x; hmi_gradient_dxy_fill_rect_bck[hmi_object_index].y = hmi_gradient_dxy_fill_rect[hmi_object_index].y; hmi_gradient_dxy_fill_rect_bck[hmi_object_index].w = hmi_gradient_dxy_fill_rect[hmi_object_index].w; hmi_gradient_dxy_fill_rect_bck[hmi_object_index].h = hmi_gradient_dxy_fill_rect[hmi_object_index].h; #endif } #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513)) hmi_get_intersec_rect((HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_screen_rect, &(new_cliped_farther_rect )); hmi_get_intersec_rect_depth((HMI_RECT_STR CONST *)(&(new_cliped_farther_rect)), depth,(HMI_RECT_STR *)pdirty_rect,&hmi_clip_rect);  #endif   #ifdef HMI_GRAPHIC_AGG if(hmi_object_index < HMI_DYN_GFILL_NUMBER) { call_C_hmi_driver_gradient_fill_page( &(hmi_screen_rect), &hmi_gradient_dxy_fill_table[hmi_object_index], &hmi_clip_rect); hmi_engine_draw_container(&hmi_dyn_gfill_container_table[hmi_object_index], (HMI_RECT_STR CONST *)&(hmi_screen_rect ), pdirty_rect,depth,&new_cliped_farther_rect/*all father insection zone*/); } #endif  #ifdef HMI_GRAPHIC_RGL if(hmi_object_index < HMI_DYN_GFILL_NUMBER) { if((hmi_clip_rect.x!=HMI_INVALID_COOR)|| (hmi_clip_rect.y!=HMI_INVALID_COOR)) { call_C_hmi_driver_gradient_fill_page( &(hmi_screen_rect), &hmi_gradient_dxy_fill_table[hmi_object_index], &hmi_clip_rect, father_alpha); hmi_alpha=HMI_RGL_ALLPHA(hmi_gradient_dxy_fill_table[hmi_object_index ].color1); if(father_alpha>hmi_alpha) { father_alpha=hmi_alpha; } hmi_engine_draw_container(&hmi_dyn_gfill_container_table[hmi_object_index], (HMI_RECT_STR CONST *)&(hmi_screen_rect ), pdirty_rect,depth,&new_cliped_farther_rect/*all father insection zone*/, father_alpha); } } #endif  #ifdef HMI_GRAPHIC_ST7513 if(hmi_object_index < HMI_DYN_GFILL_NUMBER) { call_C_hmi_driver_gradient_fill_page( &(hmi_screen_rect), &hmi_gradient_dxy_fill_table[hmi_object_index], &hmi_clip_rect); hmi_engine_draw_container(&hmi_dyn_gfill_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&(hmi_screen_rect )), pdirty_rect,depth,&new_cliped_farther_rect/*all father insection zone*/); } #endif  #ifdef HMI_GRAPHIC_TWLIB /*call_C_hmi_driver_gradient_fill_page();*/ /*tw not support gridient fill*/ #endif  } else #endif #if HMI_DXY_CUBE_NUMBER > 0 if(HMI_IS_DYN_CUBE(hmi_object_id)) {  hmi_object_index = HMI_GET_DYN_CUBE_INDEX(hmi_object_id);  if(hmi_object_index < HMI_DXY_CUBE_NUMBER) { HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_cubes_dyn_xy_rect[hmi_object_index].cube_rect), (&(hmi_screen_rect))); #if (defined(HMI_GRAPHIC_RGL)) /*element draw rect backups*/ hmi_cubes_dyn_xy_rect_bck[hmi_object_index].x = hmi_cubes_dyn_xy_rect[hmi_object_index].cube_rect.x; hmi_cubes_dyn_xy_rect_bck[hmi_object_index].y = hmi_cubes_dyn_xy_rect[hmi_object_index].cube_rect.y; hmi_cubes_dyn_xy_rect_bck[hmi_object_index].w = hmi_cubes_dyn_xy_rect[hmi_object_index].cube_rect.w; hmi_cubes_dyn_xy_rect_bck[hmi_object_index].h = hmi_cubes_dyn_xy_rect[hmi_object_index].cube_rect.h; #endif #if (defined(HMI_GRAPHIC_RGL)) hmi_get_intersec_rect((HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_screen_rect, &(new_cliped_farther_rect )); hmi_get_intersec_rect_depth((HMI_RECT_STR CONST *)(&(new_cliped_farther_rect)), depth,(HMI_RECT_STR *)pdirty_rect,&hmi_clip_rect);  hmi_cube_get_container_prop(hmi_cubes_dyn_xy_face[hmi_object_index].container_object_table.p_object_table[0].object_id, &hmi_cube_textrue.cube_face1_texture, &hmi_bump_textrue.cube_face1_texture, NULL); hmi_cube_get_container_prop(hmi_cubes_dyn_xy_face[hmi_object_index].container_object_table.p_object_table[1].object_id, &hmi_cube_textrue.cube_face2_texture, &hmi_bump_textrue.cube_face2_texture, NULL);  hmi_cube_get_container_prop(hmi_cubes_dyn_xy_face[hmi_object_index].container_object_table.p_object_table[2].object_id, &hmi_cube_textrue.cube_face3_texture, &hmi_bump_textrue.cube_face3_texture, NULL);  hmi_cube_get_container_prop(hmi_cubes_dyn_xy_face[hmi_object_index].container_object_table.p_object_table[3].object_id, &hmi_cube_textrue.cube_face4_texture, &hmi_bump_textrue.cube_face4_texture, NULL);  hmi_cube_get_container_prop(hmi_cubes_dyn_xy_face[hmi_object_index].container_object_table.p_object_table[4].object_id, &hmi_cube_textrue.cube_face5_texture, &hmi_bump_textrue.cube_face5_texture, NULL);  hmi_cube_get_container_prop(hmi_cubes_dyn_xy_face[hmi_object_index].container_object_table.p_object_table[5].object_id,  &hmi_cube_textrue.cube_face6_texture, &hmi_bump_textrue.cube_face6_texture, NULL); if((hmi_clip_rect.x != HMI_INVALID_COOR)|| (hmi_clip_rect.y != HMI_INVALID_COOR)) { hmi_get_axis(axis,&hmi_cubes_dyn_xy_axis[hmi_object_index], pfarther_rect); call_C_hmi_driver_draw_cube(&(hmi_screen_rect)/*node screen position*/,  (HMI_CUBE_STR CONST *)(&hmi_cubes_dyn_xy_rect[hmi_object_index]), &hmi_cube_textrue, &hmi_bump_textrue, pcliped_farther_rect, pdirty_rect, depth, /*hmi_object_id,*/ father_alpha, &hmi_cubes_dyn_xy_axis[hmi_object_index],  axis ); } #endif } } else #endif  #if HMI_DXY_CONTAINERS_NUMBER > 0U  if(hmi_object_id < HMI_DYN_XY_CONTAINER_MAX_ID) { hmi_object_id = HMI_GET_DYN_XY_CONTAINER_INDEX(hmi_object_id ); if(hmi_object_id < HMI_DXY_CONTAINERS_NUMBER) { hmi_get_object_screen_coor((HMI_RECT_STR CONST *)pfarther_rect, &hmi_dyn_xy_container_rect[hmi_object_id], &(hmi_screen_rect)); #if (defined(HMI_GRAPHIC_RGL)) /*element draw rect backups*/ hmi_dyn_xy_container_rect_bck[hmi_object_id].x = hmi_dyn_xy_container_rect[hmi_object_id].x; hmi_dyn_xy_container_rect_bck[hmi_object_id].y = hmi_dyn_xy_container_rect[hmi_object_id].y; hmi_dyn_xy_container_rect_bck[hmi_object_id].w = hmi_dyn_xy_container_rect[hmi_object_id].w; hmi_dyn_xy_container_rect_bck[hmi_object_id].h = hmi_dyn_xy_container_rect[hmi_object_id].h; #endif } #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513)) hmi_get_intersec_rect((HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_screen_rect, &(new_cliped_farther_rect )); hmi_get_intersec_rect_depth((HMI_RECT_STR CONST *)(&(new_cliped_farther_rect)), depth,(HMI_RECT_STR *)pdirty_rect,&hmi_clip_rect);  #endif  #ifdef HMI_GRAPHIC_AGG if(hmi_object_id < HMI_DXY_CONTAINERS_NUMBER) { hmi_engine_draw_container(&hmi_dyn_xy_container_table[hmi_object_id], (HMI_RECT_STR CONST *)&(hmi_screen_rect ), pdirty_rect,depth,&new_cliped_farther_rect/*all father insection zone*/); } #endif  #ifdef HMI_GRAPHIC_RGL if(hmi_object_id < HMI_DXY_CONTAINERS_NUMBER) {  if((hmi_clip_rect.x!=HMI_INVALID_COOR)|| (hmi_clip_rect.y!=HMI_INVALID_COOR))  { if(hmi_dxy_container_video_fmt[hmi_object_id].video_fmt_channel&HMI_VIDEO_WINDOW) { hmi_display_video(&hmi_dxy_container_video_fmt[hmi_object_id], &hmi_dyn_xy_container_rect[hmi_object_id], &hmi_dxy_container_video_status[hmi_object_id], depth); }/*2016.9.7. for support video capture in*/ hmi_engine_draw_container(&hmi_dyn_xy_container_table[hmi_object_id], (HMI_RECT_STR CONST *)&(hmi_screen_rect ), pdirty_rect,depth,&new_cliped_farther_rect/*all father insection zone*/,father_alpha); } } #endif  #ifdef HMI_GRAPHIC_ST7513 if(hmi_object_id < HMI_DXY_CONTAINERS_NUMBER) { hmi_engine_draw_container(&hmi_dyn_xy_container_table[hmi_object_id], (HMI_RECT_STR CONST *)&(hmi_screen_rect ), pdirty_rect,depth,&new_cliped_farther_rect/*all father insection zone*/); } #endif  #ifdef HMI_GRAPHIC_TWLIB bMerge=hmi_get_is_merge(parent_object_id_type,HMI_ELEM_TYPE_DXY_CONTINER); #if HMI_RENDER_ALL_EXCEPT_BCK==NO //if(((!only_draw_flag)||!hmi_is_render_mode())||/*simulate*/ //(only_draw_flag&&(flag)))  #endif { if(hmi_dyn_xy_container_table[hmi_object_id].container_object_table.object_number>0) { hmi_engine_draw_container(&(hmi_dyn_xy_container_table[hmi_object_id]), (HMI_RECT_STR CONST *)(&(hmi_screen_rect )), HMI_ELEM_TYPE_DXY_CONTINER, hmi_object_id_const, !bMerge #if HMI_RENDER_ALL_EXCEPT_BCK==NO ,phmi_object_prop_table->object_id  ,only_draw_flag&&(!flag) #endif ); } } #endif } else #endif  #if HMI_DXY_BITMAPS_NUMBER > 0  if(hmi_object_id < HMI_DYN_XY_BITMAP_MAX_ID) {  hmi_object_index = HMI_GET_DYN_XY_BITMAP_INDEX(hmi_object_id );  hmi_rect_temp.x = hmi_bmp_dyn_xy_rect[hmi_object_index].x; hmi_rect_temp.y = hmi_bmp_dyn_xy_rect[hmi_object_index].y; hmi_rect_temp.w = hmi_bmp_dyn_xy_rect[hmi_object_index].w; hmi_rect_temp.h = hmi_bmp_dyn_xy_rect[hmi_object_index].h; HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect,(&hmi_rect_temp), (&(hmi_screen_rect))); #if (defined(HMI_GRAPHIC_RGL)) /*element draw rect backups*/  hmi_bmp_dyn_xy_rect_bck[hmi_object_index].x = hmi_rect_temp.x; hmi_bmp_dyn_xy_rect_bck[hmi_object_index].y = hmi_rect_temp.y; hmi_bmp_dyn_xy_rect_bck[hmi_object_index].w = hmi_rect_temp.w; hmi_bmp_dyn_xy_rect_bck[hmi_object_index].h = hmi_rect_temp.h; hmi_bmp_dyn_angel_bck[hmi_object_index] = hmi_bmp_dyn_xy_rect[hmi_object_index].angel;  #endif #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513)) hmi_get_intersec_rect((HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_screen_rect, &(new_cliped_farther_rect )); if(hmi_bmp_dyn_xy_rect[hmi_object_index].angel != 0) { hmi_get_intersec_rect_depth((HMI_RECT_STR CONST *)(pcliped_farther_rect), depth,(HMI_RECT_STR *)pdirty_rect, &hmi_clip_rect); } else { hmi_get_intersec_rect_depth((HMI_RECT_STR CONST *)(&(new_cliped_farther_rect)), depth,(HMI_RECT_STR *)pdirty_rect, &hmi_clip_rect); }  #endif  #ifdef HMI_GRAPHIC_AGG call_C_hmi_driver_draw_image(&hmi_screen_target, hmi_bigbitmap_table[0],hmi_bigbitmap_table[1],  &hmi_bmp_dyn_xy_prop_table[hmi_object_index], &hmi_clip_rect); hmi_engine_draw_container(&hmi_dxy_bitmap_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_screen_rect), pdirty_rect, depth, &new_cliped_farther_rect/*all father insection zone*/ );  #endif  #ifdef HMI_GRAPHIC_RGL if((hmi_clip_rect.x != HMI_INVALID_COOR)|| (hmi_clip_rect.y != HMI_INVALID_COOR)) {  #if HMI_DXY_CENTER_BITMAPS_NUMBER > 0 if(hmi_object_index < HMI_DXY_CENTER_BITMAPS_NUMBER)/*rotation center*/ {  call_C_hmi_driver_draw_image(&(hmi_screen_rect)/*node screen position*/,  hmi_dxy_bitmap_attr_table[hmi_object_index]/*image format*/, &hmi_bmp_dyn_xy_rect[hmi_object_index]/*alpha,rotation*/, &hmi_bmp_dyn_xy_prop_table[hmi_object_index], &hmi_clip_rect, pdirty_rect, depth, NULL,/*rotation point is center*/ hmi_object_id, father_alpha); } else /*rotation userdefine point*/ #endif { #if HMI_DXY_ROTATION_BITMAPS_NUMBER > 0  hmi_object_index2 = hmi_object_index-HMI_DXY_CENTER_BITMAPS_NUMBER; if(hmi_object_index2 < HMI_DXY_ROTATION_BITMAPS_NUMBER) { rotation.x = pfarther_rect->x + hmi_dxy_bitmap_rotation[hmi_object_index2].x;  rotation.y = pfarther_rect->y + hmi_dxy_bitmap_rotation[hmi_object_index2].y; hmi_trail_id=hmi_dxy_bitmap_rotation_trail[hmi_object_index2].texture; hmi_cube_get_container_prop(hmi_trail_id, &image_trail_texture, &image_trail_bump_texture, &trail_point); hmi_cube_get_container_wh(hmi_trail_id, &trail_rect.w, &trail_rect.h); hmi_trail_get_id_flag=hmi_get_container_child_id(&hmi_trail_id); if(hmi_trail_get_id_flag) { trail_rect.x = trail_point.x; trail_rect.y = trail_point.y; trail_info.texture = hmi_trail_id; trail_info.trail_en=hmi_dxy_bitmap_rotation_trail[hmi_object_index2].trail_en; //trail_info.cw=hmi_dxy_bitmap_rotation_trail[hmi_object_index2].cw; trail_info.begin_angel=hmi_dxy_bitmap_rotation_trail[hmi_object_index2].begin_angel; trail_info.end_angel=hmi_dxy_bitmap_rotation_trail[hmi_object_index2].end_angel; hmi_driver_animated_trail(&trail_info, hmi_dxy_bitmap_rotation_trail_attr[hmi_object_index2], &(hmi_screen_rect)/*node screen position*/, image_trail_texture.tex_attr, &image_trail_texture.tex_rect, &image_trail_texture.tex_prop, &hmi_clip_rect, pdirty_rect, depth, (HMI_ROTATION_STR *)(&rotation),/*rotation point is userdefine point*/ hmi_bmp_dyn_xy_rect[hmi_object_index].angel, father_alpha, &hmi_bmp_dyn_xy_prop_table[hmi_object_index], &trail_rect);/*support animated trail*/   } call_C_hmi_driver_draw_image(&(hmi_screen_rect)/*node screen position*/,  hmi_dxy_bitmap_attr_table[hmi_object_index]/*image format*/, &hmi_bmp_dyn_xy_rect[hmi_object_index]/*alpha,rotation*/, &hmi_bmp_dyn_xy_prop_table[hmi_object_index], &hmi_clip_rect, pdirty_rect, depth, (HMI_ROTATION_STR *)(&rotation),/*rotation point is userdefine point*/ hmi_object_id, father_alpha); } #endif } if(father_alpha > hmi_bmp_dyn_xy_rect[hmi_object_index].alpha) { father_alpha = hmi_bmp_dyn_xy_rect[hmi_object_index].alpha; } hmi_engine_draw_container(&hmi_dxy_bitmap_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&(hmi_screen_rect )), pdirty_rect, depth,&new_cliped_farther_rect/*all father insection zone*/,father_alpha);  } #endif  #ifdef HMI_GRAPHIC_ST7513 call_C_hmi_driver_draw_image(&(hmi_screen_rect)/*node screen position*/,  &hmi_bmp_dyn_xy_prop_table[hmi_object_index], &hmi_clip_rect);  hmi_engine_draw_container(&hmi_dxy_bitmap_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&(hmi_screen_rect )), pdirty_rect, depth,&new_cliped_farther_rect/*all father insection zone*/);  #endif  #ifdef HMI_GRAPHIC_TWLIB bMerge=hmi_get_is_merge(parent_object_id_type,HMI_ELEM_TYPE_DIMAGE); #if HMI_RENDER_ALL_EXCEPT_BCK==NO if(((!only_draw_flag)||!hmi_is_render_mode())||/*simulate*/ (only_draw_flag&&(flag))) #endif { call_C_hmi_driver_draw_image(&(hmi_screen_rect ), HMI_IMAGE_COMPRESS_NONE, &hmi_bmp_dyn_xy_rect[hmi_object_index], &hmi_bmp_dyn_xy_prop_table[hmi_object_index]/*, TRUE*/, bMerge #if HMI_RENDER_ALL_EXCEPT_BCK==NO ,parent_object_id ,hmi_object_id_const #endif );  } if(hmi_dxy_bitmap_container_table[hmi_object_index].container_object_table.object_number>0) { hmi_engine_draw_container(&(hmi_dxy_bitmap_container_table[hmi_object_index]), (HMI_RECT_STR CONST *)(&(hmi_screen_rect )), HMI_ELEM_TYPE_DIMAGE , hmi_object_id_const, FALSE #if HMI_RENDER_ALL_EXCEPT_BCK==NO ,phmi_object_prop_table->object_id  ,only_draw_flag&&(!flag) #endif );  } #endif  } else #endif  #if HMI_STATIC_TEXTS_NUMBER/*uneditable text*/ > 0  if(hmi_object_id < HMI_STATIC_TEXTS_MAX_ID/*HMI_UNEDIT_TEXT_DYN_XY_MAX_ID*/)  {  #if HMI_UNEDIT_TEXTS_DYN_XY_NUMBER > 0 if(HMI_IS_UNEDIT_TEXT_DYN_XY(hmi_object_id)/*HMI_UNEDIT_TEXTS_DYN_XY_NUMBER*/) {  hmi_object_index = HMI_GET_DYN_XY_UNEDIT_POS_COLOR_INDEX(hmi_object_id); if(hmi_object_index < HMI_UNEDIT_TEXTS_DYN_XY_NUMBER) { hmi_get_object_screen_coor((HMI_RECT_STR CONST *)pfarther_rect, &hmi_dyn_xy_unedit_text_prop_table[hmi_object_index].text_rect, &(hmi_screen_rect)); #if (defined(HMI_GRAPHIC_RGL)) /*element draw rect backups*/ hmi_dyn_xy_unedit_text_prop_table_bck[hmi_object_index].x = hmi_dyn_xy_unedit_text_prop_table[hmi_object_index].text_rect.x; hmi_dyn_xy_unedit_text_prop_table_bck[hmi_object_index].y = hmi_dyn_xy_unedit_text_prop_table[hmi_object_index].text_rect.y; hmi_dyn_xy_unedit_text_prop_table_bck[hmi_object_index].w = hmi_dyn_xy_unedit_text_prop_table[hmi_object_index].text_rect.w; hmi_dyn_xy_unedit_text_prop_table_bck[hmi_object_index].h = hmi_dyn_xy_unedit_text_prop_table[hmi_object_index].text_rect.h; #endif } #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513))  hmi_get_intersec_rect((HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_screen_rect, &(new_cliped_farther_rect )); hmi_get_intersec_rect_depth((HMI_RECT_STR CONST *)(&(new_cliped_farther_rect)), depth,(HMI_RECT_STR *)pdirty_rect,&hmi_clip_rect);  #endif text_prop.text_rect.x=hmi_screen_rect.x; text_prop.text_rect.y=hmi_screen_rect.y; text_prop.text_rect.w=hmi_screen_rect.w; text_prop.text_rect.h=hmi_screen_rect.h; if(hmi_object_index < HMI_UNEDIT_TEXTS_DYN_XY_NUMBER) { text_prop.color=hmi_dyn_xy_unedit_text_prop_table[hmi_object_index].color; }  #if HMI_UNEDIT_TEXT_DXY_DYN_FONT_NUM > 0 if(HMI_IS_UNEDIT_TEXT_DYN_XY_DYN_FONT(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_XY_UNEDIT_DYN_FONT_INDEX(hmi_object_id); if(hmi_object_index < HMI_UNEDIT_TEXT_DXY_DYN_FONT_NUM) { font_id = hmi_unedit_text_dxy_dyn_font_table[hmi_object_index]; } } #endif hmi_object_index = HMI_GET_STATIC_TEXT_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_STATIC_TEXTS_NUMBER) { text_info.properties=hmi_unedit_text_table[hmi_object_index].properties; text_info.font_id =hmi_unedit_text_table[hmi_object_index].font_id; text_info.length =hmi_unedit_text_table[hmi_object_index].length; pp_str_list=(HMI_CHAR_STR **)(hmi_unedit_text_table[hmi_object_index].hmi_string); if(HMI_IS_NB_LANGUAGE(hmi_cur_language)) { hmi_object_index=HMI_GET_NB_LANGUAGE_ID_INDEX(hmi_cur_language); if(hmi_object_index < HMI_LANGUAGE_NUMBER) {  text_info.hmi_string=(void *)pp_str_list[hmi_object_index]; } } } #ifdef HMI_GRAPHIC_AGG call_C_hmi_driver_draw_text( &text_prop, &text_info/*hmi_edit_text_table[hmi_object_index]*/, &hmi_clip_rect #ifdef HMI_CLIP_TEXT  ,hmi_clip_text #endif ); hmi_object_index = HMI_GET_STATIC_TEXT_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_STATIC_TEXTS_NUMBER) { #if HMI_TEXT_MAX_SON_CNT > 0 hmi_engine_draw_container(&hmi_static_text_container_table[hmi_object_index], (HMI_RECT_STR CONST *)&(hmi_screen_rect ),  pdirty_rect,depth, &new_cliped_farther_rect/*all father insection zone*/); #endif } #endif  #ifdef HMI_GRAPHIC_RGL if((hmi_clip_rect.x!=HMI_INVALID_COOR)|| (hmi_clip_rect.y!=HMI_INVALID_COOR)) { #if HMI_ALL_FONT_NUMBER > 0 call_C_hmi_driver_draw_text( (HMI_TEXT_RECT_STR CONST *)(&text_prop), (HMI_TEXT_PROP_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml )(&text_info)/*&hmi_edit_text_table[hmi_object_index]*/, &hmi_clip_rect, pdirty_rect, font_id, depth #ifdef HMI_CLIP_TEXT  ,hmi_clip_text #endif ,father_alpha ); #endif hmi_object_index = HMI_GET_STATIC_TEXT_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_STATIC_TEXTS_NUMBER) { #if HMI_TEXT_MAX_SON_CNT > 0 hmi_engine_draw_container(&hmi_edit_text_container_table[hmi_object_index], (HMI_RECT_STR CONST *)&(hmi_screen_rect ), pdirty_rect, depth,&new_cliped_farther_rect/*all father insection zone*/ ,father_alpha); #endif } } #endif  #ifdef HMI_GRAPHIC_ST7513 call_C_hmi_driver_draw_text( (HMI_TEXT_RECT_STR CONST *)(&text_prop), (HMI_TEXT_PROP_STR CONST *)(&text_info)/*&hmi_edit_text_table[hmi_object_index]*/, &hmi_clip_rect, font_id #ifdef HMI_CLIP_TEXT  ,hmi_clip_text #endif ); hmi_object_index = HMI_GET_STATIC_TEXT_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_STATIC_TEXTS_NUMBER) { #if HMI_TEXT_MAX_SON_CNT > 0 hmi_engine_draw_container(&hmi_static_text_container_table[hmi_object_index], (HMI_RECT_STR CONST *)&(hmi_screen_rect ), pdirty_rect, depth,&new_cliped_farther_rect/*all father insection zone*/); #endif } #endif  #ifdef HMI_GRAPHIC_TWLIB if(hmi_object_index < HMI_STATIC_TEXTS_NUMBER) { #if HMI_RENDER_ALL_EXCEPT_BCK==NO if(((!only_draw_flag)||!hmi_is_render_mode())||/*simulate*/ (only_draw_flag&&(flag))) #endif { call_C_hmi_driver_draw_text( (HMI_TEXT_RECT_STR CONST *)(&text_prop), &hmi_unedit_text_table[hmi_object_index] #if HMI_RENDER_ALL_EXCEPT_BCK==NO ,parent_object_id ,hmi_object_id_const #endif ); } }  #if 0 hmi_engine_draw_container(&hmi_edit_text_container_table[hmi_object_id], (HMI_RECT_STR CONST *)&(text_prop.text_rect), &hmi_union_rect, pdirty_rect); #endif /*tw not support*/ #endif  } else  #endif { #if HMI_UNEDIT_TEXTS_STATIC_XY_NUMBER > 0  if(HMI_IS_UNEDIT_TEXT_STATIC_XY(hmi_object_id)/*hmi_object_index < HMI_UNEDIT_TEXTS_STATIC_XY_NUMBER*/) { hmi_object_index = HMI_GET_S_XY_UNEDIT_POS_COLOR_INDEX(hmi_object_id); if(hmi_object_index < HMI_UNEDIT_TEXTS_STATIC_XY_NUMBER) { hmi_get_object_screen_coor((HMI_RECT_STR CONST *)pfarther_rect, &hmi_static_xy_unedit_text_prop_table[hmi_object_index].text_rect, &(hmi_screen_rect)); }  #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513)) hmi_get_intersec_rect((HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_screen_rect, &(new_cliped_farther_rect )); hmi_get_intersec_rect_depth((HMI_RECT_STR CONST *)(&(new_cliped_farther_rect)), depth,(HMI_RECT_STR *)pdirty_rect,&hmi_clip_rect);  #endif  text_prop.text_rect.x=hmi_screen_rect.x; text_prop.text_rect.y=hmi_screen_rect.y; text_prop.text_rect.w=hmi_screen_rect.w; text_prop.text_rect.h=hmi_screen_rect.h; if(hmi_object_index < HMI_UNEDIT_TEXTS_STATIC_XY_NUMBER) { text_prop.color=hmi_static_xy_unedit_text_prop_table[hmi_object_index].color; } hmi_object_index = HMI_GET_STATIC_TEXT_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_STATIC_TEXTS_NUMBER) { text_info.properties=hmi_unedit_text_table[hmi_object_index].properties; text_info.font_id =hmi_unedit_text_table[hmi_object_index].font_id; text_info.length =hmi_unedit_text_table[hmi_object_index].length; pp_str_list=(HMI_CHAR_STR **)(hmi_unedit_text_table[hmi_object_index].hmi_string); if(HMI_IS_NB_LANGUAGE(hmi_cur_language)) { hmi_object_index = HMI_GET_NB_LANGUAGE_ID_INDEX(hmi_cur_language); if(hmi_object_index < HMI_LANGUAGE_NUMBER) {  text_info.hmi_string=(void *)pp_str_list[hmi_object_index]; } } } #ifdef HMI_GRAPHIC_AGG hmi_object_index = HMI_GET_UNEDIT_INDEX(hmi_object_id); if(hmi_object_index < HMI_STATIC_TEXTS_NUMBER) { call_C_hmi_driver_draw_text(&text_prop, text_info/*&hmi_unedit_text_table[hmi_object_index]*/, &hmi_clip_rect #ifdef HMI_CLIP_TEXT  ,hmi_clip_text #endif ); #if HMI_TEXT_MAX_SON_CNT > 0 hmi_engine_draw_container(&hmi_static_text_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&(hmi_screen_rect )),  pdirty_rect,depth, &new_cliped_farther_rect/*all father insection zone*/); #endif } #endif   #if HMI_UNEDIT_TEXT_SXY_DYN_FONT_NUM > 0 if(HMI_IS_UNEDIT_TEXT_STATIC_XY_DYN_FONT(hmi_object_id)) { hmi_object_index = HMI_GET_S_XY_UNEDIT_DYN_FONT_INDEX(hmi_object_id); if(hmi_object_index < HMI_UNEDIT_TEXT_SXY_DYN_FONT_NUM) { font_id = hmi_unedit_text_sxy_dyn_font_table[hmi_object_index]; } } #endif   #ifdef HMI_GRAPHIC_RGL hmi_object_index = HMI_GET_UNEDIT_INDEX(hmi_object_id); if(hmi_object_index < HMI_STATIC_TEXTS_NUMBER) { if((hmi_clip_rect.x!=HMI_INVALID_COOR)|| (hmi_clip_rect.y!=HMI_INVALID_COOR)) { #if HMI_ALL_FONT_NUMBER > 0 call_C_hmi_driver_draw_text((HMI_TEXT_RECT_STR CONST *)(&text_prop), (HMI_TEXT_PROP_STR CONST *)(&text_info)/*&hmi_unedit_text_table[hmi_object_index]*/, &hmi_clip_rect, pdirty_rect, font_id, depth #ifdef HMI_CLIP_TEXT  ,hmi_clip_text #endif ,father_alpha ); #endif #if HMI_TEXT_MAX_SON_CNT > 0 hmi_engine_draw_container(&hmi_static_text_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&(hmi_screen_rect )), pdirty_rect, depth,&new_cliped_farther_rect/*all father insection zone*/ ,father_alpha);  #endif } } #endif  #ifdef HMI_GRAPHIC_ST7513 hmi_object_index = HMI_GET_UNEDIT_INDEX(hmi_object_id); if(hmi_object_index < HMI_STATIC_TEXTS_NUMBER) { call_C_hmi_driver_draw_text((HMI_TEXT_RECT_STR CONST *)(&text_prop), (HMI_TEXT_PROP_STR CONST *)(&text_info), &hmi_clip_rect, font_id #ifdef HMI_CLIP_TEXT  ,hmi_clip_text #endif ); #if HMI_TEXT_MAX_SON_CNT > 0  hmi_engine_draw_container(&hmi_static_text_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&(hmi_screen_rect )), pdirty_rect, depth,&new_cliped_farther_rect/*all father insection zone*/); #endif } #endif  #ifdef HMI_GRAPHIC_TWLIB  hmi_object_index = HMI_GET_UNEDIT_INDEX(hmi_object_id); if(hmi_object_index < HMI_STATIC_TEXTS_NUMBER) { #if HMI_RENDER_ALL_EXCEPT_BCK==NO if(((!only_draw_flag)||!hmi_is_render_mode())||/*simulate*/ (only_draw_flag&&(flag))) #endif { call_C_hmi_driver_draw_text((HMI_TEXT_RECT_STR CONST *)(&text_prop), (HMI_TEXT_PROP_STR CONST *)(&text_info) #if HMI_RENDER_ALL_EXCEPT_BCK==NO ,parent_object_id ,hmi_object_id_const #endif ); } } #if 0 hmi_engine_draw_container(&hmi_edit_text_container_table[hmi_object_id], (HMI_RECT_STR CONST *)&(text_prop.text_rect), &hmi_union_rect, pdirty_rect); #endif /*tw not support */ #endif  } #endif } }  else #endif  /*draw static element*/ #if HMI_STATIC_FILL_PAGES_NUMBER > 0  if(HMI_IS_SXY_FILL_PAGES(hmi_object_id)) { hmi_object_index = HMI_GET_SXY_FILL_PAGES_ID_INDEX(hmi_object_id ); if(hmi_object_index < HMI_STATIC_FILL_PAGES_NUMBER) { HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_fills_static_xy_rect[hmi_object_index]), (&(hmi_screen_rect))); } #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513))  hmi_get_intersec_rect((HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_screen_rect, &(new_cliped_farther_rect )); hmi_get_intersec_rect_depth((HMI_RECT_STR CONST *)(&(new_cliped_farther_rect)), depth,(HMI_RECT_STR *)pdirty_rect,&hmi_clip_rect);  #endif  #ifdef HMI_GRAPHIC_AGG call_C_hmi_driver_draw_fill_page(&hmi_fills_static_prop_table[hmi_object_index ], &hmi_clip_rect); hmi_engine_draw_container(&hmi_static_fill_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&(hmi_screen_rect )), pdirty_rect,depth, &new_cliped_farther_rect/*all father insection zone*/); #endif  #ifdef HMI_GRAPHIC_RGL if((hmi_clip_rect.x!=HMI_INVALID_COOR)|| (hmi_clip_rect.y!=HMI_INVALID_COOR)) { call_C_hmi_driver_draw_fill_page(&hmi_fills_static_prop_table[hmi_object_index ], &hmi_clip_rect, pdirty_rect, depth, father_alpha); hmi_alpha=HMI_RGL_ALLPHA(hmi_fills_static_prop_table[hmi_object_index ].color); if(father_alpha>hmi_alpha) { father_alpha=hmi_alpha; } hmi_engine_draw_container(&hmi_static_fill_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&(hmi_screen_rect )), pdirty_rect, depth,&new_cliped_farther_rect/*all father insection zone*/ ,father_alpha); } #endif  #ifdef HMI_GRAPHIC_ST7513 call_C_hmi_driver_draw_fill_page((HMI_RECT_STR CONST *)(&(hmi_screen_rect)), &hmi_fills_static_prop_table[hmi_object_index], &hmi_clip_rect); hmi_engine_draw_container(&hmi_static_fill_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&(hmi_screen_rect )), pdirty_rect, depth,&new_cliped_farther_rect/*all father insection zone*/); #endif  #ifdef HMI_GRAPHIC_TWLIB  bMerge=hmi_get_is_merge(parent_object_id_type,HMI_ELEM_TYPE_SFILL);  #if HMI_RENDER_ALL_EXCEPT_BCK==NO if(((!only_draw_flag)||!hmi_is_render_mode())||/*simulate*/ (only_draw_flag&&(flag))) #endif { call_C_hmi_driver_draw_fill_page(&hmi_fills_static_prop_table[hmi_object_index ],  &(hmi_screen_rect), bMerge #if HMI_RENDER_ALL_EXCEPT_BCK==NO ,parent_object_id ,hmi_object_id_const #endif );  } if(hmi_static_fill_container_table[hmi_object_index].container_object_table.object_number>0) { hmi_engine_draw_container(&(hmi_static_fill_container_table[hmi_object_index]), (HMI_RECT_STR CONST *)(&(hmi_screen_rect)), HMI_ELEM_TYPE_SFILL , hmi_object_id_const, FALSE #if HMI_RENDER_ALL_EXCEPT_BCK==NO ,phmi_object_prop_table->object_id  ,only_draw_flag&&(!flag) #endif );  } #endif  } else #endif  #if HMI_STATIC_GFILL_NUMBER> 0 if(HMI_IS_SXY_GFILL_PAGES(hmi_object_id)) { hmi_object_index = HMI_GET_SXY_GFILL_PAGES_ID_INDEX(hmi_object_id); hmi_get_object_screen_coor((HMI_RECT_STR CONST *)pfarther_rect, &hmi_gradient_sxy_fill_rect[hmi_object_index ],&(hmi_screen_rect));  #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513))  hmi_get_intersec_rect((HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_screen_rect, &(new_cliped_farther_rect )); hmi_get_intersec_rect_depth((HMI_RECT_STR CONST *)(&(new_cliped_farther_rect)), depth,(HMI_RECT_STR *)pdirty_rect,&hmi_clip_rect);  #endif  #ifdef HMI_GRAPHIC_AGG call_C_hmi_driver_gradient_fill_page( &(hmi_screen_rect), &hmi_gradient_sxy_fill_table[hmi_object_index],&hmi_clip_rect); hmi_engine_draw_container(&hmi_static_gfill_container_table[hmi_object_index], (HMI_RECT_STR CONST *)&(text_prop.text_rect),&hmi_union_rect,pdirty_rect); #endif  #ifdef HMI_GRAPHIC_RGL if((hmi_clip_rect.x!=HMI_INVALID_COOR)|| (hmi_clip_rect.y!=HMI_INVALID_COOR)) { call_C_hmi_driver_gradient_fill_page(&(hmi_screen_rect)/*node screen position*/, &hmi_gradient_sxy_fill_table[hmi_object_index], &hmi_clip_rect, father_alpha); hmi_alpha=HMI_RGL_ALLPHA(hmi_gradient_sxy_fill_table[hmi_object_index ].color1); if(father_alpha>hmi_alpha) { father_alpha=hmi_alpha; } hmi_engine_draw_container(&hmi_static_gfill_container_table[hmi_object_index], (HMI_RECT_STR CONST *)&(hmi_screen_rect ),pdirty_rect,depth, &new_cliped_farther_rect/*all father insection zone*/ ,father_alpha); } #endif  #ifdef HMI_GRAPHIC_ST7513 call_C_hmi_driver_gradient_fill_page(&(hmi_screen_rect)/*node screen position*/, &hmi_gradient_sxy_fill_table[hmi_object_index], &hmi_clip_rect); hmi_engine_draw_container(&hmi_static_gfill_container_table[hmi_object_index], (HMI_RECT_STR CONST *)&(hmi_screen_rect ),pdirty_rect,depth, &new_cliped_farther_rect/*all father insection zone*/); #endif  #ifdef HMI_GRAPHIC_TWLIB #if 0 call_C_hmi_driver_gradient_fill_page( &(text_prop.text_rect), &hmi_gradient_sxy_fill_table[hmi_object_id],&hmi_draw_rect); hmi_engine_draw_container(&hmi_static_gfill_container_table[hmi_object_id],(HMI_RECT_STR CONST *)&(text_prop.text_rect),&hmi_union_rect,pdirty_rect); #endif #endif  } else #endif  #if HMI_SXY_CUBE_NUMBER> 0 if(HMI_IS_SXY_CUBE(hmi_object_id)) {  hmi_object_index = HMI_GET_SXY_CUBE_ID_INDEX(hmi_object_id);  if(hmi_object_index < HMI_SXY_CUBE_NUMBER) { HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_cubes_static_xy_rect[hmi_object_index].cube_rect), (&(hmi_screen_rect)));  #if (defined(HMI_GRAPHIC_RGL)) hmi_get_intersec_rect((HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_screen_rect, &(new_cliped_farther_rect )); hmi_get_intersec_rect_depth((HMI_RECT_STR CONST *)(&(new_cliped_farther_rect)), depth,(HMI_RECT_STR *)pdirty_rect,&hmi_clip_rect);  hmi_cube_get_container_prop(hmi_cubes_static_xy_face[hmi_object_index].container_object_table.p_object_table[0].object_id, &hmi_cube_textrue.cube_face1_texture, &hmi_bump_textrue.cube_face1_texture, NULL); hmi_cube_get_container_prop(hmi_cubes_static_xy_face[hmi_object_index].container_object_table.p_object_table[1].object_id, &hmi_cube_textrue.cube_face2_texture, &hmi_bump_textrue.cube_face2_texture, NULL); hmi_cube_get_container_prop(hmi_cubes_static_xy_face[hmi_object_index].container_object_table.p_object_table[2].object_id, &hmi_cube_textrue.cube_face3_texture, &hmi_bump_textrue.cube_face3_texture, NULL); hmi_cube_get_container_prop(hmi_cubes_static_xy_face[hmi_object_index].container_object_table.p_object_table[3].object_id, &hmi_cube_textrue.cube_face4_texture, &hmi_bump_textrue.cube_face4_texture, NULL); hmi_cube_get_container_prop(hmi_cubes_static_xy_face[hmi_object_index].container_object_table.p_object_table[4].object_id, &hmi_cube_textrue.cube_face5_texture, &hmi_bump_textrue.cube_face5_texture, NULL); hmi_cube_get_container_prop(hmi_cubes_static_xy_face[hmi_object_index].container_object_table.p_object_table[5].object_id,  &hmi_cube_textrue.cube_face6_texture, &hmi_bump_textrue.cube_face6_texture, NULL);  if((hmi_clip_rect.x!=HMI_INVALID_COOR)|| (hmi_clip_rect.y!=HMI_INVALID_COOR)) { hmi_get_axis(axis,&hmi_cubes_static_xy_axis[hmi_object_index], pfarther_rect); call_C_hmi_driver_draw_cube(&(hmi_screen_rect)/*node screen position*/,  &hmi_cubes_static_xy_rect[hmi_object_index], &hmi_cube_textrue, &hmi_bump_textrue, pcliped_farther_rect, pdirty_rect, depth, //hmi_object_id, father_alpha, &hmi_cubes_static_xy_axis[hmi_object_index], axis); } #endif } } else #endif  #if HMI_SXY_BITMAPS_NUMBER> 0 if(HMI_IS_S_XY_BITMAP(hmi_object_id)) {  hmi_object_index = HMI_GET_SXY_BITMAPS_ID_INDEX(hmi_object_id);  if(hmi_object_index < HMI_SXY_BITMAPS_NUMBER) { hmi_rect_temp.x = hmi_bmp_static_xy_rect[hmi_object_index].x; hmi_rect_temp.y = hmi_bmp_static_xy_rect[hmi_object_index].y; hmi_rect_temp.w = hmi_bmp_static_xy_rect[hmi_object_index].w; hmi_rect_temp.h = hmi_bmp_static_xy_rect[hmi_object_index].h; HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_rect_temp), (&(hmi_screen_rect)));  #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513)) hmi_get_intersec_rect((HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_screen_rect, &(new_cliped_farther_rect )); hmi_get_intersec_rect_depth((HMI_RECT_STR CONST *)(&(new_cliped_farther_rect)), depth,(HMI_RECT_STR *)pdirty_rect,&hmi_clip_rect);  #endif #ifdef HMI_GRAPHIC_AGG call_C_hmi_driver_draw_image(&(hmi_screen_rect), hmi_bigbitmap_table[0],hmi_bigbitmap_table[1],&hmi_bmp_static_xy_prop_table[hmi_object_index],&hmi_draw_rect); hmi_engine_draw_container(&hmi_sxy_bitmap_container_table[hmi_object_index], (HMI_RECT_STR CONST *)&(hmi_screen_rect), (HMI_RECT_STR CONST *)pdirty_rect,depth, &new_cliped_farther_rect/*all father insection zone*/); #endif   #ifdef HMI_GRAPHIC_RGL if((hmi_clip_rect.x!=HMI_INVALID_COOR)|| (hmi_clip_rect.y!=HMI_INVALID_COOR)) { call_C_hmi_driver_draw_image(&(hmi_screen_rect)/*node screen position*/,  hmi_sxy_bitmap_attr_table[hmi_object_index]/*image format*/, (HMI_RECT_ALPHA_ANGEL_STR *)(&hmi_bmp_static_xy_rect[hmi_object_index])/*alpha,rotation*/, &hmi_bmp_static_xy_prop_table[hmi_object_index], &hmi_clip_rect, pdirty_rect, depth, NULL/*rotation point is center*/, hmi_object_id, father_alpha); if(father_alpha>hmi_bmp_static_xy_rect[hmi_object_index].alpha) { father_alpha=hmi_bmp_static_xy_rect[hmi_object_index].alpha; } hmi_engine_draw_container(&hmi_sxy_bitmap_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&(hmi_screen_rect)), (HMI_RECT_STR *)pdirty_rect,depth, &new_cliped_farther_rect/*all father insection zone*/ ,father_alpha); } #endif  #ifdef HMI_GRAPHIC_ST7513 call_C_hmi_driver_draw_image(&(hmi_screen_rect)/*node screen position*/,  &hmi_bmp_static_xy_prop_table[hmi_object_index], &hmi_clip_rect);  hmi_engine_draw_container(&hmi_sxy_bitmap_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&(hmi_screen_rect)), (HMI_RECT_STR *)pdirty_rect,depth, &new_cliped_farther_rect/*all father insection zone*/); #endif  #ifdef HMI_GRAPHIC_TWLIB bMerge=hmi_get_is_merge(parent_object_id_type,HMI_ELEM_TYPE_SIMAGE); #if HMI_RENDER_ALL_EXCEPT_BCK==NO if(((!only_draw_flag)||!hmi_is_render_mode())||/*simulate*/ (only_draw_flag&&(flag))) #endif { call_C_hmi_driver_draw_image(&(hmi_screen_rect), FALSE/*&hmi_sxy_bitmap_attr_table[hmi_object_id]*/, (HMI_RECT_ALPHA_ANGEL_STR *)(&hmi_bmp_static_xy_rect[hmi_object_index]), &hmi_bmp_static_xy_prop_table[hmi_object_index]/*, TRUE*/, bMerge  #if HMI_RENDER_ALL_EXCEPT_BCK==NO ,parent_object_id ,hmi_object_id_const #endif );  } if(hmi_sxy_bitmap_container_table[hmi_object_index].container_object_table.object_number>0) { hmi_engine_draw_container(&(hmi_sxy_bitmap_container_table[hmi_object_index]), (HMI_RECT_STR CONST *)(&(hmi_screen_rect)), HMI_ELEM_TYPE_SIMAGE , hmi_object_id_const, FALSE #if HMI_RENDER_ALL_EXCEPT_BCK==NO ,phmi_object_prop_table->object_id  ,only_draw_flag&&(!flag) #endif );  } #endif    } }  else #endif   #if HMI_SXY_CONTAINERS_NUMBER > 0  if(HMI_IS_CONTAINERS_SXY(hmi_object_id)) { #if HMI_SXY_CONTAINERS_NUMBER >0 hmi_object_id = HMI_GET_CONTAINERS_SXY_ID_INDEX(hmi_object_id ); hmi_get_object_screen_coor((HMI_RECT_STR CONST *)pfarther_rect, &hmi_static_container_rect[hmi_object_id], &(hmi_screen_rect));  #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513)) hmi_get_intersec_rect((HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_screen_rect, &(new_cliped_farther_rect )); hmi_get_intersec_rect_depth((HMI_RECT_STR CONST *)(&(new_cliped_farther_rect)), depth,(HMI_RECT_STR *)pdirty_rect,&hmi_clip_rect);  #endif  #ifdef HMI_GRAPHIC_RGL if((hmi_clip_rect.x!=HMI_INVALID_COOR)|| (hmi_clip_rect.y!=HMI_INVALID_COOR)) { hmi_engine_draw_container(&hmi_sxy_container_table[hmi_object_id ], &(hmi_screen_rect),  pdirty_rect, depth,&new_cliped_farther_rect/*all father insection zone*/ ,father_alpha); } #endif  #ifdef HMI_GRAPHIC_ST7513 hmi_engine_draw_container(&hmi_sxy_container_table[hmi_object_id ], &(hmi_screen_rect),  pdirty_rect, depth,&new_cliped_farther_rect/*all father insection zone*/); #endif  #ifdef HMI_GRAPHIC_TWLIB /*tw*/ bMerge=hmi_get_is_merge(parent_object_id_type,HMI_ELEM_TYPE_SXY_CONTAINER); #if HMI_RENDER_ALL_EXCEPT_BCK==NO //if(((!only_draw_flag)||!hmi_is_render_mode())||/*simulate*/ //(only_draw_flag&&(flag))) #endif { if(hmi_sxy_container_table[hmi_object_id].container_object_table.object_number>0) { hmi_engine_draw_container(&hmi_sxy_container_table[hmi_object_id], (HMI_RECT_STR CONST *)(&(hmi_screen_rect)), HMI_ELEM_TYPE_SXY_CONTAINER, hmi_object_id_const, !bMerge #if HMI_RENDER_ALL_EXCEPT_BCK==NO ,phmi_object_prop_table->object_id  ,only_draw_flag&&(!flag) #endif );  } } #endif  #endif } else #endif  { ; }  } } #if 0 HMI_HEIGHT_STR hmi_get_layer_height(UINT8 layer) { #if HMI_ALL_LAYERS_NUMBER >0U return(hmi_layer_table[layer].h); #else return (0); #endif } HMI_WIDTH_STR hmi_get_layer_width(UINT8 layer) { #if HMI_ALL_LAYERS_NUMBER >0U return(hmi_layer_table[layer].w); #else return (0); #endif } #endif   #ifdef HMI_TOUCH_PANEL #if HMI_PAGES_NUMBER>0U HMI_OBJECT_ID_STR hmi_search_page(POINT_TP *phmi_point,BOOLEAN *phmi_is_button) {  UINT8 loop=0U; BOOLEAN stop_search=FALSE; HMI_OBJECT_ID_STR press_button_id=HMI_ALL_OBJECT; #if HMI_LAYER_0_HIGHEST_PRIORITY> 1U UINT8 hmi_highest_active_priority_U8=HMI_LAYER_0_HIGHEST_PRIORITY; #endif HMI_PAGE_ID_STR hmi_page_id=0U;  HMI_RECT_STR hmi_screen_rect={0,0,HMI_MAX_WIDTH,HMI_MAX_HEIGHT};  #if HMI_LAYER_0_HIGHEST_PRIORITY > 1 { hmi_highest_active_priority_U8 = hmi_highest_active_page_priority; } if(hmi_highest_active_priority_U8 < HMI_LAYER_0_HIGHEST_PRIORITY) #endif { #if HMI_LAYER_0_HIGHEST_PRIORITY > 1  while((hmi_highest_active_priority_U8 >=0)&&(stop_search==FALSE)) #endif { #if HMI_LAYER_0_HIGHEST_PRIORITY > 1 hmi_page_id = hmi_layer_0_active_page_id[hmi_highest_active_priority_U8].new_page; #else hmi_page_id = hmi_layer_0_active_page_id[0].new_page; #endif #if HMI_DXY_PAGES_NUMBER>0U if(HMI_IS_DXY_PAGE(hmi_page_id)/*hmi_page_id<HMI_DXY_PAGES_NUMBER*/) {  hmi_page_id=HMI_GET_PAGE_DXY_ID_INDEX(hmi_page_id); hmi_get_object_screen_coor((HMI_RECT_STR CONST *)(&hmi_screen_rect), (&hmi_dxy_page_rect[hmi_page_id]), &hmi_screen_rect); press_button_id=hmi_search_container(&(hmi_dxy_page_table[hmi_page_id].container), (HMI_RECT_STR CONST *)(&hmi_screen_rect), phmi_point, phmi_is_button); } else #endif #if HMI_SXY_PAGES_NUMBER>0 { if(HMI_IS_SXY_PAGE(hmi_page_id)/*hmi_page_id<HMI_PAGE_SXY_MAX_ID*/) { hmi_page_id=HMI_GET_PAGE_SXY_ID_INDEX(hmi_page_id); hmi_get_object_screen_coor((HMI_RECT_STR CONST *)(&hmi_screen_rect), &hmi_sxy_page_rect[hmi_page_id], &hmi_screen_rect); press_button_id=hmi_search_container(&(hmi_sxy_page_table[hmi_page_id].container), (HMI_RECT_STR CONST *)(&hmi_screen_rect), phmi_point, phmi_is_button); } } #endif { }  if(press_button_id!=HMI_ALL_OBJECT) { stop_search=TRUE; } #if HMI_LAYER_0_HIGHEST_PRIORITY > 1 hmi_highest_active_priority_U8--; #endif } } return press_button_id; } #endif #endif  #ifdef HMI_TOUCH_PANEL HMI_OBJECT_ID_STR hmi_search_container(HMI_CONTAINER_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_container_info,HMI_RECT_STR CONST *phmi_father_rect,POINT_TP *phmi_point,BOOLEAN *phmi_is_button) REENTRANT { UINT8 hmi_number_object = phmi_container_info->container_object_table.object_number; HMI_OBJECT_PROP_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_container_object_table= phmi_container_info->container_object_table.p_object_table; BOOLEAN success=FALSE; HMI_OBJECT_ID_STR object_id=HMI_ALL_OBJECT;  if(hmi_judge_point_zone(phmi_father_rect,phmi_point)) { while((hmi_number_object > 0)&&(success==FALSE)) { hmi_number_object--; object_id=hmi_search_object(&phmi_container_object_table[hmi_number_object], phmi_father_rect, phmi_point, phmi_is_button); if(object_id !=HMI_ALL_OBJECT) { success=TRUE; } else { success=FALSE; }  #if 0 success=hmi_judge_point_zone(&object_rect, press_point); if(success) { object_id=phmi_container_object_table[hmi_number_object-1].object_id; } else { hmi_number_object--; } #endif } } return object_id; } #endif  #ifdef HMI_TOUCH_PANEL BOOLEAN hmi_judge_point_zone(HMI_RECT_STR CONST *rect_t,POINT_TP *point_t) { BOOLEAN ret=FALSE; if((point_t->x>=rect_t->x)&&(point_t->x<(rect_t->x+rect_t->w))) { if((point_t->y>=rect_t->y)&&(point_t->y<(rect_t->y+rect_t->h))) { ret=TRUE; } }  return ret; } #endif     #ifdef HMI_TOUCH_PANEL //?? search new element.sxy editable text... HMI_OBJECT_ID_STR hmi_search_object(HMI_OBJECT_PROP_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_object_prop_table,HMI_RECT_STR CONST* phmi_father_rect,POINT_TP *phmi_point,BOOLEAN *phmi_is_button) REENTRANT { HMI_OBJECT_ID_STR hmi_object_id= phmi_object_prop_table->object_id; HMI_OBJECT_ID_STR hmi_object_id_index=0U; HMI_RECT_STR hmi_temp_rect={0,0,0,0}; HMI_OBJECT_ID_STR hmi_id_index=HMI_ALL_OBJECT; HMI_OBJECT_ID_STR press_button_id=HMI_ALL_OBJECT;  if(hmi_object_id >= HMI_PAGE_SXY_MAX_ID) { #if HMI_DXY_IMAGELIST_NUMBER>0 if(HMI_IS_DYN_IMAGELIST_DXY(hmi_object_id)/*hmi_object_id < HMI_DYN_IMAGELIST_DXY_MAX_ID*/) { hmi_object_id_index = HMI_GET_DYN_IMAGELIST_DXY_ID_INDEX(hmi_object_id); HMI_GET_OBJECT_SCREEN_COOR(((HMI_RECT_STR CONST *)phmi_father_rect), (&hmi_dxy_imagelist_rect[hmi_object_id_index]), (&hmi_temp_rect)); if(hmi_judge_point_zone(&hmi_temp_rect,phmi_point)) { press_button_id=hmi_search_container(&hmi_dxy_imagelist_container_table[hmi_object_id_index], &hmi_temp_rect,phmi_point, phmi_is_button); if(press_button_id==HMI_ALL_OBJECT) { press_button_id=hmi_object_id; } } } else #endif #if HMI_SXY_IMAGELIST_NUMBER>0 if(HMI_IS_DYN_IMAGELIST_SXY(hmi_object_id)/*hmi_object_id < HMI_DYN_IMAGELIST_SXY_MAX_ID*/) { hmi_object_id_index = HMI_GET_DYN_IMAGELIST_SXY_ID_INDEX(hmi_object_id); HMI_GET_OBJECT_SCREEN_COOR(((HMI_RECT_STR CONST *)phmi_father_rect) ,(&hmi_sxy_imagelist_rect[hmi_object_id_index]) ,(&hmi_temp_rect)); if(hmi_judge_point_zone(&hmi_temp_rect,phmi_point)) { press_button_id=hmi_search_container(&hmi_sxy_imagelist_container_table[hmi_object_id_index], &hmi_temp_rect,phmi_point, phmi_is_button); if(press_button_id==HMI_ALL_OBJECT) { press_button_id=hmi_object_id; } }  }  else #endif #if HMI_DXY_SCROLLBAR_NUMBER>0 if(HMI_IS_DYN_SCROLLBAR_DXY(hmi_object_id)/*hmi_object_id < HMI_DYN_SCROLLBAR_DXY_MAX_ID*/) { hmi_object_id_index = HMI_GET_DYN_SCROLLBAR_DXY_ID_INDEX(hmi_object_id); HMI_GET_OBJECT_SCREEN_COOR(((HMI_RECT_STR CONST *)phmi_father_rect),(&hmi_dxy_scrollbar_rect[hmi_object_id_index]),(&hmi_temp_rect)); if(hmi_judge_point_zone(&hmi_temp_rect,phmi_point)) { press_button_id=hmi_search_container(&hmi_dxy_scrollbar_container_table[hmi_object_id_index], &hmi_temp_rect,phmi_point, phmi_is_button); if(press_button_id==HMI_ALL_OBJECT) { press_button_id=hmi_object_id; } }  }  else #endif #if HMI_SXY_SCROLLBAR_NUMBER>0 if(HMI_IS_DYN_SCROLLBAR_SXY(hmi_object_id)/*hmi_object_id < HMI_DYN_SCROLLBAR_SXY_MAX_ID*/) { hmi_object_id_index = HMI_GET_DYN_SCROLLBAR_SXY_ID_INDEX(hmi_object_id); HMI_GET_OBJECT_SCREEN_COOR(((HMI_RECT_STR CONST *)phmi_father_rect),(&hmi_sxy_scrollbar_rect[hmi_object_id_index]),(&hmi_temp_rect)); if(hmi_judge_point_zone(&hmi_temp_rect,phmi_point)) { press_button_id=hmi_search_container(&hmi_sxy_scrollbar_container_table[hmi_object_id_index], &hmi_temp_rect,phmi_point, phmi_is_button); if(press_button_id==HMI_ALL_OBJECT) { press_button_id=hmi_object_id; } }  }  else #endif #if HMI_DXY_BUTTON_NUMBER>0 if(HMI_IS_DYN_BUTTON_DXY(hmi_object_id)/*hmi_object_id < HMI_DYN_BUTTON_DXY_MAX_ID*/) { hmi_object_id_index = HMI_GET_DYN_BUTTON_DXY_ID_INDEX(hmi_object_id);  if(hmi_dxy_button_press_status[hmi_object_id_index]!=HMI_BUTTON_DISABLE_INDEX) { HMI_GET_OBJECT_SCREEN_COOR(((HMI_RECT_STR CONST *)phmi_father_rect),(&hmi_dxy_button_rect[hmi_object_id_index]),(&hmi_temp_rect));  if(hmi_judge_point_zone(&hmi_temp_rect,phmi_point)) { *phmi_is_button=TRUE; press_button_id=hmi_search_container(&hmi_dxy_button_container_table[hmi_object_id_index], &hmi_temp_rect,phmi_point, phmi_is_button); if((press_button_id<HMI_DYN_SCROLLBAR_SXY_MAX_ID)||(press_button_id>=HMI_DYN_BUTTON_SXY_MAX_ID)) { press_button_id=hmi_object_id; } } } } else #endif #if HMI_SXY_BUTTON_NUMBER>0 if(HMI_IS_DYN_BUTTON_SXY(hmi_object_id)/*hmi_object_id < HMI_DYN_BUTTON_SXY_MAX_ID*/) { hmi_object_id_index = HMI_GET_DYN_BUTTON_SXY_ID_INDEX(hmi_object_id); if(hmi_sxy_button_press_status[hmi_object_id_index]!=HMI_BUTTON_DISABLE_INDEX) { hmi_get_object_screen_coor((HMI_RECT_STR CONST *)phmi_father_rect,(HMI_RECT_STR CONST *)(&hmi_sxy_button_rect[hmi_object_id_index]),&hmi_temp_rect); if(hmi_judge_point_zone(&hmi_temp_rect,phmi_point)) { *phmi_is_button=TRUE; press_button_id=hmi_search_container(&hmi_sxy_button_container_table[hmi_object_id_index], &hmi_temp_rect,phmi_point, phmi_is_button); if((press_button_id<HMI_DYN_SCROLLBAR_SXY_MAX_ID)||(press_button_id>=HMI_DYN_BUTTON_SXY_MAX_ID)) { press_button_id=hmi_object_id; } } } } else #endif #if HMI_DYN_EDIT_TEXTS_NUMBER > 0  if(hmi_object_id < HMI_DYN_TEXTS_MAX_ID) { hmi_object_id_index = HMI_GET_DYN_TEXTS_INDEX(hmi_object_id); #if HMI_DYN_XY_EDIT_TEXTS_NUMBER > 0 if(hmi_object_id_index < HMI_DYN_XY_EDIT_TEXTS_NUMBER) { hmi_get_object_screen_coor((HMI_RECT_STR CONST *)phmi_father_rect,&hmi_dyn_xy_edit_text_prop_table[hmi_object_id_index].text_rect,&hmi_temp_rect);  } else #endif { #if HMI_DYN_EDIT_TEXTS_NUMBER-HMI_DYN_XY_EDIT_TEXTS_NUMBER>0 hmi_get_object_screen_coor((HMI_RECT_STR CONST *)phmi_father_rect,&hmi_static_xy_edit_text_prop_table[hmi_object_id_index -HMI_DYN_XY_EDIT_TEXTS_NUMBER].text_rect,&hmi_temp_rect); #endif  } if(hmi_judge_point_zone(&hmi_temp_rect,phmi_point)) { #if HMI_TEXT_MAX_SON_CNT > 0 press_button_id=hmi_search_container(&hmi_edit_text_container_table[hmi_object_id_index], &hmi_temp_rect,phmi_point, phmi_is_button); #else press_button_id=HMI_ALL_OBJECT; #endif if(press_button_id==HMI_ALL_OBJECT) { press_button_id=hmi_object_id; } }  } else #endif #if HMI_DYN_CONTAINERS_NUMBER > 0 if(HMI_IS_DYN_CONTAINER(hmi_object_id)/*hmi_object_id < HMI_DYN_CONTAINERS_MAX_ID*/) { #if HMI_ALL_STATIC_CONTAINERS_NUMBER > 0  hmi_object_id = HMI_GET_DYN_CONTAINERS_ID_INDEX(hmi_object_id); hmi_engine_get_static_container_id(&hmi_object_id ); #if HMI_DXY_CONTAINERS_NUMBER>0U if(HMI_IS_DYN_XY_CONTAINER(hmi_object_id)/*(hmi_object_id >= HMI_DYN_GFILL_MAX_ID) && (hmi_object_id < HMI_DYN_XY_CONTAINER_MAX_ID)*/) { hmi_object_id = HMI_GET_DYN_XY_CONTAINER_INDEX(hmi_object_id ); hmi_get_object_screen_coor((HMI_RECT_STR CONST *)phmi_father_rect,&hmi_dyn_xy_container_rect[hmi_object_id],&hmi_temp_rect); press_button_id=hmi_search_container(&hmi_dyn_xy_container_table[hmi_object_id], &hmi_temp_rect,phmi_point, phmi_is_button); } #endif #if HMI_SXY_CONTAINERS_NUMBER>0 if(HMI_IS_CONTAINERS_SXY(hmi_object_id)/*(hmi_object_id >= HMI_BITMAPS_MAX_ID) && (hmi_object_id < HMI_CONTAINERS_MAX_ID)*/) { hmi_object_id = HMI_GET_CONTAINERS_SXY_ID_INDEX(hmi_object_id ); hmi_get_object_screen_coor((HMI_RECT_STR CONST *)phmi_father_rect,&hmi_static_container_rect[hmi_object_id],&hmi_temp_rect); press_button_id=hmi_search_container(&hmi_sxy_container_table[hmi_object_id], &hmi_temp_rect,phmi_point, phmi_is_button); } else #endif { } #endif } else #endif #if HMI_DYN_FILL_PAGES_NUMBER > 0 if(HMI_IS_DYN_NFILL(hmi_object_id)/*hmi_object_id < HMI_DYN_NFILL_MAX_ID*/) { hmi_object_id_index = HMI_GET_DYN_NFILL_INDEX(hmi_object_id ); HMI_GET_OBJECT_SCREEN_COOR(phmi_father_rect, (&hmi_fills_dyn_xy_rect[hmi_object_id_index]) ,(&hmi_temp_rect)); if(hmi_judge_point_zone(&hmi_temp_rect,phmi_point)) { press_button_id=hmi_search_container(&hmi_dyn_fill_container_table[hmi_object_id_index], &hmi_temp_rect,phmi_point, phmi_is_button); if(press_button_id==HMI_ALL_OBJECT) { press_button_id=hmi_object_id; } } } else #endif #if HMI_DYN_GFILL_NUMBER > 0 if(HMI_IS_DYN_GFILL(hmi_object_id)/*hmi_object_id < HMI_DYN_GFILL_MAX_ID*/) { hmi_object_id_index = HMI_GET_DYN_GFILL_INDEX(hmi_object_id ); hmi_get_object_screen_coor((HMI_RECT_STR CONST *)phmi_father_rect,&hmi_gradient_dxy_fill_rect[hmi_object_id_index],&hmi_temp_rect); if(hmi_judge_point_zone(&hmi_temp_rect,phmi_point)) { press_button_id=hmi_search_container(&hmi_dyn_gfill_container_table[hmi_object_id_index], &hmi_temp_rect,phmi_point, phmi_is_button); if(press_button_id==HMI_ALL_OBJECT) { press_button_id=hmi_object_id; } } } else #endif #if HMI_DXY_CUBE_NUMBER > 0 if(HMI_IS_DYN_CUBE(hmi_object_id)/*hmi_object_id < HMI_DYN_GFILL_MAX_ID*/) { hmi_object_id_index = HMI_GET_DYN_CUBE_INDEX(hmi_object_id ); hmi_get_object_screen_coor((HMI_RECT_STR CONST *)phmi_father_rect,&hmi_cubes_dyn_xy_rect[hmi_object_id_index].cube_rect,&hmi_temp_rect); if(hmi_judge_point_zone(&hmi_temp_rect,phmi_point)) { press_button_id=hmi_object_id; } } else #endif #if HMI_DXY_CONTAINERS_NUMBER>0U if(HMI_IS_DYN_XY_CONTAINER(hmi_object_id)/*hmi_object_id < HMI_DYN_XY_CONTAINER_MAX_ID*/) { hmi_object_id = HMI_GET_DYN_XY_CONTAINER_INDEX(hmi_object_id ); hmi_get_object_screen_coor((HMI_RECT_STR CONST *)phmi_father_rect,&hmi_dyn_xy_container_rect[hmi_object_id],&hmi_temp_rect); press_button_id=hmi_search_container(&hmi_dyn_xy_container_table[hmi_object_id], &hmi_temp_rect,phmi_point, phmi_is_button); } else #endif #if HMI_DXY_BITMAPS_NUMBER> 0 if(HMI_IS_DYN_XY_BITMAP(hmi_object_id)/*hmi_object_id < HMI_DYN_XY_BITMAP_MAX_ID*/) { hmi_object_id_index = HMI_GET_DYN_XY_BITMAP_INDEX(hmi_object_id); if(hmi_object_id_index < HMI_DXY_BITMAPS_NUMBER) { HMI_GET_OBJECT_SCREEN_COOR(phmi_father_rect, (&hmi_bmp_dyn_xy_rect[hmi_object_id_index]), (&hmi_temp_rect)); if(hmi_judge_point_zone(&hmi_temp_rect,phmi_point)) { press_button_id=hmi_search_container(&hmi_dxy_bitmap_container_table[hmi_object_id_index], &hmi_temp_rect,phmi_point, phmi_is_button); if(press_button_id==HMI_ALL_OBJECT) { press_button_id=hmi_object_id; } } }  } else #endif #if HMI_STATIC_FILL_PAGES_NUMBER > 0 if(HMI_IS_SXY_FILL_PAGES(hmi_object_id)/*hmi_object_id < HMI_FILL_PAGES_MAX_ID*/) { hmi_object_id_index= HMI_GET_SXY_FILL_PAGES_ID_INDEX(hmi_object_id ); HMI_GET_OBJECT_SCREEN_COOR(phmi_father_rect, (&hmi_fills_static_xy_rect[hmi_object_id_index]) ,(&hmi_temp_rect)); if(hmi_judge_point_zone(&hmi_temp_rect,phmi_point)) { press_button_id=hmi_search_container(&hmi_static_fill_container_table[hmi_object_id_index],&hmi_temp_rect,phmi_point,phmi_is_button); if(press_button_id==HMI_ALL_OBJECT) { press_button_id=hmi_object_id; } }  } else #endif #if HMI_STATIC_GFILL_NUMBER> 0 if(HMI_IS_SXY_GFILL_PAGES(hmi_object_id)/*hmi_object_id < HMI_GFILL_PAGES_MAX_ID*/) { hmi_object_id_index = HMI_GET_SXY_GFILL_PAGES_ID_INDEX(hmi_object_id); hmi_get_object_screen_coor((HMI_RECT_STR CONST *)phmi_father_rect, &hmi_gradient_sxy_fill_rect[hmi_object_id_index ], &hmi_temp_rect); if(hmi_judge_point_zone(&hmi_temp_rect,phmi_point)) { press_button_id=hmi_search_container(&hmi_static_gfill_container_table[hmi_object_id_index], &hmi_temp_rect,phmi_point, phmi_is_button); if(press_button_id==HMI_ALL_OBJECT) { press_button_id=hmi_object_id; } }  } else #endif #if HMI_SXY_CUBE_NUMBER > 0 if(HMI_IS_SXY_CUBE(hmi_object_id)/*hmi_object_id < HMI_DYN_GFILL_MAX_ID*/) { hmi_object_id_index = HMI_GET_SXY_CUBE_ID_INDEX(hmi_object_id ); hmi_get_object_screen_coor((HMI_RECT_STR CONST *)phmi_father_rect,&hmi_cubes_static_xy_rect[hmi_object_id_index].cube_rect,&hmi_temp_rect); if(hmi_judge_point_zone(&hmi_temp_rect,phmi_point)) { press_button_id=hmi_object_id; } } else #endif #if HMI_SXY_BITMAPS_NUMBER> 0 if(HMI_IS_S_XY_BITMAP(hmi_object_id)/*hmi_object_id < HMI_BITMAPS_MAX_ID*/) { hmi_object_id_index = HMI_GET_SXY_BITMAPS_ID_INDEX(hmi_object_id); if(hmi_object_id_index < HMI_SXY_BITMAPS_NUMBER) { HMI_GET_OBJECT_SCREEN_COOR(phmi_father_rect, (&hmi_bmp_static_xy_rect[hmi_object_id_index]), (&hmi_temp_rect)); if(hmi_judge_point_zone(&hmi_temp_rect,phmi_point)) { press_button_id=hmi_search_container(&hmi_sxy_bitmap_container_table[hmi_object_id_index], &hmi_temp_rect,phmi_point, phmi_is_button); if(press_button_id==HMI_ALL_OBJECT) { press_button_id=hmi_object_id; } } }  } else #endif #if HMI_SXY_CONTAINERS_NUMBER > 0 if(HMI_IS_CONTAINERS_SXY(hmi_object_id)/*hmi_object_id < HMI_CONTAINERS_MAX_ID*/) { #if HMI_SXY_CONTAINERS_NUMBER >0 hmi_object_id = HMI_GET_CONTAINERS_SXY_ID_INDEX(hmi_object_id ); hmi_get_object_screen_coor((HMI_RECT_STR CONST *)phmi_father_rect,&hmi_static_container_rect[hmi_object_id],&hmi_temp_rect); press_button_id=hmi_search_container(&hmi_sxy_container_table[hmi_object_id], &hmi_temp_rect,phmi_point, phmi_is_button); #endif } else #endif #if 0/*HMI_STATIC_TEXTS_NUMBER > 0 HMI_Data/ HMI_Source/ HMI_Tool/ //test ?? if(hmi_object_id < HMI_STATIC_TEXTS_MAX_ID) { hmi_object_id_index = HMI_GET_STATIC_TEXT_ID_INDEX(hmi_object_id ); hmi_get_object_screen_coor((HMI_RECT_STR CONST *)phmi_father_rect, &(hmi_static_xy_static_text_prop_table[hmi_object_id_index].text_rect), &hmi_temp_rect); if(hmi_judge_point_zone(&hmi_temp_rect,phmi_point)) { #if HMI_TEXT_MAX_SON_CNT > 0 press_button_id=hmi_search_container(&hmi_static_text_container_table[hmi_object_id_index],&hmi_temp_rect,phmi_point,phmi_is_button); #else press_button_id=HMI_ALL_OBJECT; #endif if(press_button_id==HMI_ALL_OBJECT) { press_button_id=hmi_object_id; } }  } else #endif #if HMI_STATIC_TEXTS_NUMBER > 0  if(HMI_IS_STATIC_TEXTS(hmi_object_id)) {  if(HMI_IS_UNEDIT_TEXT_DYN_XY(hmi_object_id)) { hmi_object_id_index = HMI_GET_DYN_XY_UNEDIT_POS_COLOR_INDEX(hmi_object_id); #if HMI_UNEDIT_TEXTS_DYN_XY_NUMBER > 0 if(hmi_object_id_index < HMI_UNEDIT_TEXTS_DYN_XY_NUMBER) { hmi_get_object_screen_coor((HMI_RECT_STR CONST *)phmi_father_rect, &hmi_dyn_xy_unedit_text_prop_table[hmi_object_id_index].text_rect, &hmi_temp_rect); hmi_object_id_index=HMI_GET_STATIC_TEXT_ID_INDEX(hmi_object_id);/*sxy,dxy uneditable container save at one array*/ if(hmi_judge_point_zone(&hmi_temp_rect,phmi_point)) { if(hmi_object_id_index<HMI_STATIC_TEXTS_NUMBER) { #if HMI_TEXT_MAX_SON_CNT > 0 press_button_id=hmi_search_container(&hmi_static_text_container_table[hmi_object_id_index], &hmi_temp_rect,phmi_point,phmi_is_button); #else press_button_id=HMI_ALL_OBJECT; #endif if(press_button_id==HMI_ALL_OBJECT) { press_button_id=hmi_object_id; } } }  }  #endif } else if(HMI_IS_UNEDIT_TEXT_STATIC_XY(hmi_object_id)) { hmi_object_id_index = HMI_GET_S_XY_UNEDIT_POS_COLOR_INDEX(hmi_object_id); #if HMI_UNEDIT_TEXTS_STATIC_XY_NUMBER > 0 if(hmi_object_id_index < HMI_UNEDIT_TEXTS_STATIC_XY_NUMBER) { hmi_get_object_screen_coor((HMI_RECT_STR CONST *)phmi_father_rect, &hmi_static_xy_unedit_text_prop_table[hmi_object_id_index].text_rect, &hmi_temp_rect); hmi_object_id_index=HMI_GET_STATIC_TEXT_ID_INDEX(hmi_object_id); if(hmi_judge_point_zone(&hmi_temp_rect,phmi_point)) { if(hmi_object_id_index<HMI_STATIC_TEXTS_NUMBER) { #if HMI_TEXT_MAX_SON_CNT > 0 press_button_id=hmi_search_container(&hmi_static_text_container_table[hmi_object_id_index], &hmi_temp_rect,phmi_point,phmi_is_button); #else press_button_id=HMI_ALL_OBJECT; #endif if(press_button_id==HMI_ALL_OBJECT) { press_button_id=hmi_object_id; } } }  }  #endif } else{}   } else #endif { }  } return (press_button_id); } #endif  #if 0 void hmi_get_button_id(POINT_TP *pPoint,UINT8 press_status) { HMI_OBJECT_ID_STR button_id=HMI_ALL_OBJECT; #if HMI_PAGES_NUMBER >0U button_id=hmi_search_page(pPoint); #endif if(button_id !=HMI_ALL_OBJECT) {  hmi_engine_set_object_info(button_id,press_status); #if HMI_EVENT_STAND_NUMBER>0 hmi_do_event(button_id,press_status); #endif } } #endif   /* get element property id */ #if HMI_SET_ACTION_NUMBER>0 /*Set action number>0*/ HMI_OBJECT_ID_STR hmi_get_obj_pro_id(HMI_OBJECT_ID_STR hmi_object_id,UINT8 pro_order) { HMI_OBJECT_ID_STR element_pro_id=HMI_NB_ELEMENTS;  if(hmi_object_id < HMI_DYN_ELEMENT_END_ID) /*dyn element*/ { #if HMI_DXY_PAGES_NUMBER>0 if(HMI_IS_DXY_PAGE(hmi_object_id)) { hmi_object_id = HMI_GET_PAGE_DXY_ID_INDEX(hmi_object_id); element_pro_id = (HMI_DYN_TRAIL_BITMAP_MAX_ID+pro_order*HMI_DXY_PAGES_NUMBER); } else #endif #if HMI_DXY_IMAGELIST_NUMBER>0 if(HMI_IS_DYN_IMAGELIST_DXY(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_IMAGELIST_DXY_ID_INDEX(hmi_object_id); element_pro_id =(HMI_DYN_ALPHA_PAGES_MAX_ID+pro_order*HMI_DXY_IMAGELIST_NUMBER); } else #endif #if HMI_DXY_BITMAPS_NUMBER>0 if(HMI_IS_DYN_XY_BITMAP(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_XY_BITMAP_INDEX(hmi_object_id); element_pro_id =(HMI_DYN_H_CONTAINER_MAX_ID+pro_order*HMI_DXY_BITMAPS_NUMBER); } else #endif #if HMI_DXY_SCROLLBAR_NUMBER>0 if(HMI_IS_DYN_SCROLLBAR_DXY(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_SCROLLBAR_DXY_ID_INDEX(hmi_object_id); element_pro_id = (HMI_DYN_ALPHA_IMAGELIST_MAX_ID+pro_order*HMI_DXY_SCROLLBAR_NUMBER); } else #endif #if HMI_DXY_BUTTON_NUMBER>0 if(HMI_IS_DYN_BUTTON_DXY(hmi_object_id)) {  hmi_object_id = HMI_GET_DYN_BUTTON_DXY_ID_INDEX(hmi_object_id); element_pro_id = (HMI_DYN_ALPHA_SCROLLBAR_MAX_ID+pro_order*HMI_DXY_BUTTON_NUMBER);  } else #endif #if HMI_DYN_XY_EDIT_TEXTS_NUMBER>0 if(HMI_IS_DYN_TEXT_DXY(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_TEXTS_DXY_POS_INDEX(hmi_object_id); element_pro_id = (HMI_DYN_COLOR_UNEDIT_MAX_ID+pro_order*HMI_DYN_XY_EDIT_TEXTS_NUMBER); } else #endif #if HMI_DYN_FILL_PAGES_NUMBER > 0 /*dxy gfill*/ if(HMI_IS_DYN_NFILL(hmi_object_id) ) { hmi_object_id = HMI_GET_DYN_NFILL_INDEX(hmi_object_id); element_pro_id = (HMI_DYN_DCOLOR_DTEXT_MAX_ID+pro_order*HMI_DYN_FILL_PAGES_NUMBER); } else #endif #if HMI_DYN_GFILL_NUMBER>0 if(HMI_IS_DYN_GFILL(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_GFILL_INDEX(hmi_object_id); element_pro_id = (HMI_DYN_Z_NFILL_MAX_ID+pro_order*HMI_DYN_GFILL_NUMBER);  } else #endif #if HMI_DXY_CUBE_NUMBER>0 if(HMI_IS_DYN_CUBE(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_CUBE_INDEX(hmi_object_id); element_pro_id = (HMI_DYN_Z_GFILL_MAX_ID+pro_order*HMI_DXY_CUBE_NUMBER);  } else #endif #if HMI_DXY_CONTAINERS_NUMBER>0 if(HMI_IS_DYN_XY_CONTAINER(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_XY_CONTAINER_INDEX(hmi_object_id); element_pro_id = (HMI_DYN_ELEMENT_END_ID+pro_order*HMI_DXY_CONTAINERS_NUMBER);  } else #endif #if HMI_UNEDIT_TEXTS_DYN_XY_NUMBER>0 if(HMI_IS_UNEDIT_TEXT_DYN_XY(hmi_object_id)) { hmi_object_id = HMI_GET_DYN_XY_UNEDIT_POS_COLOR_INDEX(hmi_object_id); element_pro_id = (HMI_DYN_ALPHA_BUTTON_MAX_ID+pro_order*HMI_UNEDIT_TEXTS_DYN_XY_NUMBER);  } else #endif { element_pro_id =HMI_NB_ELEMENTS; hmi_object_id =0; } } element_pro_id+=hmi_object_id;  return element_pro_id; } #endif  #ifdef HMI_GRAPHIC_RGL  void hmi_get_nextFrame(void) { } #endif #ifdef HMI_GRAPHIC_RGL #if ((HMI_DXY_IMAGELIST_NUMBER+HMI_SXY_IMAGELIST_NUMBER+ \ HMI_DXY_SCROLLBAR_NUMBER+HMI_SXY_SCROLLBAR_NUMBER+ \ HMI_DXY_BUTTON_NUMBER+HMI_SXY_BUTTON_NUMBER+ \ HMI_DXY_BITMAPS_NUMBER+HMI_SXY_BITMAPS_NUMBER)>0)  void call_C_hmi_driver_remove_load_file(HMI_CONTAINER_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_container_info) { UINT8 hmi_number_object = phmi_container_info->container_object_table.object_number; HMI_OBJECT_PROP_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_container_object_table= phmi_container_info->container_object_table.p_object_table; HMI_OBJECT_ID_STR hmi_object_id = 0; while(hmi_number_object > 0)  { hmi_object_id=phmi_container_object_table->object_id; free_image_res_manager(hmi_object_id); hmi_number_object--;  phmi_container_object_table++; } }  void hmi_load_file_to_vram(HMI_OBJECT_ID_STR hmi_object_id) { UINT8 *pImage_data = 0; U32 data_len = 0; HMI_OBJECT_ID_STR hmi_object_index = 0; if(hmi_object_id >= HMI_PAGE_SXY_MAX_ID)/*not a page*/ {  #if HMI_DXY_IMAGELIST_NUMBER>0 if(HMI_IS_DYN_IMAGELIST_DXY(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_IMAGELIST_DXY_ID_INDEX(hmi_object_id);  #ifdef HMI_GRAPHIC_RGL if(hmi_object_index < HMI_DXY_IMAGELIST_NUMBER) { pImage_data = (U08 *)(hmi_dxy_imagelist_table[hmi_object_index].file.pbitmap_data); data_len = hmi_dxy_imagelist_table[hmi_object_index].file.data_len; hmi_rgl_load_to_vram(hmi_object_id,(U08 *)pImage_data,data_len); } #endif  }  else #endif #if HMI_SXY_IMAGELIST_NUMBER>0 if(HMI_IS_DYN_IMAGELIST_SXY(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_IMAGELIST_SXY_ID_INDEX(hmi_object_id);  #ifdef HMI_GRAPHIC_RGL if(hmi_object_index < HMI_SXY_IMAGELIST_NUMBER) { pImage_data = (U08 *)(hmi_sxy_imagelist_table[hmi_object_index].file.pbitmap_data); data_len = hmi_sxy_imagelist_table[hmi_object_index].file.data_len; hmi_rgl_load_to_vram(hmi_object_id,(U08 *)pImage_data,data_len); } #endif  } else #endif  #if HMI_DXY_SCROLLBAR_NUMBER>0 if(HMI_IS_DYN_SCROLLBAR_DXY(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_SCROLLBAR_DXY_ID_INDEX(hmi_object_id);  #if HMI_SCROLLBAR_MAX_STATUS >= 0  {  if(hmi_object_index < HMI_DXY_SCROLLBAR_NUMBER) { pImage_data = (U08 *)(hmi_dxy_scrollbar_table[hmi_object_index].file.pbitmap_data); data_len = hmi_dxy_scrollbar_table[hmi_object_index].file.data_len; hmi_rgl_load_to_vram(hmi_object_id,(U08 *)pImage_data,data_len); } }  #endif  } else  #endif #if HMI_SXY_SCROLLBAR_NUMBER>0 if(HMI_IS_DYN_SCROLLBAR_SXY(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_SCROLLBAR_SXY_ID_INDEX(hmi_object_id);  #if HMI_SCROLLBAR_MAX_STATUS >= 0  if(hmi_object_index < HMI_SXY_SCROLLBAR_NUMBER) { pImage_data = (U08 *)(hmi_sxy_scrollbar_table[hmi_object_index].file.pbitmap_data); data_len = hmi_sxy_scrollbar_table[hmi_object_index].file.data_len; hmi_rgl_load_to_vram(hmi_object_id,(U08 *)pImage_data,data_len);  }  #endif  } else #endif #if HMI_DXY_BUTTON_NUMBER > 0  if(HMI_IS_DYN_BUTTON_DXY(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_BUTTON_DXY_ID_INDEX(hmi_object_id);  if(hmi_object_index < HMI_DXY_BUTTON_NUMBER) {  pImage_data = (U08 *)(hmi_dxy_button_table[hmi_object_index].button_image.file.pbitmap_data); data_len = hmi_dxy_button_table[hmi_object_index].button_image.file.data_len; hmi_rgl_load_to_vram(hmi_object_id,(U08 *)pImage_data,data_len);   }  }  else #endif  #if HMI_SXY_BUTTON_NUMBER>0  if(HMI_IS_DYN_BUTTON_SXY(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_BUTTON_SXY_ID_INDEX(hmi_object_id);  #ifdef HMI_GRAPHIC_RGL  if(hmi_object_index < HMI_SXY_BUTTON_NUMBER) { pImage_data = (U08 *)(hmi_sxy_button_table[hmi_object_index].button_image.file.pbitmap_data); data_len = hmi_sxy_button_table[hmi_object_index].button_image.file.data_len; hmi_rgl_load_to_vram(hmi_object_id,(U08 *)pImage_data,data_len); }  #endif  }  else  #endif #if HMI_DXY_BITMAPS_NUMBER> 0  if(HMI_IS_DYN_XY_BITMAP(hmi_object_id)) {  hmi_object_index = HMI_GET_DYN_XY_BITMAP_INDEX(hmi_object_id );  if(hmi_object_index < HMI_DXY_BITMAPS_NUMBER) { pImage_data = (U08 *)(hmi_bmp_dyn_xy_prop_table[hmi_object_index].pbitmap_data); data_len = hmi_bmp_dyn_xy_prop_table[hmi_object_index].data_len; hmi_rgl_load_to_vram(hmi_object_id,(U08 *)pImage_data,data_len); }  } else #endif  #if HMI_SXY_BITMAPS_NUMBER> 0 if(HMI_IS_S_XY_BITMAP(hmi_object_id)) {  hmi_object_index = HMI_GET_SXY_BITMAPS_ID_INDEX(hmi_object_id);  if(hmi_object_index < HMI_SXY_BITMAPS_NUMBER) {  pImage_data = (U08 *)(hmi_bmp_static_xy_prop_table[hmi_object_index].pbitmap_data); data_len = hmi_bmp_static_xy_prop_table[hmi_object_index].data_len; hmi_rgl_load_to_vram(hmi_object_id,(U08 *)pImage_data,data_len); } }  else #endif  { ; }   } }  void call_C_hmi_driver_load_file(HMI_CONTAINER_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_container_info) { UINT8 hmi_number_object = phmi_container_info->container_object_table.object_number; HMI_OBJECT_PROP_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_container_object_table= phmi_container_info->container_object_table.p_object_table; HMI_OBJECT_ID_STR hmi_object_id = 0;   while(hmi_number_object > 0)  { hmi_object_id=phmi_container_object_table->object_id; hmi_load_file_to_vram(hmi_object_id); hmi_number_object--;  phmi_container_object_table++; } }   #if (HMI_LOAD_SOURCE_MODE == HMI_LOAD_RES_ALL_INIT) void call_C_hmi_driver_load_all_file(void) { HMI_OBJECT_ID_STR hmi_object_id = 0;  while(hmi_object_id < HMI_EVENT_ACT_BEGIN_INDEX) { hmi_load_file_to_vram(hmi_object_id); hmi_object_id++; } } #endif  #if (HMI_LOAD_SOURCE_MODE == HMI_LOAD_RES_ONLY_ROTATION) void call_C_hmi_driver_load_rotation_file(void) { #if (HMI_DXY_BITMAPS_NUMBER != 0)  HMI_OBJECT_ID_STR hmi_object_id = HMI_DYN_XY_CONTAINER_MAX_ID;  HMI_OBJECT_ID_STR hmi_object_index= 0;  UINT8 *pImage_data = 0; U32 data_len = 0;  BOOLEAN rotation = FALSE; UINT8 bmp_alpha_rotation_flag = 0;  while(hmi_object_id < HMI_DYN_XY_BITMAP_MAX_ID) { hmi_object_index = HMI_GET_DYN_XY_BITMAP_INDEX(hmi_object_id );  if(hmi_object_index < HMI_DXY_BITMAPS_NUMBER) { pImage_data = (U08 *)(hmi_bmp_dyn_xy_prop_table[hmi_object_index].pbitmap_data); data_len = hmi_bmp_dyn_xy_prop_table[hmi_object_index].data_len; bmp_alpha_rotation_flag = hmi_dxy_bitmap_attr_table[hmi_object_index].image_attr&0xf0; rotation = bmp_alpha_rotation_flag&HMI_ROTATION_IMAGE_FLAG; if(rotation) { hmi_rgl_load_to_vram(hmi_object_id,(U08 *)pImage_data,data_len); } }  hmi_object_id++; } #endif } #endif #endif #endif     #if 0 void hmi_send_cmdlist( #if defined(HMI_GRAPHIC_TWLIB) BOOLEAN draw_all #endif ) { hmi_driver_send_cmdlist(draw_all); } #endif  #ifdef HMI_GRAPHIC_TWLIB #if 0 static void hmi_engine_check_dynamic_object_changed( HMI_CONTAINER_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_container_info, HMI_RECT_STR CONST *pfarther_rect,  HMI_RECT_STR *pcliped_farther_rect) { UINT8 hmi_number_object = phmi_container_info->container_object_table.object_number; UINT8 hmi_number_object_const = hmi_number_object; UINT8 hmi_page_redrawed_flag = FALSE; //UINT8 hmi_object_dirty_flag = FALSE; HMI_OBJECT_PROP_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_container_object_table = phmi_container_info->container_object_table.p_object_table; HMI_OBJECT_ID_STR hmi_object_id = 0U; HMI_OBJECT_ID_STR hmi_object_index= 0U; HMI_OBJECT_ID_STR hmi_check_index =0U; HMI_RECT_STR hmi_node_screen_rect = {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0}; HMI_RECT_STR hmi_insect_rect = {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0};    while((hmi_number_object > 0U) && (hmi_page_redrawed_flag == FALSE)) {  hmi_object_id = phmi_container_object_table[hmi_check_index].object_id; #if HMI_DXY_IMAGELIST_NUMBER>0 if(hmi_object_id < HMI_DYN_IMAGELIST_DXY_MAX_ID) { hmi_object_index = HMI_GET_DYN_IMAGELIST_DXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_DXY_IMAGELIST_NUMBER) { HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_dxy_imagelist_rect[hmi_object_index]), (&hmi_node_screen_rect)); } hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_insect_rect); if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_object_id) != 0) {  hmi_set_dirty_zone_layer((HMI_RECT_STR *)pcliped_farther_rect/*dxy node dirty zone is father zone*/, pdirty_rect,depth); hmi_page_redrawed_flag = TRUE; hmi_object_dirty_flag = TRUE;  hmi_engine_draw_object  } else {  if(hmi_object_index < HMI_DXY_IMAGELIST_NUMBER) { hmi_object_dirty_flag=hmi_engine_check_dynamic_object_changed( &hmi_dxy_imagelist_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect),  pdirty_rect, depth, &hmi_insect_rect); } } } else #endif #if HMI_SXY_IMAGELIST_NUMBER>0 if(hmi_object_id < HMI_DYN_IMAGELIST_SXY_MAX_ID) { hmi_object_index = HMI_GET_DYN_IMAGELIST_SXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_SXY_IMAGELIST_NUMBER) { HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_sxy_imagelist_rect[hmi_object_index]), (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_insect_rect); } if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_object_id)!=0) {  hmi_set_dirty_zone_layer((HMI_RECT_STR *)(&hmi_insect_rect),pdirty_rect,depth); /*hmi_page_redrawed_flag = TRUE;*/ hmi_object_dirty_flag=TRUE; } else {  if(hmi_object_index < HMI_SXY_IMAGELIST_NUMBER) { hmi_object_dirty_flag = hmi_engine_check_dynamic_object_changed( &hmi_sxy_imagelist_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect),  pdirty_rect, depth, &hmi_insect_rect); } } } else #endif #if HMI_DXY_SCROLLBAR_NUMBER>0 if(hmi_object_id < HMI_DYN_SCROLLBAR_DXY_MAX_ID) { hmi_object_index = HMI_GET_DYN_SCROLLBAR_DXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_DXY_SCROLLBAR_NUMBER) { HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_dxy_scrollbar_rect[hmi_object_index]), (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect,&hmi_insect_rect); } if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_object_id) != 0) { hmi_set_dirty_zone_layer((HMI_RECT_STR *)pcliped_farther_rect/*dxy node dirty zone is father zone*/, pdirty_rect,depth);  hmi_page_redrawed_flag = TRUE; hmi_object_dirty_flag = TRUE; } else {  if(hmi_object_index < HMI_DXY_SCROLLBAR_NUMBER) { hmi_object_dirty_flag=hmi_engine_check_dynamic_object_changed( &hmi_dxy_scrollbar_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect),  pdirty_rect, depth, &hmi_insect_rect); } } } else #endif #if HMI_SXY_SCROLLBAR_NUMBER>0 if(hmi_object_id < HMI_DYN_SCROLLBAR_SXY_MAX_ID) { hmi_object_index = HMI_GET_DYN_SCROLLBAR_SXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_SXY_SCROLLBAR_NUMBER) { HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_sxy_scrollbar_rect[hmi_object_index]), (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect,&hmi_insect_rect); } if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_object_id) != 0) { hmi_set_dirty_zone_layer(&hmi_insect_rect,pdirty_rect,depth);  /*hmi_page_redrawed_flag = TRUE;*/ hmi_object_dirty_flag=TRUE; } else { if(hmi_object_index < HMI_SXY_SCROLLBAR_NUMBER) { hmi_object_dirty_flag=hmi_engine_check_dynamic_object_changed( &hmi_sxy_scrollbar_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect),  pdirty_rect, depth, &hmi_insect_rect); } } } else #endif #if HMI_DXY_BUTTON_NUMBER>0 if(hmi_object_id < HMI_DYN_BUTTON_DXY_MAX_ID) { hmi_object_index = HMI_GET_DYN_BUTTON_DXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_DXY_BUTTON_NUMBER) { HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_dxy_button_rect[hmi_object_id]), (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_insect_rect); } if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_object_id) != 0) { hmi_set_dirty_zone_layer((HMI_RECT_STR *)pcliped_farther_rect/*dxy button dirty zone is father zone*/, pdirty_rect,depth); hmi_page_redrawed_flag = TRUE; hmi_object_dirty_flag = TRUE; } else {  if(hmi_object_index < HMI_DXY_BUTTON_NUMBER) { hmi_object_dirty_flag=hmi_engine_check_dynamic_object_changed( &hmi_dxy_button_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect, depth, &hmi_insect_rect); } } } else #endif #if HMI_SXY_BUTTON_NUMBER>0 if(hmi_object_id < HMI_DYN_BUTTON_SXY_MAX_ID) { hmi_object_index = HMI_GET_DYN_BUTTON_SXY_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_SXY_BUTTON_NUMBER) { HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_sxy_button_rect[hmi_object_index]), (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect,&hmi_insect_rect); } if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_object_id) != 0) { hmi_set_dirty_zone_layer(&hmi_insect_rect,pdirty_rect,depth);  /*hmi_page_redrawed_flag = TRUE;*/ hmi_object_dirty_flag=TRUE; } else { if(hmi_object_index < HMI_SXY_BUTTON_NUMBER) { hmi_object_dirty_flag=hmi_engine_check_dynamic_object_changed( &hmi_sxy_button_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect, depth, &hmi_insect_rect); } } } else #endif #if HMI_DYN_EDIT_TEXTS_NUMBER/*editable text*/ > 0  if(hmi_object_id < HMI_DYN_TEXTS_MAX_ID) {  #if HMI_DYN_XY_EDIT_TEXTS_NUMBER > 0 if(HMI_IS_DYN_TEXT_DXY(hmi_object_id)) { if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_object_id) != 0) { hmi_set_dirty_zone_layer((HMI_RECT_STR *)pcliped_farther_rect/*dxy text dirty zone is father zone*/, pdirty_rect,depth);  hmi_page_redrawed_flag = TRUE; hmi_object_dirty_flag = TRUE; } else { hmi_object_index = HMI_GET_DYN_TEXTS_DXY_POS_INDEX(hmi_object_id); if(hmi_object_index < HMI_DYN_XY_EDIT_TEXTS_NUMBER) { HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&(hmi_dyn_xy_edit_text_prop_table[hmi_object_index].text_rect)), (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect,&hmi_insect_rect); hmi_object_index = HMI_GET_DYN_TEXTS_INDEX(hmi_object_id);/*all editable text container info at one array*/ if(hmi_object_index < HMI_DYN_EDIT_TEXTS_NUMBER) { hmi_object_dirty_flag=hmi_engine_check_dynamic_object_changed( &hmi_edit_text_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect, depth,&hmi_insect_rect); }  } }  } else #endif #if HMI_S_XY_EDIT_TEXTS_NUMBER > 0 if(HMI_IS_DYN_TEXT_SXY(hmi_object_id)) { #if HMI_S_XY_EDIT_TEXTS_NUMBER > 0  hmi_object_index = HMI_GET_DYN_TEXTS_SXY_POS_INDEX(hmi_object_id); if(hmi_object_index < HMI_S_XY_EDIT_TEXTS_NUMBER) { HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&(hmi_static_xy_edit_text_prop_table[hmi_object_index].text_rect)), (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_insect_rect); }  #endif if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_object_id) != 0) { hmi_set_dirty_zone_layer(&hmi_insect_rect,pdirty_rect,depth);  /*hmi_page_redrawed_flag = TRUE;*/ hmi_object_dirty_flag = TRUE; } else { #if HMI_DYN_EDIT_TEXTS_NUMBER > 0  hmi_object_index = HMI_GET_DYN_TEXTS_INDEX(hmi_object_id);  if(hmi_object_index < HMI_DYN_EDIT_TEXTS_NUMBER) { hmi_object_dirty_flag=hmi_engine_check_dynamic_object_changed( &hmi_edit_text_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect,depth, &hmi_insect_rect); } #endif } } else #endif { }  } else #endif #if HMI_DYN_CONTAINERS_NUMBER/*dyn container*/ > 0  if(hmi_object_id < HMI_DYN_CONTAINERS_MAX_ID) { #if HMI_ALL_STATIC_CONTAINERS_NUMBER > 0  if(hmi_engine_check_container_changed(hmi_object_id, (HMI_RECT_STR CONST *)pfarther_rect, pdirty_rect,depth,pcliped_farther_rect) != FALSE) { hmi_page_redrawed_flag = TRUE; hmi_object_dirty_flag = TRUE; } #endif } else #endif #if HMI_DYN_FILL_PAGES_NUMBER > 0 if(hmi_object_id < HMI_DYN_NFILL_MAX_ID) { hmi_object_index = HMI_GET_DYN_NFILL_INDEX(hmi_object_id); if(hmi_object_index < HMI_DYN_FILL_PAGES_NUMBER) { HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_fills_dyn_xy_rect[hmi_object_index]), (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_insect_rect); } if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_object_id) != 0) { hmi_set_dirty_zone_layer((HMI_RECT_STR *)pcliped_farther_rect/*dxy fill dirty zone is father zone*/, pdirty_rect,depth);  hmi_page_redrawed_flag = TRUE; hmi_object_dirty_flag = TRUE; } else { if(hmi_object_index < HMI_DYN_FILL_PAGES_NUMBER) { hmi_object_dirty_flag=hmi_engine_check_dynamic_object_changed( &hmi_dyn_fill_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect, depth,&hmi_insect_rect); } } } else #endif #if HMI_DYN_GFILL_NUMBER > 0 if(hmi_object_id < HMI_DYN_GFILL_MAX_ID) { hmi_object_index = HMI_GET_DYN_GFILL_INDEX(hmi_object_id); if(hmi_object_index < HMI_DYN_GFILL_NUMBER) { HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_gradient_dxy_fill_rect[hmi_object_index]), (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect,&hmi_insect_rect); } if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_object_id) != 0) { hmi_set_dirty_zone_layer((HMI_RECT_STR *)pcliped_farther_rect/*dxy gfill dirty zone is father zone*/, pdirty_rect,depth); hmi_page_redrawed_flag = TRUE; hmi_object_dirty_flag = TRUE; } else { if(hmi_object_index < HMI_DYN_GFILL_NUMBER) { hmi_object_dirty_flag=hmi_engine_check_dynamic_object_changed( &hmi_dyn_gfill_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect, depth,&hmi_insect_rect); } } } else #endif #if HMI_DXY_CONTAINERS_NUMBER > 0U  if(hmi_object_id < HMI_DYN_XY_CONTAINER_MAX_ID) { if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_object_id) != 0) { hmi_set_dirty_zone_layer((HMI_RECT_STR *)pcliped_farther_rect/*dxy gfill dirty zone is father zone*/, pdirty_rect,depth); hmi_page_redrawed_flag = TRUE; hmi_object_dirty_flag = TRUE; } else { if(hmi_engine_check_container_changed(hmi_object_id, (HMI_RECT_STR CONST *)pfarther_rect,pdirty_rect,depth,pcliped_farther_rect) != FALSE) { hmi_object_dirty_flag = TRUE; } } } else #endif #if HMI_DXY_BITMAPS_NUMBER > 0 if(hmi_object_id < HMI_DYN_XY_BITMAP_MAX_ID) { hmi_object_index = HMI_GET_DYN_XY_BITMAP_INDEX(hmi_object_id); if(hmi_object_index < HMI_DXY_BITMAPS_NUMBER) { HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_bmp_dyn_xy_rect[hmi_object_index]), (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)(pcliped_farther_rect),&hmi_insect_rect); } if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_object_id) != 0) { hmi_set_dirty_zone_layer((HMI_RECT_STR *)pcliped_farther_rect/*dxy image dirty zone is father zone*/, pdirty_rect,depth);  hmi_page_redrawed_flag = TRUE; hmi_object_dirty_flag = TRUE; } else {  if(hmi_object_index < HMI_DXY_BITMAPS_NUMBER) {  hmi_object_dirty_flag = hmi_engine_check_dynamic_object_changed( &hmi_dxy_bitmap_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect, depth,&hmi_insect_rect); } } } else #endif #if HMI_STATIC_TEXTS_NUMBER > 0  if(hmi_object_id < HMI_STATIC_TEXTS_MAX_ID/*unedit text*/) { #if HMI_UNEDIT_TEXTS_DYN_XY_NUMBER>0 if(HMI_IS_UNEDIT_TEXT_DYN_XY(hmi_object_id)) { hmi_object_index = HMI_GET_DYN_XY_UNEDIT_POS_COLOR_INDEX(hmi_object_index); if(hmi_object_index < HMI_UNEDIT_TEXTS_DYN_XY_NUMBER) { HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&(hmi_dyn_xy_unedit_text_prop_table[hmi_object_id].text_rect)), (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_insect_rect); } if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_object_id) != 0) { hmi_set_dirty_zone_layer((HMI_RECT_STR *)pcliped_farther_rect/*dxy text dirty zone is father zone*/, pdirty_rect,depth);  hmi_page_redrawed_flag = TRUE; hmi_object_dirty_flag = TRUE; } else { hmi_object_index = HMI_GET_UNEDIT_INDEX(hmi_object_id);/*all uneditable text contain at one array*/ if(hmi_object_index < HMI_UNEDIT_TEXTS_DYN_XY_NUMBER) { hmi_object_dirty_flag = hmi_engine_check_dynamic_object_changed( &hmi_static_text_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect, depth,&hmi_insect_rect); } } } else #endif #if HMI_UNEDIT_TEXTS_STATIC_XY_NUMBER > 0 if(HMI_IS_UNEDIT_TEXT_STATIC_XY(hmi_object_id)) { hmi_object_index = HMI_GET_S_XY_UNEDIT_POS_COLOR_INDEX(hmi_object_id); if(hmi_object_index < HMI_UNEDIT_TEXTS_STATIC_XY_NUMBER) { HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_static_xy_unedit_text_prop_table[hmi_object_index].text_rect), (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_insect_rect); } if(HMI_IS_UNEDIT_TEXT_STATIC_XY_DYN_FONT(hmi_object_id)) { if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_object_id) != 0) { hmi_set_dirty_zone_layer(&hmi_insect_rect/*dfont image dirty zone is self zone*/, pdirty_rect,depth);  /*hmi_page_redrawed_flag = TRUE;*/ hmi_object_dirty_flag = TRUE; } else { hmi_object_index = HMI_GET_UNEDIT_INDEX(hmi_object_id);/*all uneditable text contain at one array*/ if(hmi_object_index < HMI_STATIC_TEXTS_NUMBER) { hmi_object_dirty_flag=hmi_engine_check_dynamic_object_changed( &hmi_static_text_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect, depth,&hmi_insect_rect); } } } else { hmi_object_index = HMI_GET_UNEDIT_INDEX(hmi_object_id);/*all uneditable text contain at one array*/ if(hmi_object_index < HMI_STATIC_TEXTS_NUMBER) { hmi_object_dirty_flag=hmi_engine_check_dynamic_object_changed( &hmi_static_text_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect, depth,&hmi_insect_rect); } } } else #endif { }  } else  #endif #if HMI_STATIC_FILL_PAGES_NUMBER > 0 if(HMI_IS_SXY_FILL_PAGES(hmi_object_id)) { hmi_object_index = HMI_GET_SXY_FILL_PAGES_ID_INDEX(hmi_object_id ); if(hmi_object_index<HMI_STATIC_FILL_PAGES_NUMBER) { HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_fills_static_xy_rect[hmi_object_index]), (&hmi_node_screen_rect)); } hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect,&hmi_insect_rect); if(hmi_object_index < HMI_STATIC_FILL_PAGES_NUMBER) { hmi_object_dirty_flag = hmi_engine_check_dynamic_object_changed( &hmi_static_fill_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect, depth,&hmi_insect_rect); } } else #endif #if HMI_STATIC_GFILL_NUMBER> 0 if(HMI_IS_SXY_GFILL_PAGES(hmi_object_id)) { hmi_object_index = HMI_GET_SXY_GFILL_PAGES_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_STATIC_GFILL_NUMBER) { HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_gradient_sxy_fill_rect[hmi_object_index]), (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_insect_rect); hmi_object_dirty_flag = hmi_engine_check_dynamic_object_changed( &hmi_static_gfill_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect, depth,&hmi_insect_rect); } } else #endif #if HMI_SXY_BITMAPS_NUMBER> 0 if(HMI_IS_S_XY_BITMAP(hmi_object_id)) { hmi_object_index = HMI_GET_SXY_BITMAPS_ID_INDEX(hmi_object_id); if(hmi_object_index < HMI_SXY_BITMAPS_NUMBER) { HMI_GET_OBJECT_SCREEN_COOR(pfarther_rect, (&hmi_bmp_static_xy_rect[hmi_object_index]), (&hmi_node_screen_rect)); hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_node_screen_rect), (HMI_RECT_STR CONST *)pcliped_farther_rect, &hmi_insect_rect); hmi_object_dirty_flag = hmi_engine_check_dynamic_object_changed( &hmi_sxy_bitmap_container_table[hmi_object_index], (HMI_RECT_STR CONST *)(&hmi_node_screen_rect), pdirty_rect, depth,&hmi_insect_rect); } } else #endif #if HMI_SXY_CONTAINERS_NUMBER > 0 if(HMI_IS_CONTAINERS_SXY(hmi_object_id)) { if(hmi_engine_check_container_changed(hmi_object_id, (HMI_RECT_STR CONST *)pfarther_rect, pdirty_rect,depth,pcliped_farther_rect) != FALSE) { hmi_object_dirty_flag = TRUE; } } else #endif  { } hmi_number_object--;  hmi_check_index++; }  //return hmi_object_dirty_flag; } #endif  #if 0 UINT8 hmi_engine_disp_flag_element_page() {  BOOLEAN is_video_page = FALSE;  BOOLEAN dxy_page = FALSE; HMI_RECT_STR hmi_screen_rect={0,0,HMI_MAX_WIDTH,HMI_MAX_HEIGHT}; HMI_RECT_STR CONST *phmi_page_rect = NULL; #if HMI_LAYER_0_HIGHEST_PRIORITY> 1U UINT8 hmi_priority_cnt = 0U; UINT8 hmi_layer_highest_active_priority = 0U; #endif UINT8 hmi_object_index = 0U; HMI_LAYER_TABLE_STR CONST *phmi_active_layer_info = &hmi_layer_table[0];  HMI_PAGE_TABLE_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_page_info = NULL;  HMI_PAGE_ID_STR hmi_page_id = 0;  #if HMI_LAYER_0_HIGHEST_PRIORITY > 1 { hmi_layer_highest_active_priority = hmi_highest_active_page_priority; } if(hmi_layer_highest_active_priority < HMI_LAYER_0_HIGHEST_PRIORITY) #endif {  {  #if HMI_LAYER_0_HIGHEST_PRIORITY > 1  /*Search all priority page table.*/  hmi_layer_highest_active_priority=HMI_LAYER_0_HIGHEST_PRIORITY-1;  for(hmi_priority_cnt=0U; hmi_priority_cnt <= hmi_layer_highest_active_priority; hmi_priority_cnt++) #endif { #if HMI_LAYER_0_HIGHEST_PRIORITY > 1 hmi_page_id = hmi_layer_0_active_page_id[hmi_priority_cnt].new_page;  #else hmi_page_id = hmi_layer_0_active_page_id[0].new_page;  #endif  #if HMI_DXY_PAGES_NUMBER>0U /*Get current dxy page info*/ if(HMI_IS_DXY_PAGE(hmi_page_id)) { dxy_page=TRUE; if(HMI_IS_VIDEO_DXY_PAGE(hmi_page_id)) { is_video_page=TRUE; phmi_page_info=NULL;  } else { hmi_object_index=HMI_GET_PAGE_DXY_ID_INDEX(hmi_page_id); if(hmi_object_index<HMI_DXY_PAGES_NUMBER) {  phmi_page_rect = &hmi_dxy_page_rect[hmi_object_index];/*&hmi_screen_rect;*//*dxy page need refresh all screen*/ phmi_page_info = &hmi_dxy_page_table[hmi_object_index]; } }  } else #endif #if HMI_SXY_PAGES_NUMBER>0U /*Get current Sxy page info*/ if(HMI_IS_SXY_PAGE(hmi_page_id))  { dxy_page = FALSE; if(HMI_IS_VIDEO_SXY_PAGE(hmi_page_id)) { is_video_page = TRUE; phmi_page_info = NULL;  } else { hmi_object_index=HMI_GET_PAGE_SXY_ID_INDEX(hmi_page_id); if(hmi_object_index<HMI_SXY_PAGES_NUMBER) { phmi_page_rect = &hmi_sxy_page_rect[hmi_object_index]; phmi_page_info = &hmi_sxy_page_table[hmi_object_index]; } }  } else #endif { } if(hmi_page_id!=HMI_PAGES_NUMBER) { if((HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_page_id) != 0))  { HMI_DYNAMIC_OBJECT_CANCEL_CHANGED_FLAG(hmi_page_id);  hmi_engine_draw_container((HMI_CONTAINER_STR CONST *)(&(phmi_page_info->container), (HMI_RECT_STR CONST *)(&hmi_screen_rect), );  } else /*search every element refresh flag */ { if((!is_video_page)&&(phmi_page_rect!=NULL)) {  hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_screen_rect), (HMI_RECT_STR CONST *)phmi_page_rect, &cliped_farther_rect); hmi_engine_check_dynamic_object_changed((HMI_CONTAINER_STR CONST *)(&(phmi_page_info->container)), (HMI_RECT_STR CONST *)phmi_page_rect, pdirty_zone, HMI_PAGE_BEGIN_DEPTH/*page node tree depth*/, &cliped_farther_rect); } } }  if((hmi_old_page!=HMI_PAGES_NUMBER) )/*Get old page info*/ {   { #if HMI_DXY_PAGES_NUMBER>0U  if(HMI_IS_DXY_PAGE(hmi_old_page))  { dxy_page = TRUE; if(HMI_IS_VIDEO_DXY_PAGE(hmi_old_page)) { is_video_page=TRUE; pold_page_rect=NULL;  } else { is_video_page=FALSE;  hmi_object_index=HMI_GET_PAGE_DXY_ID_INDEX(hmi_old_page); if(hmi_object_index<HMI_DXY_PAGES_NUMBER) { if((HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_old_page)!=0U))/*set ,refresh flag not render*/ { HMI_DYNAMIC_OBJECT_CANCEL_CHANGED_FLAG(hmi_old_page); pold_page_rect=&hmi_screen_rect; } else { pold_page_rect=&hmi_dxy_page_rect[hmi_object_index]; } } } } #endif  #if HMI_SXY_PAGES_NUMBER>0U if(HMI_IS_SXY_PAGE(hmi_old_page))  { dxy_page = FALSE; if(HMI_IS_VIDEO_SXY_PAGE(hmi_old_page)) { is_video_page=TRUE; pold_page_rect=NULL; } else { is_video_page=FALSE; hmi_object_index=HMI_GET_PAGE_SXY_ID_INDEX(hmi_old_page); if(hmi_object_index<HMI_SXY_PAGES_NUMBER) { pold_page_rect=&hmi_sxy_page_rect[hmi_object_index]; } } } #endif if(pold_page_rect!=NULL) { #if HMI_LAYER_0_HIGHEST_PRIORITY > 1U if(hmi_priority_cnt!=0)/*only pop up window layer need refresh*/ { #if defined(HMI_GRAPHIC_RGL) pop_up_window_layer = get_popup_window_layer(); #else pop_up_window_layer = 0;/*0 layer of GDI*/ #endif hmi_set_dirty_zone_layer((HMI_RECT_STR *)pold_page_rect,pdirty_zone, pop_up_window_layer); } else {  hmi_set_dirty_zone_layer((HMI_RECT_STR *)pold_page_rect,pdirty_zone, HMI_PAGE_ALL_LAYER);/*all layer is dirty*/ } #else hmi_set_dirty_zone_layer((HMI_RECT_STR *)pold_page_rect,pdirty_zone, HMI_PAGE_ALL_LAYER);/*all layer is dirty*/ #endif } } }  } } } #if defined(HMI_GRAPHIC_RGL) if(exist_video_page==TRUE) { hmi_enable_video_layer(TRUE); } else {  } #endif return(hmi_driver_woking_status_flag); } #endif  #endif    #if 0 UINT8 hmi_engine_get_multi_dirty_zone_page(HMI_RECT_STR *pdirty_zone) {  HMI_RECT_STR CONST *phmi_page_rect = NULL;  #if HMI_LAYER_0_HIGHEST_PRIORITY > 1U  UINT8 hmi_priority_cnt= 0U; UINT8 hmi_layer_highest_active_priority = 0U; #endif UINT8 hmi_object_index = 0U; HMI_LAYER_TABLE_STR CONST *phmi_active_layer_info = &hmi_layer_table[0]; #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513))  HMI_RECT_STR hmi_insec_rect = {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0}; //HMI_RECT_STR CONST *pold_page_rect = NULL; HMI_RECT_STR hmi_screen_rect = {0,0,HMI_MAX_WIDTH,HMI_MAX_HEIGHT};  HMI_RECT_STR cliped_farther_rect = {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0}; #endif HMI_PAGE_TABLE_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_page_info = NULL;  HMI_PAGE_ID_STR hmi_page_id = 0; HMI_PAGE_ID_STR hmi_old_page = 0;   #if HMI_LAYER_0_HIGHEST_PRIORITY > 1 { hmi_layer_highest_active_priority = hmi_highest_active_page_priority; } if(hmi_layer_highest_active_priority < HMI_LAYER_0_HIGHEST_PRIORITY) #endif {  #if HMI_DYN_LANGUAGE_NUMBER > 0 /*language number >1*/ if((HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(HMI_LANGUAGE) != 0U))/*if change language setting,all active page need refresh*/ {  hmi_set_dirty_zone_layer(&hmi_screen_rect, pdirty_zone,HMI_PAGE_ALL_LAYER); HMI_DYNAMIC_OBJECT_CANCEL_CHANGED_FLAG(HMI_LANGUAGE); } else  #endif {  #if HMI_LAYER_0_HIGHEST_PRIORITY > 1  /*Search all priority page table.*/  hmi_layer_highest_active_priority = HMI_LAYER_0_HIGHEST_PRIORITY-1;  for(hmi_priority_cnt=0U; hmi_priority_cnt <= hmi_layer_highest_active_priority; hmi_priority_cnt++) #endif { #if HMI_LAYER_0_HIGHEST_PRIORITY > 1 hmi_page_id = hmi_layer_0_active_page_id[hmi_priority_cnt].new_page; hmi_old_page = hmi_layer_0_active_page_id[hmi_priority_cnt].old_page; hmi_layer_0_active_page_id[hmi_priority_cnt].old_page = HMI_PAGES_NUMBER; #else hmi_page_id = hmi_layer_0_active_page_id[0].new_page; hmi_old_page = hmi_layer_0_active_page_id[0].old_page; hmi_layer_0_active_page_id[0].old_page = HMI_PAGES_NUMBER; #endif   if(hmi_page_id != hmi_old_page)/*switch page*/ { #if HMI_DXY_PAGES_NUMBER > 0U  if(HMI_IS_DXY_PAGE(hmi_old_page)) { hmi_object_index = HMI_GET_PAGE_DXY_ID_INDEX(hmi_old_page); if(hmi_object_index < HMI_DXY_PAGES_NUMBER) { phmi_page_rect = &hmi_dxy_page_rect_bck[hmi_object_index]; hmi_set_dirty_zone_layer(phmi_page_rect, pdirty_zone,HMI_PAGE_ALL_LAYER); } } else #endif #if HMI_SXY_PAGES_NUMBER > 0U /*Get current static xy page info*/ if(HMI_IS_SXY_PAGE(hmi_old_page))  { hmi_object_index = HMI_GET_PAGE_SXY_ID_INDEX(hmi_old_page); if(hmi_object_index < HMI_SXY_PAGES_NUMBER) { phmi_page_rect=&hmi_sxy_page_rect[hmi_object_index]; hmi_set_dirty_zone_layer(phmi_page_rect, pdirty_zone,HMI_PAGE_ALL_LAYER); } }else #endif { }  } #if HMI_DXY_PAGES_NUMBER > 0U if(HMI_IS_DXY_PAGE(hmi_page_id)) { if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_page_id) != 0U) { hmi_object_index = HMI_GET_PAGE_DXY_ID_INDEX(hmi_page_id); if(hmi_object_index < HMI_DXY_PAGES_NUMBER) { phmi_page_rect = &hmi_dxy_page_rect[hmi_object_index]; phmi_page_rect = &hmi_dxy_page_rect_bck[hmi_object_index];  hmi_set_dirty_zone_layer(phmi_page_rect, pdirty_zone,HMI_PAGE_ALL_LAYER);  hmi_set_dirty_zone_layer(phmi_page_rect, pdirty_zone,HMI_PAGE_ALL_LAYER); } } else { hmi_object_index = HMI_GET_PAGE_DXY_ID_INDEX(hmi_page_id); if(hmi_object_index < HMI_DXY_PAGES_NUMBER) { phmi_page_rect = &hmi_sxy_page_rect[hmi_object_index]; phmi_page_info = &hmi_dxy_page_table[hmi_object_index]; hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_screen_rect), (HMI_RECT_STR CONST *)phmi_page_rect, &cliped_farther_rect);  hmi_engine_check_dynamic_object_changed((HMI_CONTAINER_STR CONST *)(&(phmi_page_info->container)), (HMI_RECT_STR CONST *)phmi_page_rect, pdirty_zone, HMI_PAGE_BEGIN_DEPTH/*page node tree depth*/, &cliped_farther_rect); }  }  } else #endif #if HMI_SXY_PAGES_NUMBER > 0U /*Get current static xy page info*/ if(HMI_IS_SXY_PAGE(hmi_page_id))  { hmi_object_index = HMI_GET_PAGE_SXY_ID_INDEX(hmi_page_id); if(hmi_object_index < HMI_SXY_PAGES_NUMBER) { phmi_page_rect=&hmi_sxy_page_rect[hmi_object_index]; hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_screen_rect), (HMI_RECT_STR CONST *)phmi_page_rect, &cliped_farther_rect); phmi_page_info = &hmi_sxy_page_table[hmi_object_index]; hmi_engine_check_dynamic_object_changed((HMI_CONTAINER_STR CONST *)(&(phmi_page_info->container)), (HMI_RECT_STR CONST *)phmi_page_rect, pdirty_zone, HMI_PAGE_BEGIN_DEPTH/*page node tree depth*/, &cliped_farther_rect); }  } else #endif { }  } } }  return(hmi_driver_woking_status_flag); }  #endif  UINT8 hmi_engine_get_multi_dirty_zone_page(HMI_RECT_STR *pdirty_zone) {  HMI_RECT_STR hmi_page_rect = {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0};  #if HMI_LAYER_0_HIGHEST_PRIORITY > 1U  UINT8 hmi_priority_cnt= 0U; UINT8 hmi_layer_highest_active_priority = 0U; #endif UINT8 hmi_object_index = 0U;  #if (defined(HMI_GRAPHIC_AGG)||defined(HMI_GRAPHIC_RGL)||defined(HMI_GRAPHIC_ST)||defined(HMI_GRAPHIC_ST7513))  HMI_RECT_STR hmi_screen_rect = {0,0,HMI_MAX_WIDTH,HMI_MAX_HEIGHT};  HMI_RECT_STR cliped_farther_rect = {HMI_INVALID_COOR,HMI_INVALID_COOR,0,0}; #endif HMI_PAGE_TABLE_STR CONST hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_page_info = NULL;  HMI_PAGE_ID_STR hmi_page_id = 0; HMI_PAGE_ID_STR hmi_old_page = 0;   #if HMI_LAYER_0_HIGHEST_PRIORITY > 1 { hmi_layer_highest_active_priority = hmi_highest_active_page_priority; } if(hmi_layer_highest_active_priority < HMI_LAYER_0_HIGHEST_PRIORITY) #endif {  #if HMI_DYN_LANGUAGE_NUMBER > 0 /*language number >1*/ if((HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(HMI_LANGUAGE) != 0U))/*if change language setting,all active page need refresh*/ {  hmi_set_dirty_zone_layer(&hmi_screen_rect, pdirty_zone,HMI_PAGE_ALL_LAYER); HMI_DYNAMIC_OBJECT_CANCEL_CHANGED_FLAG(HMI_LANGUAGE); } else  #endif {  #if HMI_LAYER_0_HIGHEST_PRIORITY > 1  /*Search all priority page table.*/  hmi_layer_highest_active_priority = HMI_LAYER_0_HIGHEST_PRIORITY-1;  for(hmi_priority_cnt=0U; hmi_priority_cnt <= hmi_layer_highest_active_priority; hmi_priority_cnt++) #endif { #if HMI_LAYER_0_HIGHEST_PRIORITY > 1 hmi_page_id = hmi_layer_0_active_page_id[hmi_priority_cnt].new_page; hmi_old_page = hmi_layer_0_active_page_id[hmi_priority_cnt].old_page; hmi_layer_0_active_page_id[hmi_priority_cnt].old_page = HMI_PAGES_NUMBER; #else hmi_page_id = hmi_layer_0_active_page_id[0].new_page; hmi_old_page = hmi_layer_0_active_page_id[0].old_page; hmi_layer_0_active_page_id[0].old_page = HMI_PAGES_NUMBER; #endif   if((hmi_page_id != hmi_old_page) && (hmi_old_page != HMI_PAGES_NUMBER))/*switch page*/ { #if HMI_DXY_PAGES_NUMBER > 0U  if(HMI_IS_DXY_PAGE(hmi_old_page)) { hmi_object_index = HMI_GET_PAGE_DXY_ID_INDEX(hmi_old_page); if(hmi_object_index < HMI_DXY_PAGES_NUMBER) { hmi_page_rect.x = hmi_dxy_page_rect_bck[hmi_object_index].x; hmi_page_rect.y = hmi_dxy_page_rect_bck[hmi_object_index].y; hmi_page_rect.w = hmi_dxy_page_rect_bck[hmi_object_index].w; hmi_page_rect.h = hmi_dxy_page_rect_bck[hmi_object_index].h; hmi_set_dirty_zone_layer((HMI_RECT_STR *)(&hmi_page_rect), pdirty_zone,HMI_PAGE_ALL_LAYER); } } else #endif #if HMI_SXY_PAGES_NUMBER > 0U /*Get current static xy page info*/ if(HMI_IS_SXY_PAGE(hmi_old_page))  { hmi_object_index = HMI_GET_PAGE_SXY_ID_INDEX(hmi_old_page); if(hmi_object_index < HMI_SXY_PAGES_NUMBER) { hmi_page_rect.x = hmi_sxy_page_rect[hmi_object_index].x; hmi_page_rect.y = hmi_sxy_page_rect[hmi_object_index].y; hmi_page_rect.w = hmi_sxy_page_rect[hmi_object_index].w; hmi_page_rect.h = hmi_sxy_page_rect[hmi_object_index].h; hmi_set_dirty_zone_layer((HMI_RECT_STR *)(&hmi_page_rect), pdirty_zone,HMI_PAGE_ALL_LAYER); } }else #endif { }  } #if HMI_DXY_PAGES_NUMBER > 0U if(HMI_IS_DXY_PAGE(hmi_page_id)) { if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_page_id) != 0U) { hmi_object_index = HMI_GET_PAGE_DXY_ID_INDEX(hmi_page_id); if(hmi_object_index < HMI_DXY_PAGES_NUMBER) { hmi_page_rect.x = hmi_dxy_page_rect[hmi_object_index].x; hmi_page_rect.y = hmi_dxy_page_rect[hmi_object_index].y; hmi_page_rect.w = hmi_dxy_page_rect[hmi_object_index].w; hmi_page_rect.h = hmi_dxy_page_rect[hmi_object_index].h; hmi_set_dirty_zone_layer((HMI_RECT_STR *)(&hmi_page_rect), pdirty_zone,HMI_PAGE_ALL_LAYER); hmi_page_rect.x = hmi_dxy_page_rect_bck[hmi_object_index].x; hmi_page_rect.y = hmi_dxy_page_rect_bck[hmi_object_index].y; hmi_page_rect.w = hmi_dxy_page_rect_bck[hmi_object_index].w; hmi_page_rect.h = hmi_dxy_page_rect_bck[hmi_object_index].h;  hmi_set_dirty_zone_layer((HMI_RECT_STR *)(&hmi_page_rect), pdirty_zone,HMI_PAGE_ALL_LAYER); } } else { hmi_object_index = HMI_GET_PAGE_DXY_ID_INDEX(hmi_page_id); if(hmi_object_index < HMI_DXY_PAGES_NUMBER) { phmi_page_info = &hmi_dxy_page_table[hmi_object_index]; hmi_page_rect.x = hmi_dxy_page_rect[hmi_object_index].x; hmi_page_rect.y = hmi_dxy_page_rect[hmi_object_index].y; hmi_page_rect.w = hmi_dxy_page_rect[hmi_object_index].w; hmi_page_rect.h = hmi_dxy_page_rect[hmi_object_index].h; hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_screen_rect), (HMI_RECT_STR CONST *)(&hmi_page_rect), &cliped_farther_rect);  hmi_engine_check_dynamic_object_changed((HMI_CONTAINER_STR CONST *)(&(phmi_page_info->container)), (HMI_RECT_STR CONST *)(&hmi_page_rect), pdirty_zone, HMI_PAGE_BEGIN_DEPTH/*page node tree depth*/, &cliped_farther_rect); }  }  } else #endif #if HMI_SXY_PAGES_NUMBER > 0U /*Get current static xy page info*/ if(HMI_IS_SXY_PAGE(hmi_page_id))  { if(HMI_DYNAMIC_OBJECT_GET_CHANGED_FLAG(hmi_page_id) != 0U) { hmi_object_index = HMI_GET_PAGE_SXY_ID_INDEX(hmi_page_id); if(hmi_object_index < HMI_SXY_PAGES_NUMBER) { hmi_page_rect.x = hmi_sxy_page_rect[hmi_object_index].x; hmi_page_rect.y = hmi_sxy_page_rect[hmi_object_index].y; hmi_page_rect.w = hmi_sxy_page_rect[hmi_object_index].w; hmi_page_rect.h = hmi_sxy_page_rect[hmi_object_index].h; hmi_set_dirty_zone_layer((HMI_RECT_STR *)(&hmi_page_rect), pdirty_zone,HMI_PAGE_ALL_LAYER);  } } else {  hmi_object_index = HMI_GET_PAGE_SXY_ID_INDEX(hmi_page_id); if(hmi_object_index < HMI_SXY_PAGES_NUMBER) { phmi_page_info= &hmi_sxy_page_table[hmi_object_index]; hmi_page_rect.x = hmi_sxy_page_rect[hmi_object_index].x; hmi_page_rect.y = hmi_sxy_page_rect[hmi_object_index].y; hmi_page_rect.w = hmi_sxy_page_rect[hmi_object_index].w; hmi_page_rect.h = hmi_sxy_page_rect[hmi_object_index].h; hmi_get_intersec_rect((HMI_RECT_STR CONST *)(&hmi_screen_rect), (HMI_RECT_STR CONST *)(&hmi_page_rect), &cliped_farther_rect); phmi_page_info = &hmi_sxy_page_table[hmi_object_index]; hmi_engine_check_dynamic_object_changed((HMI_CONTAINER_STR CONST *)(&(phmi_page_info->container)), (HMI_RECT_STR CONST *)(&hmi_page_rect), pdirty_zone, HMI_PAGE_BEGIN_DEPTH/*page node tree depth*/, &cliped_farther_rect); }  } } else #endif { }  } } }  return(hmi_driver_woking_status_flag); }   void hmi_union_rect(HMI_RECT_STR *prect1,HMI_RECT_STR *prect2,HMI_RECT_STR *prect_union) { HMI_WIDTH_STR min_x = 0; HMI_WIDTH_STR max_x = 0; HMI_HEIGHT_STR min_y = 0; HMI_HEIGHT_STR max_y = 0;  if((prect1 != NULL) && (prect2 != NULL) && (prect_union != NULL)) { if((prect1->w != 0)&&(prect1->h != 0)) { if((prect2->w != 0)&&((prect2->h != 0))) { if(prect1->x < prect2->x) { min_x = prect1->x; } else { min_x = prect2->x; }  if((prect1->x + prect1->w) < (prect2->x + prect2->w)) { max_x = prect2->x + prect2->w; } else { max_x = prect1->x + prect1->w; }  if(prect1->y < prect2->y) { min_y = prect1->y; } else { min_y = prect2->y; }  if((prect1->y + prect1->h) < (prect2->y + prect2->h)) { max_y = prect2->y + prect2->h; } else { max_y = prect1->y + prect1->h; }  prect_union->x = min_x; prect_union->y = min_y; prect_union->w = max_x - min_x; prect_union->h = max_y - min_y; } else { prect_union->x = prect1->x; prect_union->y = prect1->y; prect_union->w = prect1->w; prect_union->h = prect1->h; } } else { if((prect2->w != 0)&&((prect2->h != 0))) { prect_union->x = prect2->x; prect_union->y = prect2->y; prect_union->w = prect2->w; prect_union->h = prect2->h; } } } }  BOOLEAN hmi_intersection_rect(HMI_RECT_STR *prect1,HMI_RECT_STR *prect2) { BOOLEAN intersection=TRUE;  if((prect1 != NULL) && (prect2 != NULL)) { if((prect1->x + prect1->w) < prect2->x) { intersection = FALSE; } else { if(prect1->x > (prect2->x + prect2->w)) { intersection = FALSE; } else { if((prect1->y + prect1->h) < prect2->y) { intersection = FALSE; } else { if(prect1->y > (prect2->y + prect2->h)) { intersection = FALSE; } else { intersection=TRUE; } } } } } return intersection; }  UINT32 hmi_get_area_rect(HMI_RECT_STR *prect1,HMI_RECT_STR *prect2) { UINT32 area = 0;  if((prect1 != NULL) && (prect2 != NULL)) { area = (prect1->w hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml prect1->h) + (prect2->w hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml prect2->h); } return area; }  void hmi_add_dirty(HMI_RECT_STR *pnew,HMI_RECT_STR *pdirty_list,U08 depth) { UINT16 index = 0; UINT16 start = 0; BOOLEAN end = FALSE; BOOLEAN intersec= FALSE; BOOLEAN unionsec= FALSE; BOOLEAN insert = FALSE; UINT32 union_area = 0; UINT8 union_index = 0; UINT32 two_area = 0; UINT32 min_area = 0xffffffff; UINT32 min_area_index = 0; HMI_RECT_STR union_rect = {0,0,0,0};   if((pnew != NULL)&&(pdirty_list != NULL)) { if((pnew->w != 0) && (pnew->h != 0)) { /*union */ if(depth < HMI_LAYER_MAX_CNT) { hmi_union_rect(pnew,&pdirty_list[depth],&pdirty_list[depth]); start = HMI_LAYER_MAX_CNT + depth hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml HMI_DIRTY_FIFO_LEN; }  /*add multi dirty zone list*/  while((start + index < start + HMI_DIRTY_FIFO_LEN) && (!end)) { if((pdirty_list[start + index].w != 0) && (pdirty_list[start + index].h != 0)) { intersec = hmi_intersection_rect(&pdirty_list[start + index], pnew); if(intersec == TRUE) { two_area = hmi_get_area_rect(&pdirty_list[start + index], pnew); hmi_union_rect(&pdirty_list[start + index], pnew, &union_rect);  union_area = (union_rect.w) hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml (union_rect.h); if(union_area < two_area) { pdirty_list[start + index].x = union_rect.x; pdirty_list[start + index].y = union_rect.y; pdirty_list[start + index].w = union_rect.w; pdirty_list[start + index].h = union_rect.h; union_index = start + index; unionsec= TRUE; end = TRUE; }  } } else { pdirty_list[start + index].x = pnew->x; pdirty_list[start + index].y = pnew->y; pdirty_list[start + index].w = pnew->w; pdirty_list[start + index].h = pnew->h; end = TRUE; insert = TRUE; } index++; } if(insert == TRUE) { if(index < start + HMI_DIRTY_FIFO_LEN) { pdirty_list[start + index].x = 0;/*set end flag*/ pdirty_list[start + index].y = 0; pdirty_list[start + index].w = 0; pdirty_list[start + index].h = 0; } }  else if(unionsec == TRUE) { do { pdirty_list[union_index].x = pdirty_list[union_index+1].x; pdirty_list[union_index].y = pdirty_list[union_index+1].y; pdirty_list[union_index].w = pdirty_list[union_index+1].w; pdirty_list[union_index].h = pdirty_list[union_index+1].h; union_index++; }while((pdirty_list[union_index].w != 0)&& (union_index < (start + HMI_DIRTY_FIFO_LEN)));/**/ if(union_index >= (start + HMI_DIRTY_FIFO_LEN)) { pdirty_list[union_index-1].x = 0; pdirty_list[union_index-1].y = 0; pdirty_list[union_index-1].w = 0; pdirty_list[union_index-1].h = 0; } hmi_add_dirty(&union_rect,pdirty_list,depth); } else /*fifo full,not add success*/ { index = 0;  while((start + index < start + HMI_DIRTY_FIFO_LEN) && (!end)) { if((pdirty_list[start + index].w != 0) && (pdirty_list[start + index].h != 0)) {  hmi_union_rect(&pdirty_list[start + index], pnew, &union_rect); union_area = (union_rect.w) hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml (union_rect.h); if(union_area < min_area) { min_area_index = start + index; min_area = union_area; }  } else {  end = TRUE;  } index++; } if(min_area_index < start + HMI_DIRTY_FIFO_LEN) { hmi_union_rect(&pdirty_list[min_area_index], pnew, &union_rect);  do { pdirty_list[min_area_index].x = pdirty_list[min_area_index+1].x; pdirty_list[min_area_index].y = pdirty_list[min_area_index+1].y; pdirty_list[min_area_index].w = pdirty_list[min_area_index+1].w; pdirty_list[min_area_index].h = pdirty_list[min_area_index+1].h; min_area_index++; }while((pdirty_list[min_area_index].w != 0)&& (min_area_index < (start + HMI_DIRTY_FIFO_LEN)));/**/ if(min_area_index >= (start + HMI_DIRTY_FIFO_LEN)) { pdirty_list[min_area_index-1].x = 0; pdirty_list[min_area_index-1].y = 0; pdirty_list[min_area_index-1].w = 0; pdirty_list[min_area_index-1].h = 0; } hmi_add_dirty(&union_rect,pdirty_list,depth);  } } } } }  #if (HMI_DYN_CONTAINERS_NUMBER > 0) && (HMI_ALL_STATIC_CONTAINERS_NUMBER > 0) static BOOLEAN hmi_engine_get_bck_static_container_id(HMI_OBJECT_ID_STR hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml phmi_dyn_contain_id) { BOOLEAN hmi_changed_flag = FALSE; UINT8 loop=0;  if((*phmi_dyn_contain_id) < HMI_DYN_CONTAINERS_NUMBER) { *phmi_dyn_contain_id = hmi_dyn_container_table_bck[*phmi_dyn_contain_id]; } else { *phmi_dyn_contain_id = HMI_NB_ELEMENTS; } while((HMI_IS_DYN_CONTAINER(*phmi_dyn_contain_id))&&(loop<HMI_DYN_CONTAINER_NESTED_DEPTH)) { *phmi_dyn_contain_id = HMI_GET_DYN_CONTAINERS_ID_INDEX(*phmi_dyn_contain_id); loop++; } if(loop<HMI_DYN_CONTAINER_NESTED_DEPTH) { hmi_changed_flag=TRUE; } else { HMI_GFX_SET_STATUS(HMI_DYN_CONTAINER_NESTED); } return(hmi_changed_flag); } #endif   BOOLEAN hmi_get_rotation_rect(HMI_RECT_STR *p_rect,HMI_ROTATION_STR *p_axis, float_32 angel,HMI_RECT_STR *p_rect_rotation) { BOOLEAN success = FALSE; //HMI_RECT_STR rect_axis = {0,0,0,0}; HMI_ROTATION_STR center = {0,0}; HMI_ROTATION_STR rotation= {0,0}; float_32 cosA = 0; float_32 sinA = 0; HMI_WIDTH_STR width_height = 0;  if((p_rect != NULL)&&(p_axis != NULL)&& (p_rect_rotation != NULL)) { center.x = p_rect->x + ((p_rect->w)>>1)/*/2*/; center.y = p_rect->y + ((p_rect->h)>>1)/*/2*/; /*convert coordinate p_axis as origin*/ center.x = center.x - p_axis->x; center.y = center.y - p_axis->y; /bin /cmd /dev /etc /git-bash.exe /git-cmd.exe /LICENSE.txt /mingw64 /proc /ReleaseNotes.html /tmp /unins000.dat /unins000.exe /unins000.msg /usr rotation  x0=xcosA-ysinA y0=xsinA+ycosA */ angel = HMI_ANGEL_TO_RADIAN(angel); if(fabs(angel) < HMI_FLOAT_TOLERANCE) { cosA = 1.0f; sinA = 0; } else { cosA = cos(angel); sinA = sin(angel); } rotation.x = center.x hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml cosA - center.y hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml sinA; rotation.y = center.x hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml sinA + center.y hmi_action_engine.c hmi_action_engine.h hmi_all_struct_include.h HMI_Data hmi_driver_cfg.h hmi_engine.c hmi_engine.h hmi_engine_cfg.h hmi_loop.c hmi_loop.h hmi_loop_driver.c hmi_loop_driver.h hmi_reset.c hmi_reset.h hmi_rgl_driver.c hmi_rgl_driver.h HMI_Source hmi_status.c hmi_status.h hmi_system.h hmi_task_touchpanel.c hmi_task_touchpanel.h hmi_task_touchpanel_driver.c hmi_task_touchpanel_driver.h HMI_Tool hmi_user_interface.c hmi_user_interface.h QD_HMI.gpj zs12_main_project.xml zs12_project_page_0816_bginternal.xml zs12_project_page_0820_hmi.xml zs12_project_page_0823_release.xml zs12_project_page_0828.xml zs12_project_page_0830.xml zs12_project_page_0831_release.xml zs12_project_page_0904_release.xml zs12_project_page_0922_RELEASE.xml zs12_project_page_1016_RELEASE_v2.0.xml zs12_project_page_lyy 0808-FUNCBACK-INTERNAL.xml zs12_project_page_lyy 0808-test-rle-internal.xml zs12_project_page_XIAOSA_0808.xml cosA; /*convert coordinate */ rotation.x = rotation.x + p_axis->x; rotation.y = rotation.y + p_axis->y; /*get rotation rection*/ width_height = p_rect->w + p_rect->h + HMI_DEL_ANGLE_OFFSET_W; p_rect_rotation->x = rotation.x - (width_height>>1)/*/2*/; p_rect_rotation->y = rotation.y - (width_height>>1)/*/2*/; p_rect_rotation->w = width_height; p_rect_rotation->h = width_height;  success = TRUE; } return success; }    BOOLEAN hmi_get_rotation_pointer_dirty(HMI_RECT_STR *p_pointer_rect, HMI_RECT_STR *p_pointer_rect_old, HMI_ROTATION_STR *p_axis,HMI_ROTATION_STR *p_axis_old, float_32 new_angel, float_32 old_angel,HMI_RECT_STR *p_dirty, BOOLEAN trail, HMI_RECT_STR *p_father_rect) { BOOLEAN success = FALSE; HMI_RECT_STR old_dirty = {0,0,0,0}; HMI_RECT_STR new_dirty = {0,0,0,0}; HMI_RECT_STR final_dirty = {0,0,0,0}; float_32 dt = 0;  if((p_pointer_rect != NULL)&&(p_axis != NULL)&& (p_dirty != NULL) && (p_pointer_rect_old != NULL)&& (p_dirty != p_father_rect)&&(p_axis_old != NULL)) { dt=fabs(old_angel - new_angel); if(dt < HMI_DEL_ANGLE) { success = hmi_get_rotation_rect(p_pointer_rect_old, p_axis_old, old_angel, &old_dirty);  if(success) { success = hmi_get_rotation_rect(p_pointer_rect, p_axis, new_angel, &new_dirty); if(success) { if(trail) { hmi_union_rect(&old_dirty,&new_dirty,&final_dirty); /*set min rect which contain p_axis pointer*/ old_dirty.x = p_axis->x - HMI_MIN_RECT_HALF_W; /*only rotation at userdefine point can trail enable,*/ old_dirty.y = p_axis->y - HMI_MIN_RECT_HALF_H; old_dirty.w = HMI_MIN_RECT_W; old_dirty.h = HMI_MIN_RECT_H; /*union */ hmi_union_rect(&old_dirty,&final_dirty,p_dirty); } else { hmi_union_rect(&old_dirty,&new_dirty,p_dirty); } } } } else /*del angel > HMI_DEL_ANGLE ,dirty zone is father*/ { p_dirty->x = p_father_rect->x; p_dirty->y = p_father_rect->y; p_dirty->w = p_father_rect->w; p_dirty->h = p_father_rect->h; } }  return success;  }   void hmi_add_2buffer_dirty_zone(HMI_RECT_STR pdirty_free[], HMI_RECT_STR *pdirty_bck, HMI_RECT_STR *pdirty_2buffer, UINT8 layer) { UINT8 loop = 0;  //copy union dirty hmi_union_rect(&pdirty_free[layer], &pdirty_bck[layer], &pdirty_2buffer[layer]);  //copy the layer dirty for(loop =(HMI_LAYER_MAX_CNT+layer*HMI_DIRTY_FIFO_LEN); loop < (HMI_LAYER_MAX_CNT+layer*HMI_DIRTY_FIFO_LEN+HMI_DIRTY_FIFO_LEN); loop++) { pdirty_2buffer[loop].x = pdirty_free[loop].x; pdirty_2buffer[loop].y = pdirty_free[loop].y; pdirty_2buffer[loop].w = pdirty_free[loop].w; pdirty_2buffer[loop].h = pdirty_free[loop].h; }  loop = (HMI_LAYER_MAX_CNT+layer*HMI_DIRTY_FIFO_LEN); while((loop < (HMI_LAYER_MAX_CNT+layer*HMI_DIRTY_FIFO_LEN+HMI_DIRTY_FIFO_LEN))&& (pdirty_bck[loop].w > 0)&& (pdirty_bck[loop].h > 0)) { hmi_add_dirty((&pdirty_bck[loop]),pdirty_2buffer,layer); loop++; } }   /*copy back dirty to free dirty*/ void hmi_copy_last_dirty_zone(HMI_RECT_STR dirty_bck[], HMI_RECT_STR dirty_free[], UINT8 layer) { UINT8 loop = 0;  if((dirty_bck[layer].w > 0)&&(dirty_bck[layer].h > 0)) { dirty_free[layer].x = dirty_bck[layer].x; dirty_free[layer].y = dirty_bck[layer].y; dirty_free[layer].w = dirty_bck[layer].w; dirty_free[layer].h = dirty_bck[layer].h;  for(loop =(HMI_LAYER_MAX_CNT+layer*HMI_DIRTY_FIFO_LEN); loop < (HMI_LAYER_MAX_CNT+layer*HMI_DIRTY_FIFO_LEN+HMI_DIRTY_FIFO_LEN); loop++) { dirty_free[loop].x = dirty_bck[loop].x; dirty_free[loop].y = dirty_bck[loop].y; dirty_free[loop].w = dirty_bck[loop].w; dirty_free[loop].h = dirty_bck[loop].h; } } }
