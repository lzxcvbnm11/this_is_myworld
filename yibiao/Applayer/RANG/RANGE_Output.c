 /************************************************************************** | Copyright |------------------------------------------------------------------------ |Copyright(c) by YEEDON MultiMedia Co.LTD. All rights reserved. | | this software if furnished under a license and may be used and copied | only in accordance with the terms of such license and with the inclusion | of he above copyright notic.This software or any other copies thereof | may not be provided of otherwise made available to any other persion. | No title to and ownership of the software is hereby transferred. | | the information in this software is subject to change without notice | and should not be construed as a commitment by | YEEDON MultiMedia Co.LTD. | | YEEDON MultiMedia Co.LTD. assumes no responsibility for the use or reliability | of its Software on equipment which is not supported by YEEDON MultiMedia Co.LTD. |-------------------------------------------------------------- **************************************************************************/  /*--------------------------------------------------------------------------*/ /***************************************************************************** RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Copyright (C) 2016 ShenZhen Yeedon Media co.,LTD. All rights reserved. * RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h File Name : Rang_output.c RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Description : Rang_output signal process RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Author: liuyingying RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Date: 2016-12-21 ******************************************************************************/ /*---------------------------------------------------------------------------*/    /*------------------------------------------------------------------------*/ /*-----Head of file----------------------------------------------------------*/ /*------------------------------------------------------------------------*/ #include "yd_typedefs.h" #include "public.h" #include "RangeToEmptyAlgorithm_V2.h" #include "nvm_public.h" #include "pwr_public.h" #include "com_public.h"   /*************************************************** RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Function: RANG_GetDisplayRangeToEmpty RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Description: get the Range Value RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Parameters: none RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Returns:prmDisplayRangeToEmpty the detail rang value RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h $Create & Verlog:$ RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Author:liuyingying Date:2016-12-21 Version:V1.0 ****************************************************/ U16 RANG_GetDisplayRangeToEmpty(void) { return prmDisplayRangeToEmpty; }  /*************************************************** RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Function: RANG_GetOdoSum RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Description: RANG OUTPUT Interface which Rang module used RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Parameters: none RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Returns:prmRangeToEmptyWarning TRUE: hmi will not display prmDisplayRangeToEmpty FALSE:hmi will display prmDisplayRangeToEmpty RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h $Create & Verlog:$ RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Author:liuyingying Date:2016-12-21 Version:V1.0 ****************************************************/  U8 RANG_GetOdoSum(void) { return prmOdometerSum; }  /*************************************************** RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Function: RANG_GetFuelSum RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Description: RANG OUTPUT Interface which Rang module used RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Parameters: none RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Returns:prmRangeToEmptyWarning TRUE: hmi will not display prmDisplayRangeToEmpty FALSE:hmi will display prmDisplayRangeToEmpty RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h $Create & Verlog:$ RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Author:liuyingying Date:2016-12-21 Version:V1.0 ****************************************************/ U16 RANG_GetFuelSum(void) { return prmFuelSum; }  /*************************************************** RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Function: RANG_GetFullFuelConsumption RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Description: RANG OUTPUT Interface which Rang module used RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Parameters: none RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Returns:prmRangeToEmptyWarning TRUE: hmi will not display prmDisplayRangeToEmpty FALSE:hmi will display prmDisplayRangeToEmpty RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h $Create & Verlog:$ RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Author:liuyingying Date:2016-12-21 Version:V1.0 ****************************************************/ U8 RANG_GetFullFuelConsumption(void) { return prmFullFuelConsumption; }  /*************************************************** RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Function: RANG_GetRecentFuelConsumption RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Description: RANG OUTPUT Interface which Rang module used RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Parameters: none RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Returns:prmRangeToEmptyWarning TRUE: hmi will not display prmDisplayRangeToEmpty FALSE:hmi will display prmDisplayRangeToEmpty RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h $Create & Verlog:$ RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Author:liuyingying Date:2016-12-21 Version:V1.0 ****************************************************/  U8 RANG_GetRecentFuelConsumption(void) { return prmRecentFuelConsumption; }   /*************************************************** RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Function: RANG_GetDisplayRangeToEmptyWarn RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Description: RANG OUTPUT Interface which Rang module used RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Parameters: none RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Returns:prmRangeToEmptyWarning TRUE: hmi will not display prmDisplayRangeToEmpty FALSE:hmi will display prmDisplayRangeToEmpty RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h $Create & Verlog:$ RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Author:liuyingying Date:2016-12-21 Version:V1.0 ****************************************************/ BOOL RANG_GetDisplayRangeToEmptyWarn(void) { return prmRangeToEmptyWarning; }   void RANG_NetSignal_OutPut(void) { U16 RangeToEmpty_Send ;  #if DEBUG_FL_ALGORITHM v_wr_8(prmOdometerSum_handle,prmOdometerSum); v_wr_8(prmRecentFuelConsumption_handle,prmRecentFuelConsumption); v_wr_16(prmFuelSum_handle,prmFuelSum);  RangeToEmpty_Send = prmDisplayRangeToEmpty%1000; v_wr_16(RmnDrvngDist_handle,RangeToEmpty_Send);   /* RangeToEmpty_Send = (((prmRangeToEmpty & 0x0000ff) << 16) | (prmRangeToEmpty & 0x00ff00) | ((prmRangeToEmpty & 0xff0000) >> 16)); */  //v_wr_bytes(prmRangeToEmpty_handle,&RangeToEmpty_Send,3,0);  #endif } /*************************************************** RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Function: RANG_Output RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Description: rang output RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Parameters: none RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Returns:none RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h $Create & Verlog:$ RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Author:liuyingying Date:2017-11-27 Version:V1.0 ****************************************************/  void RANG_Output(void) { static U8 pwrMode; U8 curMode;  PWR_GetPwrMode(&curMode); if(((PWR_OFF == curMode) || (PWR_ACC == curMode)) && ((PWR_RUN == pwrMode) ||  (PWR_CRANK == pwrMode))) { NVM_SetParas(INDEX_NVM_K_ODOMETERSUM,&prmOdometerSum,1); NVM_SetParas(INDEX_NVM_K_FUELSUM,&prmFuelSum,2); NVM_SetParas(INDEX_NVM_K_FULLFUELCOMSUMPTION,&prmFullFuelConsumption,1); NVM_SetParas(INDEX_NVM_K_RECENTFUELCONSUMPTION,&prmRecentFuelConsumption,1); NVM_SetParas(INDEX_NVM_K_RANGETOEMPTY,&prmRangeToEmpty,4); }  pwrMode = curMode;    }  /*************************************************** RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Function: RANG_Output RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Description: rang output RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Parameters: none RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Returns:none RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h $Create & Verlog:$ RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Author:liuyingying Date:2017-11-27 Version:V1.0 ****************************************************/  void RANG_OutputBeforeSleep(void) { #if 1 static U8 pwrMode; U8 curMode;   NVM_SetParas(INDEX_NVM_K_ODOMETERSUM,&prmOdometerSum,1); NVM_SetParas(INDEX_NVM_K_FUELSUM,&prmFuelSum,2); NVM_SetParas(INDEX_NVM_K_FULLFUELCOMSUMPTION,&prmFullFuelConsumption,1); NVM_SetParas(INDEX_NVM_K_RECENTFUELCONSUMPTION,&prmRecentFuelConsumption,1); NVM_SetParas(INDEX_NVM_K_RANGETOEMPTY,&prmRangeToEmpty,4);    #endif }   /*************************************************** RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Function: RANG_Printf RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Description: rang output RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Parameters: none RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Returns:none RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h $Create & Verlog:$ RANGE_Input.c RANGE_Output.c RangeToEmptyAlgorithm_V2.c RangeToEmptyAlgorithm_V2.h RangeToEmptyAlgorithm_V2_data.c RangeToEmptyAlgorithm_V2_private.h RangeToEmptyAlgorithm_V2_types.h Author:liuyingying Date:2017-11-27 Version:V1.0 ****************************************************/ void RANG_Printf(void) { printf("rang:%d\n%d\n%d\n%d\n%d\n%d\n%d\n%d\n%d\n%d\n%d\n%d\n%d\n ",  gASI_VehicleOdometer, gASI_K_FullFuelConsumption, gASI_K_RecentFuelConsumption, gASI_K_OdometerSum, gASI_K_FuelSum, gASI_K_RangeToEmpty, gASI_VehicleOdometerV, prmFuelSum, prmDisplayRangeToEmpty,  prmFullFuelConsumption, prmRecentFuelConsumption, prmOdometerSum, prmRangeToEmptyWarning); }
