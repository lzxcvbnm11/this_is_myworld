/***************************************************************************** scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h Copyright (C) 2016 ShenZhen Yeedon Media co.,LTD. All rights reserved. * scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h File Name : scs.c scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h Description : SCS API application scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h Author: Hejianjun scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h Date: 2016-11-30 ******************************************************************************/    /bin /cmd /dev /etc /git-bash.exe /git-cmd.exe /LICENSE.txt /mingw64 /proc /ReleaseNotes.html /tmp /unins000.dat /unins000.exe /unins000.msg /usr Files for including */ #include "scs_info.inc"  static BOOL scs_OnoffCmd = FALSE; /*控制软开关的命令*/ static BOOL scs_NetStabCtrlDsblSwAReq = FALSE; /bin /cmd /dev /etc /git-bash.exe /git-cmd.exe /LICENSE.txt /mingw64 /proc /ReleaseNotes.html /tmp /unins000.dat /unins000.exe /unins000.msg /usr 存储发送的网络信号*/ static BOOL scs_InitSts = FALSE; /bin /cmd /dev /etc /git-bash.exe /git-cmd.exe /LICENSE.txt /mingw64 /proc /ReleaseNotes.html /tmp /unins000.dat /unins000.exe /unins000.msg /usr SCS 模块的初始化状态*/ static BOOL insSCSOffSwitchEnPrm; /*配置字是否具有动态稳定控制系统*/ static U8 insSCSOffRemPrm; /*配置字scsoff switch */ static U8 scs_GCounter = 0; /bin /cmd /dev /etc /git-bash.exe /git-cmd.exe /LICENSE.txt /mingw64 /proc /ReleaseNotes.html /tmp /unins000.dat /unins000.exe /unins000.msg /usr 用于内部函数的周期计数*/ static U8 scs_Max_Cnt = 0; static U8 scs_Time1SArrive = 0; /bin /cmd /dev /etc /git-bash.exe /git-cmd.exe /LICENSE.txt /mingw64 /proc /ReleaseNotes.html /tmp /unins000.dat /unins000.exe /unins000.msg /usr 到达1S 需要的次数*/   /*************************************************** scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h Function: SCS_Init scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h Description: SCS module initialized scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h Parameters: none scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h Returns: none scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h $Create & Verlog:$ scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h Author:Hejianjun Date:2016-11-30 Version:V1.0 ****************************************************/ void SCS_Init(void) { scs_OnoffCmd = FALSE; scs_NetStabCtrlDsblSwAReq = FALSE; scs_InitSts = TRUE; scs_GCounter = 0u;  insSCSOffSwitchEnPrm = DIAG_GetSCSOffSwitchEn(); insSCSOffRemPrm = DIAG_GetSCSOffRem();  scs_Max_Cnt = S_TO_MS(insSCSOffRemPrm)/SCS_PROCESS_PERIOD; scs_Time1SArrive = (U8)(S_TO_MS(insSCSOffRemPrm) /SCS_PROCESS_PERIOD);   }  /*************************************************** scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h Function: SCS_Process_50ms scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h Description: the process of the SCS module scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h Parameters: none scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h Returns: none scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h $Create & Verlog:$ scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h Author:Hejianjun Date:2016-11-30 Version:V1.0 scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h Author:huangyifan Date:2017-06-23 Version:V2.0 scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h log: ADD scs_SCSOutPutProcess function ****************************************************/ void SCS_Process_50ms(void) {  if (TRUE == scs_InitSts) { if(TRUE == insSCSOffSwitchEnPrm) { scs_SCSOutPutProcess(); } else { /*do nothing*/ } } else { /*do nothing*/ } }   /*************************************************** scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h Function: scs_SCSOutPutProcess scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h Description: SCS OUTPUT SIGNAL PROCESS scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h Parameters: input: none scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h Returns: none scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h $Create & Verlog:$ scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h Author:huangyifan Date:2017-06-23 version:V2.0 ****************************************************/ static void scs_SCSOutPutProcess(void ) { U8 scsSts = FALSE;  if (TRUE == scs_OnoffCmd) { scs_GCounter++;  if (scs_Max_Cnt <= scs_GCounter) { scs_GCounter = 0; scs_NetStabCtrlDsblSwAReq = FALSE; scs_OnoffCmd = FALSE;  DM_SetScsSwEn(FALSE); } else { scs_NetStabCtrlDsblSwAReq = TRUE; }  } else { /*do nothing*/ DM_GetScsSwEn(&scsSts);  if(TRUE == scsSts) {  scs_OnoffCmd = TRUE; } else { /*do nothing*/ } } }  BOOL SCS_Get_StabCtrlDsblSwAReq(void) { return scs_NetStabCtrlDsblSwAReq; }  /*************************************************** scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h Function: SCS_SendNetSignal_100ms scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h Description: update the signal to indicate whether the SCS/TC form OFF to ON scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h Parameters: input: none scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h Returns: none scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h $Create & Verlog:$ scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h Author:Hejianjun Date:2016-11-29 Version:V1.0 ****************************************************/ void SCS_SendNetSignal_100ms(void) { v_wr_bool(StabCtrlDsblSwA_handle, scs_NetStabCtrlDsblSwAReq); /*need update signal handle*/ }  /*=========================================================================== scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h File Revision History(bottom to top:first revision to last revision) *============================================================================ scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h $Log:$ * scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h Rev: Userid: Date: Description *-------- ---------- --------- ------------------------------ * scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h V1.0 Hejianjun 2016-11-30 Initial scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h V1.1 liuyingying 2017-03-16 modify scs.c scs_cfg.h scs_info.inc scs_private.h scs_public.h V2.0 huangyinfan 2017-06-23 modify *===========================================================================*/
