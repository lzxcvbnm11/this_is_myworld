 /************************************************************************** | Copyright |------------------------------------------------------------------------ |Copyright(c) by YEEDON MultiMedia Co.LTD. All rights reserved. | | this software if furnished under a license and may be used and copied | only in accordance with the terms of such license and with the inclusion | of he above copyright notic.This software or any other copies thereof | may not be provided of otherwise made available to any other persion. | No title to and ownership of the software is hereby transferred. | | the information in this software is subject to change without notice | and should not be construed as a commitment by | YEEDON MultiMedia Co.LTD. | | YEEDON MultiMedia Co.LTD. assumes no responsibility for the use or reliability | of its Software on equipment which is not supported by YEEDON MultiMedia Co.LTD. |-------------------------------------------------------------- **************************************************************************/  /*--------------------------------------------------------------------------*/ /***************************************************************************** fl.c fl_cfg.h fl_info.inc FL_Input.c FL_Output.c fl_private.h fl_public.h FuelLevelAlgorithm_V2.c FuelLevelAlgorithm_V2.h FuelLevelAlgorithm_V2_data.c FuelLevelAlgorithm_V2_private.h FuelLevelAlgorithm_V2_types.h Copyright (C) 2016 ShenZhen Yeedon Media co.,LTD. All rights reserved. * fl.c fl_cfg.h fl_info.inc FL_Input.c FL_Output.c fl_private.h fl_public.h FuelLevelAlgorithm_V2.c FuelLevelAlgorithm_V2.h FuelLevelAlgorithm_V2_data.c FuelLevelAlgorithm_V2_private.h FuelLevelAlgorithm_V2_types.h File Name : FL_Output.c fl.c fl_cfg.h fl_info.inc FL_Input.c FL_Output.c fl_private.h fl_public.h FuelLevelAlgorithm_V2.c FuelLevelAlgorithm_V2.h FuelLevelAlgorithm_V2_data.c FuelLevelAlgorithm_V2_private.h FuelLevelAlgorithm_V2_types.h Description : FL_Output  fl.c fl_cfg.h fl_info.inc FL_Input.c FL_Output.c fl_private.h fl_public.h FuelLevelAlgorithm_V2.c FuelLevelAlgorithm_V2.h FuelLevelAlgorithm_V2_data.c FuelLevelAlgorithm_V2_private.h FuelLevelAlgorithm_V2_types.h Author: liuyingying fl.c fl_cfg.h fl_info.inc FL_Input.c FL_Output.c fl_private.h fl_public.h FuelLevelAlgorithm_V2.c FuelLevelAlgorithm_V2.h FuelLevelAlgorithm_V2_data.c FuelLevelAlgorithm_V2_private.h FuelLevelAlgorithm_V2_types.h Date: 2016-12-21 ******************************************************************************/ /*------------------------------------------------------------------------*/ /*-----Head of file----------------------------------------------------------*/ /*------------------------------------------------------------------------*/ #include "yd_typedefs.h" #include "public.h" #include "nvm_public.h" #include "FuelLevelAlgorithm_V2.h" #include "com_public.h" #include "pwr_public.h" /*************************************************** fl.c fl_cfg.h fl_info.inc FL_Input.c FL_Output.c fl_private.h fl_public.h FuelLevelAlgorithm_V2.c FuelLevelAlgorithm_V2.h FuelLevelAlgorithm_V2_data.c FuelLevelAlgorithm_V2_private.h FuelLevelAlgorithm_V2_types.h Function: FL_Output fl.c fl_cfg.h fl_info.inc FL_Input.c FL_Output.c fl_private.h fl_public.h FuelLevelAlgorithm_V2.c FuelLevelAlgorithm_V2.h FuelLevelAlgorithm_V2_data.c FuelLevelAlgorithm_V2_private.h FuelLevelAlgorithm_V2_types.h Description: Fuel Level output signal process fl.c fl_cfg.h fl_info.inc FL_Input.c FL_Output.c fl_private.h fl_public.h FuelLevelAlgorithm_V2.c FuelLevelAlgorithm_V2.h FuelLevelAlgorithm_V2_data.c FuelLevelAlgorithm_V2_private.h FuelLevelAlgorithm_V2_types.h Parameters: none fl.c fl_cfg.h fl_info.inc FL_Input.c FL_Output.c fl_private.h fl_public.h FuelLevelAlgorithm_V2.c FuelLevelAlgorithm_V2.h FuelLevelAlgorithm_V2_data.c FuelLevelAlgorithm_V2_private.h FuelLevelAlgorithm_V2_types.h Returns:none fl.c fl_cfg.h fl_info.inc FL_Input.c FL_Output.c fl_private.h fl_public.h FuelLevelAlgorithm_V2.c FuelLevelAlgorithm_V2.h FuelLevelAlgorithm_V2_data.c FuelLevelAlgorithm_V2_private.h FuelLevelAlgorithm_V2_types.h $Create & Verlog:$ fl.c fl_cfg.h fl_info.inc FL_Input.c FL_Output.c fl_private.h fl_public.h FuelLevelAlgorithm_V2.c FuelLevelAlgorithm_V2.h FuelLevelAlgorithm_V2_data.c FuelLevelAlgorithm_V2_private.h FuelLevelAlgorithm_V2_types.h Author:liuyingying Date:2016-12-21 Version:V1.0 ****************************************************/ void FL_Output(void) { static U8 pwrMode; U8 curMode;  PWR_GetPwrMode(&curMode); if(((PWR_OFF == curMode) || (PWR_ACC == curMode)) && ((PWR_RUN == pwrMode) ||  (PWR_CRANK == pwrMode))) {  NVM_SetParas(INDEX_NVM_K_COMPAREFUEL, &prmCompareFuel, 2); NVM_SetParas(INDEX_NVM_K_DISPLAYFUEL, &prmDisplayFuelU32, 2); }  pwrMode = curMode; }  void FL_NetSignal_OutPut(void) {  v_wr_8(FuelLvlPcnt_handle,gFuelLvlPct); v_wr_8(FuelLvlPcntV_handle,gFuelLvlPctV); #if DEBUG_FL_ALGORITHM  v_wr_16(SensorFuel_handle,FuelLevelAlgorithm_V2_DW.SensorFuel); v_wr_16(CompareFuel_handle,FuelLevelAlgorithm_V2_B.CompareFuel); v_wr_16(FarCompareFuel_handle,FuelLevelAlgorithm_V2_DW.FarCompareFuel);  v_wr_16(prmDisplayFuelU32_handle,prmDisplayFuelU32); v_wr_16(gASI_FuelSensorADAverage_handle,gASI_FuelSensorADAverage);  v_wr_bool(gRefuelFlag_handle,gRefuelFlag); #endif } void FL_Printf(void) {  printf("fl:%d\n%d\n%d\n%d\n%d\n%d\n%d\n%d\n%d\n%d\n ",  gASI_FuelSensorADAverage, gFuelLvlPct, gFuelLvlPctV, gRefuelFlag, DTC_FuelSensorShortBattery, DTC_FuelSensorShortGround, prmCompareFuel, prmDisplayFuelU32, prm_K_CompareFuel,  prm_K_DisplayFuel);  }   DBL FL_GetDisplayFuel(void) { return prmDisplayFuel; }  BOOL FL_GetFuelSensorFaultFlag(void) { BOOL res = FALSE;  if(DTC_FuelSensorShortBattery ||DTC_FuelSensorShortGround) { res = TRUE; } else { res = FALSE; }  return res; }  /*=========================================================================== fl.c fl_cfg.h fl_info.inc FL_Input.c FL_Output.c fl_private.h fl_public.h FuelLevelAlgorithm_V2.c FuelLevelAlgorithm_V2.h FuelLevelAlgorithm_V2_data.c FuelLevelAlgorithm_V2_private.h FuelLevelAlgorithm_V2_types.h File Revision History(bottom to top:first revision to last revision) *============================================================================ fl.c fl_cfg.h fl_info.inc FL_Input.c FL_Output.c fl_private.h fl_public.h FuelLevelAlgorithm_V2.c FuelLevelAlgorithm_V2.h FuelLevelAlgorithm_V2_data.c FuelLevelAlgorithm_V2_private.h FuelLevelAlgorithm_V2_types.h $Log:$ * fl.c fl_cfg.h fl_info.inc FL_Input.c FL_Output.c fl_private.h fl_public.h FuelLevelAlgorithm_V2.c FuelLevelAlgorithm_V2.h FuelLevelAlgorithm_V2_data.c FuelLevelAlgorithm_V2_private.h FuelLevelAlgorithm_V2_types.h Rev: Userid: Date: Description *-------- ---------- --------- ------------------------------ * fl.c fl_cfg.h fl_info.inc FL_Input.c FL_Output.c fl_private.h fl_public.h FuelLevelAlgorithm_V2.c FuelLevelAlgorithm_V2.h FuelLevelAlgorithm_V2_data.c FuelLevelAlgorithm_V2_private.h FuelLevelAlgorithm_V2_types.h V1.0 liuyingying 2016-12-21 Initial * *===========================================================================*/
