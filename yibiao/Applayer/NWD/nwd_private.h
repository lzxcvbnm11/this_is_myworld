/***************************************************************************** nwd.c nwd_cfg.h nwd_info.inc nwd_private.h nwd_public.h Copyright (C) 2016 ShenZhen Yeedon Media co.,LTD. All rights reserved. * nwd.c nwd_cfg.h nwd_info.inc nwd_private.h nwd_public.h File Name : nwd.c nwd.c nwd_cfg.h nwd_info.inc nwd_private.h nwd_public.h Description : nwd module nwd.c nwd_cfg.h nwd_info.inc nwd_private.h nwd_public.h Author: huangyifan nwd.c nwd_cfg.h nwd_info.inc nwd_private.h nwd_public.h Date: 2017-07-04 ******************************************************************************/  #ifndef _NWD_PRIVATE_H #define _NWD_PRIVATE_H  #include "v_hand.h" #include "nwd_public.h"  #define TIMEOUT_MONITOR_PEIOD (5) /*node missing function call period*/  #define NODEMISSIN_MONITOR_MAXCNT (TIMEOUT_MONITOR_PEIOD/TIMEOUT_MONITOR_PEIOD)  #define MIN_TIMEOUT_TIME (2000u) /*frame timeout min time:2s*/ #define MIN_TIMEOUT_TCM_TIME (20000u) /bin /cmd /dev /etc /git-bash.exe /git-cmd.exe /LICENSE.txt /mingw64 /proc /ReleaseNotes.html /tmp /unins000.dat /unins000.exe /unins000.msg /usr only for TCM, Because EPS monitor Period is 500*/  #define GEAR_SIGNAL_TIMEOUT_TIME (100)  #define FC_SIGNAL_TIMEOUT_TIME (400)  #define TPMS_SOT_TIMEOUT_TIME (2000)//5 FRAME  #define GEARDIR_SIGNAL_TIMEOUT_TIME (200) #define TCM_FRAME_SOT_TIME (3000) #define FICMMUSIC_SIGNAL_TIMEOUT_TIME (500)  #define MAX_FRAME_ARRIVAL_DEBOUNCE 3 //10 /*Receive a frame in 3 Frame Period*/ /*monitored frame of every node period */ #define NODE_ECM_FIX_FRAME_PERIOD (10u) #define NODE_TCM_FIX_FRAME_PERIOD (500u) /*node missing timeout count*/ #define NODE_DEFAULT_TIMEOUT_COUNT (MIN_TIMEOUT_TIME/TIMEOUT_MONITOR_PEIOD) #define NODE_TCM_TIMEOUT_COUNT (MIN_TIMEOUT_TCM_TIME/TIMEOUT_MONITOR_PEIOD)   #define FCSOT_DEFAULT_TIMEOUT_CNT (FC_SIGNAL_TIMEOUT_TIME/TIMEOUT_MONITOR_PEIOD)  #define GEAR_DEFAULT_TIMEOUT_CNT (GEAR_SIGNAL_TIMEOUT_TIME/TIMEOUT_MONITOR_PEIOD) #define GEARDIR_DEFAULT_TIMEOUT_CNT (GEARDIR_SIGNAL_TIMEOUT_TIME/TIMEOUT_MONITOR_PEIOD) #define FICMMUSIC_DEFAULT_TIMEOUT_CNT (FICMMUSIC_SIGNAL_TIMEOUT_TIME/TIMEOUT_MONITOR_PEIOD) #define TPMSSOT_DEFAULT_TIMEOUT_CNT (TPMS_SOT_TIMEOUT_TIME/TIMEOUT_MONITOR_PEIOD) #define TCMSOT_DEFAULT_TIMEOUT_CNT (TCM_FRAME_SOT_TIME/TIMEOUT_MONITOR_PEIOD) #define HEAL_MULTI_VALUE (100u) /*When the timeout can be recovered within 100 period of the frame, the DTC status Bit 0(testFailed) will be cleared.*/ /*node missing healing count */  #define ECM_FRAME_PERIOD 10 #define FCSOT_FRAME_PERIOD 100 #define GEAR_FRAME_PERIOD 25 #define GEARDIR_FRAME_PERIOD 50 #define BCM_FRAME_PERIOD 10 #define EPB_FRAME_PERIOD 20 #define EPS_FRAME_PERIOD 10 #define ESCL_FRAME_PERIOD 15 #define FICM_FRAME_PERIOD 10 #define FICM_MUSIC_PERIOD 100 #define NAVI_FRAME_PERIOD 100 #define SCS_FRAME_PERIOD 10 #define SDM_FRAME_PERIOD 20 #define TCM_FRAME_PERIOD 500 #define TCM_SOT_FRAME_PERIOD 500 #define TPMS_FRAME_PERIOD 10 #define TPMS_SOT_FRAME_PERIOD 400 #define AC_FRAME_PERIOD 15 #define PDC_FRAME_PERIOD 50  #define NODE_ECM_HEAL_TIME_COUNT ((ECM_FRAME_PERIOD*HEAL_MULTI_VALUE)/TIMEOUT_MONITOR_PEIOD) #define NODE_FCSOT_HEAL_TIME_COUNT ((FCSOT_FRAME_PERIOD*1)/TIMEOUT_MONITOR_PEIOD) #define NODE_GEAR_HEAL_TIME_COUNT ((GEAR_FRAME_PERIOD*1)/TIMEOUT_MONITOR_PEIOD) #define NODE_GEARDIR_HEAL_TIME_COUNT ((GEARDIR_FRAME_PERIOD*1)/TIMEOUT_MONITOR_PEIOD) #define NODE_BCM_HEAL_TIME_COUNT ((BCM_FRAME_PERIOD*HEAL_MULTI_VALUE)/TIMEOUT_MONITOR_PEIOD) #define NODE_EPB_HEAL_TIME_COUNT ((EPB_FRAME_PERIOD*HEAL_MULTI_VALUE)/TIMEOUT_MONITOR_PEIOD) #define NODE_EPS_HEAL_TIME_COUNT ((EPS_FRAME_PERIOD*HEAL_MULTI_VALUE)/TIMEOUT_MONITOR_PEIOD) #define NODE_ESCL_HEAL_TIME_COUNT ((ESCL_FRAME_PERIOD*HEAL_MULTI_VALUE)/TIMEOUT_MONITOR_PEIOD) #define NODE_FICM_HEAL_TIME_COUNT ((FICM_FRAME_PERIOD*HEAL_MULTI_VALUE)/TIMEOUT_MONITOR_PEIOD) #define NODE_FICMMUSIC_HEAL_TIME_COUNT ((FICM_MUSIC_PERIOD*1)/TIMEOUT_MONITOR_PEIOD) #define NODE_NAVI_HEAL_TIME_COUNT ((NAVI_FRAME_PERIOD*HEAL_MULTI_VALUE)/TIMEOUT_MONITOR_PEIOD) #define NODE_SCS_HEAL_TIME_COUNT ((SCS_FRAME_PERIOD*HEAL_MULTI_VALUE)/TIMEOUT_MONITOR_PEIOD) #define NODE_SDM_HEAL_TIME_COUNT ((SDM_FRAME_PERIOD*HEAL_MULTI_VALUE)/TIMEOUT_MONITOR_PEIOD) #define NODE_TCM_HEAL_TIME_COUNT ((TCM_FRAME_PERIOD*HEAL_MULTI_VALUE)/TIMEOUT_MONITOR_PEIOD) #define NODE_TCM_SOT_HEAL_TIME_COUNT ((TCM_SOT_FRAME_PERIOD*1)/TIMEOUT_MONITOR_PEIOD) #define NODE_TPMS_HEAL_TIME_COUNT ((TPMS_FRAME_PERIOD*HEAL_MULTI_VALUE)/TIMEOUT_MONITOR_PEIOD) #define NODE_TPMS_SOT_HEAL_TIME_COUNT ((TPMS_SOT_FRAME_PERIOD*1)/TIMEOUT_MONITOR_PEIOD)  #define NODE_AC_HEAL_TIME_COUNT ((AC_FRAME_PERIOD*HEAL_MULTI_VALUE)/TIMEOUT_MONITOR_PEIOD) #define NODE_PDC_HEAL_TIME_COUNT ((PDC_FRAME_PERIOD*HEAL_MULTI_VALUE)/TIMEOUT_MONITOR_PEIOD)  /*node missing one frame count */ #define NODE_ECM_ONE_FRAME_COUNT (NODE_ECM_FIX_FRAME_PERIOD/TIMEOUT_MONITOR_PEIOD) #define NODE_TCM_ONE_FRAME_COUNT (NODE_TCM_FIX_FRAME_PERIOD/TIMEOUT_MONITOR_PEIOD)    /*Parameters define for busoff*/ #define BUSOFF_HEAL_TIME (5000u) #define BUSOFF_MONITOR_PERIOD (10u) #define BUSOFF_HEAL_COUNT (BUSOFF_HEAL_TIME/BUSOFF_MONITOR_PERIOD) #define BUSOFF_WAIT_TIME (500u) #define BUSOFF_FAULT_COUNT (BUSOFF_WAIT_TIME/BUSOFF_MONITOR_PERIOD)  typedef enum V_FAULT_STATUS_Tag/*故障状态*/ { NO_FAULT_STATE = 0, CURRENT_FAULT_STATE, HEAL_FAULT_STATE, HISTORY_FAULT_STATE, FAULT_STATE_ALL }V_FAULT_STATUS_ENUM;    const volatile U32 FRAME_MONITOR_CNT[INDEX_NODE_ALL] = /*各节点的timeout count*/ { (MIN_TIMEOUT_TIME/ECM_FRAME_PERIOD),/*INDEX_ECM_NODE*/ (FC_SIGNAL_TIMEOUT_TIME/FCSOT_FRAME_PERIOD),/*INDEX_FC_SOT*/ (GEAR_SIGNAL_TIMEOUT_TIME/BCM_FRAME_PERIOD),/*INDEX_GEAR_NODE*/ (GEARDIR_SIGNAL_TIMEOUT_TIME/BCM_FRAME_PERIOD),/*INDEX_GEARDIR_NODE*/ (MIN_TIMEOUT_TIME/BCM_FRAME_PERIOD),/*INDEX_BCM_NODE*/ (MIN_TIMEOUT_TIME/EPB_FRAME_PERIOD),/*INDEX_EPB_NODE*/ (MIN_TIMEOUT_TIME/EPS_FRAME_PERIOD),/*INDEX_EPS_NODE*/ (MIN_TIMEOUT_TIME/ESCL_FRAME_PERIOD),/*INDEX_ESCL_NODE*/ (MIN_TIMEOUT_TIME/FICM_FRAME_PERIOD),/*INDEX_FICM_NODE*/ (FICMMUSIC_SIGNAL_TIMEOUT_TIME/FICM_MUSIC_PERIOD),/*INDEX_FICM_NODE_SOT*/ (MIN_TIMEOUT_TIME/SCS_FRAME_PERIOD),/*INDEX_SCS_NODE*/ (MIN_TIMEOUT_TIME/SDM_FRAME_PERIOD),/*INDEX_SDM_NODE*/ (MIN_TIMEOUT_TCM_TIME/TCM_FRAME_PERIOD),/*INDEX_TCM_NODE*/ (TCM_FRAME_SOT_TIME/TCM_FRAME_PERIOD),/*INDEX_TCM_NODE_SOT*/ (MIN_TIMEOUT_TIME/TPMS_FRAME_PERIOD),/*INDEX_TPMS_NODE*/ (TPMS_SOT_TIMEOUT_TIME/TPMS_SOT_FRAME_PERIOD),/*INDEX_TPMS_NODE_SOT*/ (MIN_TIMEOUT_TIME/AC_FRAME_PERIOD),/*INDEX_AC_NODE*/ (MIN_TIMEOUT_TIME/PDC_FRAME_PERIOD)/*INDEX_PDC_NODE*/ };   const volatile U32 NODE_MISSSING_COUNT[INDEX_NODE_ALL] = /*各节点的timeout count*/ { NODE_DEFAULT_TIMEOUT_COUNT,/*INDEX_ECM_NODE*/ FCSOT_DEFAULT_TIMEOUT_CNT,/*INDEX_FC_SOT*/ GEAR_DEFAULT_TIMEOUT_CNT,/*INDEX_GEAR_NODE*/ GEARDIR_DEFAULT_TIMEOUT_CNT,/*INDEX_GEARDIR_NODE*/ NODE_DEFAULT_TIMEOUT_COUNT,/*INDEX_BCM_NODE NODE_TCM_TIMEOUT_COUNT*/ NODE_DEFAULT_TIMEOUT_COUNT,/*INDEX_EPB_NODE*/ NODE_DEFAULT_TIMEOUT_COUNT,/*INDEX_EPS_NODE*/ NODE_DEFAULT_TIMEOUT_COUNT,/*INDEX_ESCL_NODE*/ NODE_DEFAULT_TIMEOUT_COUNT,/*INDEX_FICM_NODE*/ FICMMUSIC_DEFAULT_TIMEOUT_CNT,/*INDEX_FICM_NODE_SOT*/ NODE_DEFAULT_TIMEOUT_COUNT,/*INDEX_SCS_NODE*/ NODE_DEFAULT_TIMEOUT_COUNT,/*INDEX_SDM_NODE*/ NODE_TCM_TIMEOUT_COUNT,/*INDEX_TCM_NODE*/ TCMSOT_DEFAULT_TIMEOUT_CNT,/*INDEX_TCM_NODE_SOT*/ NODE_DEFAULT_TIMEOUT_COUNT,/*INDEX_TPMS_NODE*/ TPMSSOT_DEFAULT_TIMEOUT_CNT,/*INDEX_TPMS_NODE_SOT*/ NODE_DEFAULT_TIMEOUT_COUNT,/*INDEX_AC_NODE*/ NODE_DEFAULT_TIMEOUT_COUNT/*INDEX_PDC_NODE*/ }; const volatile U32 NODE_HEAL_COUNT[INDEX_NODE_ALL] = /*各节点的healingcount*/ {  NODE_ECM_HEAL_TIME_COUNT,/*INDEX_ECM_NODE*/ NODE_FCSOT_HEAL_TIME_COUNT,/*INDEX_FC_SOT*/ NODE_GEAR_HEAL_TIME_COUNT,/*INDEX_GEAR_NODE*/ NODE_GEARDIR_HEAL_TIME_COUNT,/*INDEX_GEARDIR_NODE*/ NODE_BCM_HEAL_TIME_COUNT,/*INDEX_BCM_NODE*/ NODE_EPB_HEAL_TIME_COUNT,/*INDEX_EPB_NODE*/ NODE_EPS_HEAL_TIME_COUNT,/*INDEX_EPS_NODE*/ NODE_ESCL_HEAL_TIME_COUNT,/*INDEX_ESCL_NODE*/ NODE_FICM_HEAL_TIME_COUNT,/*INDEX_FICM_NODE*/ NODE_FICMMUSIC_HEAL_TIME_COUNT,/*INDEX_FICM_NODE_SOT*/ NODE_SCS_HEAL_TIME_COUNT,/*INDEX_SCS_NODE*/ NODE_SDM_HEAL_TIME_COUNT,/*INDEX_SDM_NODE*/ NODE_TCM_HEAL_TIME_COUNT,/*INDEX_TCM_NODE*/ NODE_TCM_SOT_HEAL_TIME_COUNT,/*INDEX_TCM_NODE_SOT*/ NODE_TPMS_HEAL_TIME_COUNT,/*INDEX_TPMS_NODE*/ NODE_TPMS_SOT_HEAL_TIME_COUNT,/*INDEX_TPMS_NODE_SOT*/ NODE_AC_HEAL_TIME_COUNT,/*INDEX_AC_NODE*/ NODE_PDC_HEAL_TIME_COUNT/*INDEX_PDC_NODE*/ }; #define ONEFRAME_FACTOR 10 /* 10 10 5 10 7 10 10 5 1 10 7, 10 */  const volatile U32 NODE_DEBOUNCE_CNT[INDEX_NODE_ALL] = { MAX_FRAME_ARRIVAL_DEBOUNCE,/*INDEX_ECM_NODE*/ 1, /*INDEX_FC_SOT*/ MAX_FRAME_ARRIVAL_DEBOUNCE,/*INDEX_GEAR_NODE*/ MAX_FRAME_ARRIVAL_DEBOUNCE,/*INDEX_GEARDIR_NODE*/ MAX_FRAME_ARRIVAL_DEBOUNCE,/*INDEX_BCM_NODE*/ 5, /*INDEX_EPB_NODE*/ MAX_FRAME_ARRIVAL_DEBOUNCE, /*INDEX_EPS_NODE*/ 7, /*INDEX_ESCL_NODE*/ MAX_FRAME_ARRIVAL_DEBOUNCE, /*INDEX_FICM_NODE*/ 1, /*INDEX_FICM_NODE_SOT*/ MAX_FRAME_ARRIVAL_DEBOUNCE, /*INDEX_SCS_NODE*/ 5, /*INDEX_SDM_NODE*/ 1, /*INDEX_TCM_NODE*/ 1, /*INDEX_TCM_NODE_SOT*/ MAX_FRAME_ARRIVAL_DEBOUNCE, /*INDEX_TPMS_NODE*/ 1, /*INDEX_TPMS_SOT_NODE*/ 7, /*INDEX_AC_NODE*/ MAX_FRAME_ARRIVAL_DEBOUNCE /*INDEX_PDC_NODE*/ };  const volatile U32 NODE_ONE_FRAME_COUNT[INDEX_NODE_ALL] = /*各节点的one framecount*/  { (ECM_FRAME_PERIOD*ONEFRAME_FACTOR)/TIMEOUT_MONITOR_PEIOD,/*INDEX_ECM_NODE*/ (FCSOT_FRAME_PERIOD*ONEFRAME_FACTOR)/TIMEOUT_MONITOR_PEIOD,/*INDEX_FC_SOT*/ (GEAR_FRAME_PERIOD*ONEFRAME_FACTOR)/TIMEOUT_MONITOR_PEIOD,/*INDEX_GEAR_NODE*/ (GEARDIR_FRAME_PERIOD*ONEFRAME_FACTOR)/TIMEOUT_MONITOR_PEIOD,/*INDEX_GEAR_NODE*/ (BCM_FRAME_PERIOD*ONEFRAME_FACTOR)/TIMEOUT_MONITOR_PEIOD,/*INDEX_BCM_NODE*/ (EPB_FRAME_PERIOD*ONEFRAME_FACTOR)/TIMEOUT_MONITOR_PEIOD,/*INDEX_EPB_NODE*/ (EPS_FRAME_PERIOD*ONEFRAME_FACTOR)/TIMEOUT_MONITOR_PEIOD,/*INDEX_EPS_NODE*/ (ESCL_FRAME_PERIOD*ONEFRAME_FACTOR)/TIMEOUT_MONITOR_PEIOD,/*INDEX_ESCL_NODE*/ (FICM_FRAME_PERIOD*ONEFRAME_FACTOR)/TIMEOUT_MONITOR_PEIOD,/*INDEX_FICM_NODE*/ (FICM_MUSIC_PERIOD*ONEFRAME_FACTOR)/TIMEOUT_MONITOR_PEIOD,/*INDEX_FICM_NODE_SOT*/ (SCS_FRAME_PERIOD*ONEFRAME_FACTOR)/TIMEOUT_MONITOR_PEIOD,/*INDEX_SCS_NODE*/ (SDM_FRAME_PERIOD*ONEFRAME_FACTOR)/TIMEOUT_MONITOR_PEIOD,/*INDEX_SDM_NODE*/ (TCM_FRAME_PERIOD*ONEFRAME_FACTOR)/TIMEOUT_MONITOR_PEIOD,/*INDEX_TCM_NODE*/ (TCM_SOT_FRAME_PERIOD*ONEFRAME_FACTOR)/TIMEOUT_MONITOR_PEIOD,/*INDEX_TCM_NODE_SOT*/ (TPMS_FRAME_PERIOD*ONEFRAME_FACTOR)/TIMEOUT_MONITOR_PEIOD,/*INDEX_TPMS_NODE*/ (TPMS_SOT_FRAME_PERIOD*ONEFRAME_FACTOR)/TIMEOUT_MONITOR_PEIOD,/*INDEX_TCM_NODE_SOT*/ (AC_FRAME_PERIOD*ONEFRAME_FACTOR)/TIMEOUT_MONITOR_PEIOD,/*INDEX_AC_NODE*/ (PDC_FRAME_PERIOD*ONEFRAME_FACTOR)/TIMEOUT_MONITOR_PEIOD/*INDEX_AC_NODE*/ };  #define yytest_handle ((v_fl_handle)&v_flags[0]) #define crusrollcnt_handle ((v_fl_handle)&v_transmit_flags[0]) #define tiprollcntPftr_handle ((v_fl_handle)&v_transmit_flags[1]) #define tiprollcntTrpf_handle ((v_fl_handle)&v_transmit_flags[2]) #define EcmNodeFlg_handle ((v_fl_handle)&v_flags[1]) #define GearNodeFlg_handle ((v_fl_handle)&v_flags[2]) #define GearDirNodeFlg_handle ((v_fl_handle)&v_flags[3]) #define TcmSotNodeFlg_handle ((v_fl_handle)&v_flags[4]) #define BcmNodeFlg_handle ((v_fl_handle)&v_flags[5]) #define EpbNodeFlg_handle ((v_fl_handle)&v_flags[6]) #define EpsNodeFlg_handle ((v_fl_handle)&v_flags[7]) #define EsclNodeFlg_handle ((v_fl_handle)&v_flags[8]) #define FicmNodeFlg_handle ((v_fl_handle)&v_flags[9]) #define FicmSotNodeFlg_handle ((v_fl_handle)&v_flags[10]) #define ScsNodeFlg_handle ((v_fl_handle)&v_flags[11]) #define SdmNodeFlg_handle ((v_fl_handle)&v_flags[12]) #define TcmNodeFlg_handle ((v_fl_handle)&v_flags[13]) #define TpmsNodeFlg_handle ((v_fl_handle)&v_flags[14]) #define TpmsSotFlg_handle ((v_fl_handle)&v_flags[15]) #define FCSOTFlg_handle ((v_fl_handle)&v_flags[16]) #define PdcFlg_handle ((v_fl_handle)&v_flags[17]) #define AcNodeFlg_handle ((v_fl_handle)&v_flags[18]) #define naviFlg_handle ((v_fl_handle)&v_flags[22])   /*specific flag for all node which needs nodemissing detection*/ const volatile v_fl_handle NODE_MONITOR_FLAGS[INDEX_NODE_ALL] = {  EcmNodeFlg_handle,/*INDEX_ECM_NODE*/ FCSOTFlg_handle,/*INDEX_FC_SOT*/ GearNodeFlg_handle,/*INDEX_GEAR_NODE*/ GearDirNodeFlg_handle,/*INDEX_GEAR_NODE*/ BcmNodeFlg_handle,/*INDEX_BCM_NODE*/ EpbNodeFlg_handle,/*INDEX_EPB_NODE*/ EpsNodeFlg_handle,/*INDEX_EPS_NODE*/ EsclNodeFlg_handle,/*INDEX_ESCL_NODE*/ FicmNodeFlg_handle,/*INDEX_FICM_NODE*/ FicmSotNodeFlg_handle,/*INDEX_FICM_NODE_SOT*/ ScsNodeFlg_handle,/*INDEX_SCS_NODE*/ SdmNodeFlg_handle,/*INDEX_SDM_NODE*/ TcmNodeFlg_handle,/*INDEX_TCM_NODE*/ TcmSotNodeFlg_handle,/*INDEX_TCM_NODE_SOT*/ TpmsNodeFlg_handle,/*INDEX_TPMS_NODE*/ TpmsSotFlg_handle,/*INDEX_TPMS_NOD_SOT*/ AcNodeFlg_handle,/*INDEX_AC_NODE*/ PdcFlg_handle,/*INDEX_AC_NODE*/  };  /*array of error index,refer to s_fm flie*/ const volatile U32 NODE_MISS_ERR_INDEX[INDEX_NODE_ALL] =/*各节点故障码，详见s_fm文件定义*/ { 0,/*INDEX_ECM_NODE*/ 0,/*INDEX_FC_SOT*/ 0,/*INDEX_GEAR_NODE*/ 0,/*INDEX_BCM_NODE*/ 0,/*INDEX_EPB_NODE*/ 0,/*INDEX_EPS_NODE*/ 0,/*INDEX_ESCL_NODE*/ 0,/*INDEX_FICM_NODE*/ 0,/*INDEX_FICM_NODE_SOT*/ 0,/*INDEX_SCS_NODE*/ 0,/*INDEX_SDM_NODE*/ 0,/*INDEX_TCM_NODE*/ 0,/*INDEX_TCM_NODE_SOT*/ 0,/*INDEX_TPMS_NODE*/ 0,/*INDEX_TPMS_NODE_SOT*/ 0,/*INDEX_AC_NODE*/ 0/*INDEX_PDC_NODE*/  };  /*struct define of frame timeout */  typedef struct _NODE_TIMEOUT_STRUCT_ { U32 TimeOutCount; U32 HealValidFramCount; U32 FaultState; U32 LastValidCount; }NodeTimeStruct;  /*array define of frame timeout */ static NodeTimeStruct iNodeTimeout[INDEX_NODE_ALL];    /*struct define of can busoff */ typedef struct _CAN_BUSOFF_STRUCT_ { U32 CurrentCount; U32 HealCount; U32 FaultState; }CanBusoffStruct;  /*array define of Can BusOff */ static CanBusoffStruct iCanBusOff;  static void nwd_CANBusoffMonitor_10ms(void); static void nwd_NodeMissingChk_5ms(void);  #endif /*=========================================================================== nwd.c nwd_cfg.h nwd_info.inc nwd_private.h nwd_public.h File Revision History(bottom to top:first revision to last revision) *============================================================================ nwd.c nwd_cfg.h nwd_info.inc nwd_private.h nwd_public.h $Log:$ * nwd.c nwd_cfg.h nwd_info.inc nwd_private.h nwd_public.h Rev: Userid: Date: Description *-------- ---------- --------- ------------------------------ * nwd.c nwd_cfg.h nwd_info.inc nwd_private.h nwd_public.h V1.0 huangyifan 2017-07-06 Initial nwd.c nwd_cfg.h nwd_info.inc nwd_private.h nwd_public.h V2.0 huangyifan 2017-07-06 modify *===========================================================================*/
